/*!
 * tui-component-date-picker.min.js
 * @version 1.6.0
 * @author NHNEnt FE Development Lab <dl_javascript@nhnent.com>
 * @license MIT
 */
!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="dist",e(0)}([function(t,e,n){"use strict";var i=n(3),s=n(4),a=n(1);tui.util.defineNamespace("tui.component",{DatePicker:i,TimePicker:s,Spinbox:a})},function(t,e){"use strict";var n=tui.util,i=n.inArray,s=n.defineClass({init:function(t,e){this._$containerElement=$(t),this._$inputElement=this._$containerElement.find('input[type="text"]'),this._value=null,this._option=null,this._$upButton=null,this._$downButton=null,this._changeType="default",this._initialize(e)},_initialize:function(t){this._setOption(t),this._assignHTMLElements(),this._assignDefaultEvents(),this.setValue(this._option.defaultValue)},_setOption:function(t){if(this._option={defaultValue:0,step:1,max:Number.MAX_SAFE_INTEGER||9007199254740991,min:Number.MIN_SAFE_INTEGER||-9007199254740991,upBtnTag:'<button type="button"><b>+</b></button>',downBtnTag:'<button type="button"><b>-</b></button>'},n.extend(this._option,t),n.isArray(this._option.exclusion)||(this._option.exclusion=[]),!this._isValidOption())throw new Error("Spinbox option is invaild")},_isValidOption:function(){var t=this._option;return this._isValidValue(t.defaultValue)&&this._isValidStep(t.step)},_isValidValue:function(t){var e,s,a;return!!n.isNumber(t)&&(e=this._option,s=t<=e.max&&t>=e.min,a=i(t,e.exclusion)===-1,s&&a)},_isValidStep:function(t){var e=this._option.max-this._option.min;return n.isNumber(t)&&t<e},_assignHTMLElements:function(){this._setInputSizeAndMaxLength(),this._makeButton()},_makeButton:function(){var t=this._$inputElement,e=this._$upButton=$(this._option.upBtnTag),n=this._$downButton=$(this._option.downBtnTag);e.insertBefore(t),e.wrap("<div></div>"),n.insertAfter(t),n.wrap("<div></div>")},_setInputSizeAndMaxLength:function(){var t=this._$inputElement,e=String(this._option.min).length,n=String(this._option.max).length,i=Math.max(e,n);t.attr("size")||t.attr("size",i),t.attr("maxlength")||t.attr("maxlength",i)},_assignDefaultEvents:function(){var t=n.bind(this._onClickButton,this),e=n.bind(this._onKeyDownInputElement,this);this._$upButton.on("click",{isDown:!1},t),this._$downButton.on("click",{isDown:!0},t),this._$inputElement.on("keydown",e),this._$inputElement.on("change",n.bind(this._onChangeInput,this)),this._$inputElement.on("focus",n.bind(function(){this._changeType="default"},this))},_setNextValue:function(t){var e=this._option,n=e.step,s=e.min,a=e.max,o=e.exclusion,r=this.getValue();t&&(n=-n);do r+=n,r>a?r=s:r<s&&(r=a);while(i(r,o)>-1);this._changeType=t?"down":"up",this.setValue(r)},_onClickButton:function(t){this._setNextValue(t.data.isDown)},_onKeyDownInputElement:function(t){var e,n=t.which||t.keyCode;switch(n){case 38:e=!1;break;case 40:e=!0;break;default:return}this._setNextValue(e)},_onChangeInput:function(){var t=Number(this._$inputElement.val()),e=this._isValidValue(t)&&this._value!==t,n=e?t:this._value;this._value=n,this._$inputElement.val(n),this.fire("change",this._changeType)},setStep:function(t){this._isValidStep(t)&&(this._option.step=t)},getStep:function(){return this._option.step},getValue:function(){return this._value},setValue:function(t){this._$inputElement.val(t).change()},getOption:function(){return this._option},addExclusion:function(t){var e=this._option.exclusion;i(t,e)>-1||e.push(t)},removeExclusion:function(t){var e=this._option.exclusion,n=i(t,e);n!==-1&&e.splice(n,1)},getContainerElement:function(){return this._$containerElement[0]}});tui.util.CustomEvents.mixin(s),t.exports=s},function(t,e){"use strict";var n={getDateHash:function(t,e,n){var i;return arguments.length<3&&(i=arguments[0]||new Date,t=i.getFullYear(),e=i.getMonth()+1,n=i.getDate()),{year:t,month:e,date:n}},getToday:function(){return n.getDateHash()},getTime:function(t){return n.getDateObject(t).getTime()},getFirstDay:function(t,e){return new Date(t,e-1,1).getDay()},getLastDay:function(t,e){return new Date(t,e,0).getDay()},getLastDayInMonth:function(t,e){return new Date(t,e,0).getDate()},getDateObject:function(t){return 3===arguments.length?new Date(arguments[0],arguments[1]-1,arguments[2]):new Date(t.year,t.month-1,t.date)},getRelativeDate:function(t,e,i,s){var a=s.year+t,o=s.month+e-1,r=s.date+i,h=new Date(a,o,r);return n.getDateHash(h)},search:function(t,e){for(var n,i,s,a=!1,o=0,r=t.length-1;!a&&!n;)i=Math.floor((o+r)/2),s=t[i],s===e?a=!0:s<e?o=i+1:r=i-1,n=o>r;return{found:a,index:a||s>e?i:i+1}},getMeridiemHour:function(t){return t%=12,0===t&&(t=12),t},isEqualDateHash:function(t,e){return t.year===e.year&&t.month===e.month&&t.date===e.date},getSafeNumber:function(t,e){if(isNaN(e)||!tui.util.isNumber(e))throw Error("The defaultNumber must be a valid number.");return isNaN(t)?e:Number(t)}};t.exports=n},function(t,e,n){"use strict";var i=n(2),s=tui.util,a=s.extend,o=s.bind,r=s.forEach,h=s.isNumber,u=s.compareJSON,l=function(t,e,n){return n=n||1,Math.floor(t/n)>=Math.floor(e/n)},d=s.inArray,_=/yyyy|yy|mm|m|dd|d/gi,c={yyyy:{expression:"(\\d{4}|\\d{2})",type:"year"},yy:{expression:"(\\d{4}|\\d{2})",type:"year"},y:{expression:"(\\d{4}|\\d{2})",type:"year"},mm:{expression:"(1[012]|0[1-9]|[1-9]\\b)",type:"month"},m:{expression:"(1[012]|0[1-9]|[1-9]\\b)",type:"month"},dd:{expression:"([12]\\d{1}|3[01]|0[1-9]|[1-9]\\b)",type:"date"},d:{expression:"([12]\\d{1}|3[01]|0[1-9]|[1-9]\\b)",type:"date"}},m="date",p="month",f="year",g=1900,b=2999,y='<div style="position:absolute;"></div>',w=Number(new Date(0)),x=Number(new Date(2999,11,31)),v=31536e6,E=2628e6,D="relativeMonthValue",C=[m,p,f],S={left:"left",top:"bottom"},k=["dd","d"],T=["mm","m"],M=["yyyy","yy","y"],O=s.defineClass({init:function(t,e){t=a({dateFormat:"yyyy-mm-dd ",defaultCentury:"20",disabledClassName:"disabled",selectableClassName:"selectable",selectedClassName:"selected",selectableRanges:[],enableSetDateByEnterKey:!0,showAlways:!1,useTouchEvent:!0},t),this._calendar=e,this._$element=$(t.element),this._$wrapperElement=$(y),this._dateFormat=t.dateForm||t.dateFormat,this._regExp=null,this._formOrder=[],this._date=null,this._defaultCentury=t.defaultCentury,this._selectableClassName=t.selectableClassName,this._selectedClassName=t.selectedClassName,this._enableSetDateByEnterKey=t.enableSetDateByEnterKey,this._startTimes=[],this._endTimes=[],this._ranges=t.selectableRanges,this._timePicker=null,this._pos=null,this._openers=[],this._proxyHandlers={},this._shownLayerIdx=0,this._enabledState=!0,this._disabledClassName=t.disabledClassName,this.showAlways=t.showAlways,this.useTouchEvent=!(!("createTouch"in document||"ontouchstart"in document)||!t.useTouchEvent),this._initializeDatePicker(t)},_initializeDatePicker:function(t){this._ranges=this._filterValidRanges(this._ranges),this._detachCalendarEvent(),this._setSelectableRanges(),this._setWrapperElement(t.parentElement),this._setDefaultDate(t.date),this._setDefaultPosition(t.pos),this._setProxyHandlers(),this._setOpeners(t.openers),this._bindKeydownEvent(this._$element),this._setTimePicker(t.timePicker),this.setDateForm(),this._$wrapperElement.hide(),this._calendar.$element.show()},_filterValidRanges:function(t){var e,n;return s.filter(t,function(t){return e=t[0],n=t[1],this._setHashInRange(e,n),this._isValidDateHash(e)&&this._isValidDateHash(n)},this)},_detachCalendarEvent:function(){this._calendar.detachEventToBody()},_setWrapperElement:function(t){var e=this._$wrapperElement,n=$(t);e.append(this._calendar.$element),n[0]?e.appendTo(n):this._$element[0]?e.insertAfter(this._$element):e.appendTo(document.body)},_setDefaultDate:function(t){/^blank$/i.test(t)||(t=t?{year:i.getSafeNumber(t.year,g),month:i.getSafeNumber(t.month,1),date:i.getSafeNumber(t.date,1)}:i.getToday(),this._setShownLayerIndexByForm(),this._isSelectable(t,this._getCurrentLayer())&&(this._date=t))},_setDefaultPosition:function(t){var e=this._pos=t||{},n=this._getBoundingClientRect();h(e.zIndex)||(e.zIndex=9999),s.forEach(S,function(t,i){h(e[i])||(e[i]=n[t]||0)})},_setSelectableRanges:function(){this._startTimes=[],this._endTimes=[],r(this._ranges,function(t){this._updateTimeRange({start:i.getTime(t[0]),end:i.getTime(t[1])})},this)},_updateTimeRange:function(t){var e,n,i;e=this._searchStartTime(t.start).index,n={start:this._startTimes[e],end:this._endTimes[e]},this._isOverlappedTimeRange(n,t)?(i=this._mergeTimeRanges(n,t),this._startTimes.splice(e,1,i.start),this._endTimes.splice(e,1,i.end)):(this._startTimes.splice(e,0,t.start),this._endTimes.splice(e,0,t.end))},_isOverlappedTimeRange:function(t,e){var n=t.start,i=t.end,s=e.start,a=e.end,o=n&&i&&s&&a,r=!(s<n&&a<n||s>i&&a>i);return o&&r},_mergeTimeRanges:function(t,e){return{start:Math.min(t.start,e.start),end:Math.max(t.end,e.end)}},_searchStartTime:function(t){return i.search(this._startTimes,t)},_searchEndTime:function(t){return i.search(this._endTimes,t)},_setOpeners:function(t){this.addOpener(this._$element),r(t,function(t){this.addOpener(t)},this)},_setTimePicker:function(t){t&&(this._timePicker=t,this._bindCustomEventWithTimePicker())},_bindCustomEventWithTimePicker:function(){var t=o(this.setDate,this);this.on("open",function(){this._timePicker.setTimeFromInputElement(this._$element),this._timePicker.on("change",t)},this),this.on("close",function(){this._timePicker.off("change",t)},this)},_isValidYear:function(t){return h(t)&&t>=g&&t<=b},_isValidMonth:function(t){return h(t)&&t>0&&t<13},_isValidDayInMonth:function(t,e,n){return h(n)&&n>0&&n<=i.getLastDayInMonth(t,e)},_isValidDateHash:function(t){var e,n,i;return!!t&&(e=t.year||this._date.year,n=t.month||this._date.month,i=t.date||this._date.date,this._isValidYear(e)&&this._isValidMonth(n)&&this._isValidDayInMonth(e,n,i))},_isOpener:function(t){for(var e=!1,n=this._openers,i=0,s=n.length;i<s;i+=1)if(t===n[i]||$.contains(n[i],t)){e=!0;break}return e},_arrangeLayer:function(){var t=this._$wrapperElement[0].style,e=this._pos;t.left=e.left+"px",t.top=e.top+"px",t.zIndex=e.zIndex,this._$wrapperElement.append(this._calendar.$element),this._timePicker&&(this._$wrapperElement.append(this._timePicker.$timePickerElement),this._timePicker.show())},_getBoundingClientRect:function(t){var e,n,i=$(t)[0]||this._$element[0];return i?(e=i.getBoundingClientRect(),n=Math.ceil,{left:n(e.left),top:n(e.top),bottom:n(e.bottom),right:n(e.right)}):{}},_setDateFromString:function(t){var e=this._extractDate(t);e=a({},this._date,e),e&&this._isSelectable(e)?(this._timePicker&&this._timePicker.setTimeFromInputElement(this._$element),this.setDate(e.year,e.month,e.date)):this.setDate()},_makeDateString:function(){var t,e,n=this._date.year,i=this._date.month,s=this._date.date,a=this._dateFormat;return i=i<10?"0"+i:i,s=s<10?"0"+s:s,t={yyyy:n,yy:String(n).substr(2,2),mm:i,m:Number(i),dd:s,d:Number(s)},e=a.replace(_,function(e){return t[e.toLowerCase()]||""})},_extractDate:function(t){var e=this._formOrder,n={},i=this._regExp;return i.lastIndex=0,!!i.test(t)&&(e[0]&&(n[e[0]]=Number(RegExp.$1)),e[1]&&(n[e[1]]=Number(RegExp.$2)),e[2]&&(n[e[2]]=Number(RegExp.$3)),2===String(n.year).length&&(n.year=Number(this._defaultCentury+n.year)),n)},_isSelectable:function(t,e){var n,s,o,r,h=this._startTimes;switch(t=a({},t),e){case f:t.month=1,t.date=1,r=v;break;case p:t.date=1,r=E}return!!this._isValidDateHash(t)&&(!h.length||(o=i.getTime(t),s=this._searchEndTime(o),n=h[s.index],s.found||l(o,n,r)))},_setSelectableClassName:function(t,e,n){this._isSelectable(e,n)&&t.addClass(this._selectableClassName)},_setSelectedClassName:function(t,e,n){var s,a=this._date;switch(n){case p:e.date=a.date;break;case f:e.date=a.date,e.month=a.month}s=i.isEqualDateHash(a,e),s&&$(t).addClass(this._selectedClassName)},_setValueToInputElement:function(){var t,e;this._date&&(t=this._makeDateString(),e="",this._timePicker&&(e=this._timePicker.getTime()),this._$element.val(t+e))},_setRegExp:function(){var t="^",e=this._formOrder,n=this._dateFormat.match(_);s.forEach(n,function(n,i){n=n.toLowerCase(),t+=c[n].expression+"[\\D\\s]*",e[i]=c[n].type}),this._regExp=new RegExp(t,"gi")},_setProxyHandlers:function(){var t=this._proxyHandlers;t.onMousedownDocument=o(this._onMousedownDocument,this),t.onKeydownElement=o(this._onKeydownElement,this),t.onClickCalendar=o(this._onClickCalendar,this),t.onClickOpener=o(this._onClickOpener,this),t.onBeforeDrawCalendar=o(this._onBeforeDrawCalendar,this),t.onDrawCalendar=o(this._onDrawCalendar,this),t.onAfterDrawCalendar=o(this._onAfterDrawCalendar,this)},_onMousedownDocument:function(t){var e=$.contains(this._$wrapperElement[0],t.target);e||this._isOpener(t.target)||this.close()},_onKeydownElement:function(t){t&&13===t.keyCode&&this._setDateFromString(this._$element.val())},_onClickCalendar:function(t){var e,n,s=t.target,a=s.className,o=s.innerText||s.textContent||s.nodeValue,r=this._calendar.shownLayerIdx,h=this._calendar.getDate(),u=this._shownLayerIdx;if(n=a.indexOf("prev-month")>-1?-1:a.indexOf("next-month")>-1?1:$(s).data(D)||0,h.date=r?1:Number(o),e=i.getRelativeDate(0,n,0,h),u===r){if(this.setDate(e.year,e.month,e.date),!this.invoke("pick"))return;this.showAlways||this.close()}else this._calendar.draw(e.year,e.month,!1,r-1)},_onClickOpener:function(){var t=this.isOpened();t?this.close():this.open()},_onBeforeDrawCalendar:function(){this._unbindOnClickCalendar()},_onDrawCalendar:function(t){var e,n=t.$dateContainer,i=n.attr("class"),s={year:t.year,month:t.month||1,date:t.date||1};i.indexOf(m)>-1?e=m:i.indexOf(p)>-1?e=p:i.indexOf(f)>-1&&(e=f),this._setSelectableClassName(n,s,e),this._date&&this._setSelectedClassName(n,s,e)},_onAfterDrawCalendar:function(){this._showOnlyValidButtons(),this._bindOnClickCalendar()},_showOnlyValidButtons:function(){var t=this._calendar.$header,e=t.find('[class*="btn-prev"]').hide(),n=t.find('[class*="btn-next"]').hide(),i=this._getDiffTime();i.start>0&&e.show(),i.end>0&&n.show()},_bindKeydownEvent:function(t){this._enableSetDateByEnterKey&&t.on("keydown",this._proxyHandlers.onKeydownElement)},_unbindKeydownEvent:function(t){this._enableSetDateByEnterKey&&t.off("keydown",this._proxyHandlers.onKeydownElement)},_bindOnMousedownDocument:function(){var t=this.useTouchEvent?"touchstart":"mousedown";$(document).on(t,this._proxyHandlers.onMousedownDocument)},_unbindOnMousedownDocument:function(){$(document).off("mousedown touchstart",this._proxyHandlers.onMousedownDocument)},_bindOnClickCalendar:function(){var t=this._proxyHandlers.onClickCalendar,e=this.useTouchEvent?"touchend":"click";this._$wrapperElement.find("."+this._selectableClassName).on(e,t)},_unbindOnClickCalendar:function(){var t=this._proxyHandlers.onClickCalendar;this._$wrapperElement.find("."+this._selectableClassName).off("click touchend",t)},_bindCalendarCustomEvent:function(){var t=this._proxyHandlers,e=t.onBeforeDrawCalendar,n=t.onDrawCalendar,i=t.onAfterDrawCalendar;this._calendar.on({beforeDraw:e,draw:n,afterDraw:i})},_unbindCalendarCustomEvent:function(){var t=this._proxyHandlers,e=t.onBeforeDrawCalendar,n=t.onDrawCalendar,i=t.onAfterDrawCalendar;this._calendar.off({beforeDraw:e,draw:n,afterDraw:i})},_bindOnClickOpener:function(t){var e=this.useTouchEvent?"touchend":"click";$(t).on(e,this._proxyHandlers.onClickOpener)},_unbindOnClickOpener:function(t){var e=this.useTouchEvent?"touchend":"click";$(t).on(e,this._proxyHandlers.onClickOpener)},_getCurrentLayer:function(){return C[this._shownLayerIdx]},_shouldShowLayer:function(t){var e,n=this._dateFormat.match(_),i=function(t){return n.indexOf(t)>-1};switch(t){case m:e=k;break;case p:e=T;break;case f:e=M;break;default:return!1}return!!s.filter(e,i).length},_setShownLayerIndexByForm:function(){var t=0;this._shouldShowLayer(f)&&(t=C.indexOf(f)),this._shouldShowLayer(p)&&(t=C.indexOf(p)),this._shouldShowLayer(m)&&(t=C.indexOf(m)),this._shownLayerIdx=t},_setHashInRange:function(t,e){t.month=t.month||1,e.month=e.month||12,t.date=t.date||1,e.date=e.date||i.getLastDayInMonth(e.year,e.month)},_getDiffTime:function(){var t,e,n,i,s,a=this._calendar.shownLayerIdx,o=this._calendar.getDate(),r=new Date(o.year,o.month-1),h=new Date(this._startTimes[0]||w).setDate(1),u=new Date(this._endTimes.slice(-1)[0]||x).setDate(1);return 0===a?(i=r-h,s=u-r):1===a?(e=new Date(r).setMonth(0),n=new Date(r).setMonth(11),i=e-h,s=u-n):2===a&&(t=this._calendar._getInfoOfYearRange(o.year),e=Number(new Date(t.startYear,0)),n=Number(new Date(t.endYear,0)),h=new Date(h).setMonth(0),u=new Date(u).setMonth(0),i=e-h,s=u-n),{start:i,end:s}},addRange:function(t,e){t=a({},t),e=a({},e),this._setHashInRange(t,e),this._isValidDateHash(t)&&this._isValidDateHash(e)&&(this._ranges.push([t,e]),this._setSelectableRanges(),this._calendar.draw(0,0,!1,this._shownLayerIdx))},removeRange:function(t,e){var n,i=this._ranges,s=0,o=i.length;for(t=a({},t),e=a({},e),this._setHashInRange(t,e),n=[t,e];s<o;s+=1)if(u(n,i[s])){i.splice(s,1);break}this._setSelectableRanges(),this._calendar.draw(0,0,!1,this._shownLayerIdx)},setRanges:function(t){this._ranges=this._filterValidRanges(t),this._setSelectableRanges()},setXY:function(t,e){var n=this._pos;n.left=h(t)?t:n.left,n.top=h(e)?e:n.top,this._arrangeLayer()},setZIndex:function(t){h(t)&&(this._pos.zIndex=t,this._arrangeLayer())},addOpener:function(t){var e=this.useTouchEvent?"touchend":"click",n=$(t);t=n[0],t&&d(t,this._openers)<0&&(this._openers.push(t),n.on(e,this._proxyHandlers.onClickOpener))},removeOpener:function(t){var e=$(t),n=d(e[0],this._openers);n>-1&&(e.off("click touchend",this._proxyHandlers.onClickOpener),this._openers.splice(n,1))},open:function(){var t;!this.isOpened()&&this._enabledState&&(t=this._date||i.getToday(),this._arrangeLayer(),this._bindCalendarCustomEvent(),this._calendar.draw(t.year,t.month,!1,this._shownLayerIdx),this._$wrapperElement.show(),this.showAlways||this._bindOnMousedownDocument(),this.fire("open"))},close:function(){this.isOpened()&&(this._unbindCalendarCustomEvent(),this._unbindOnMousedownDocument(),this._$wrapperElement.hide(),this.fire("close"))},getDateHash:function(){var t,e;return this._date?(t={},e=this._shownLayerIdx,a(t,this._date),e>1&&delete t.month,e>0&&delete t.date,t):null},getYear:function(){return this._date.year},getMonth:function(){return this._date.month},getDayInMonth:function(){return this._date.date},setDate:function(t,e,n){var s=this._date||i.getToday(),o=a({},this._date),r=this._getCurrentLayer(),h={year:t||s.year,month:e||s.month,date:n||s.date},u=this._isSelectable(h,r)&&!i.isEqualDateHash(o,h);u?(this._date=h,this._setValueToInputElement(),this._calendar.draw(h.year,h.month,!1,r),this.fire("update")):this._setValueToInputElement()},setDateForm:function(t){this._dateFormat=t||this._dateFormat,this._setShownLayerIndexByForm(),this._setRegExp(),this._date&&this.setDate()},isOpened:function(){return"block"===this._$wrapperElement.css("display")},getTimePicker:function(){return this._timePicker},setElement:function(t){var e=this._$element,n=$(t);e[0]&&(this.removeOpener(e),this._unbindKeydownEvent(e)),this.addOpener(n),this._bindKeydownEvent(n),this._setDateFromString(n.val()),this._$element=n},enable:function(){var t;this._enabledState||(this._enabledState=!0,r(this._openers,function(e,n){t=$(e),t.removeAttr("disabled"),t.removeClass(this._disabledClassName),this._bindOnClickOpener(t),n||this._bindKeydownEvent(t)},this))},disable:function(){var t;this._enabledState&&(this._enabledState=!1,this.close(),r(this._openers,function(e,n){t=$(e),t.addClass(this._disabledClassName),t.prop("disabled",!0),this._unbindOnClickOpener(t),n||this._unbindKeydownEvent(t)},this))},destroy:function(){var t=this._$element;t[0]&&this._unbindKeydownEvent(t),this._unbindOnMousedownDocument(),this._unbindOnClickCalendar(),this._unbindCalendarCustomEvent(),this._$wrapperElement.remove()}});s.CustomEvents.mixin(O),t.exports=O},function(t,e,n){"use strict";var i=n(1),s=n(2),a=tui.util,o=/\s*(\d{1,2})\s*:\s*(\d{1,2})\s*([ap][m])?(?:[\s\S]*)/i,r=/\s+|:/g,h='<table class="timepicker"><tr class="timepicker-row"></tr></table>',u='<td class="timepicker-column"></td>',l='<td class="timepicker-column timepicker-spinbox"><div><input type="text" class="timepicker-spinbox-input"></div></td>',d='<button type="button" class="timepicker-btn timepicker-btn-up"><b>+</b></button>',_='<button type="button" class="timepicker-btn timepicker-btn-down"><b>-</b></button>',c='<select><option value="AM">AM</option><option value="PM">PM</option></select>',m=a.defineClass({init:function(t){this.$timePickerElement=null,this._$inputElement=null,this._$meridianElement=null,this._hourSpinbox=null,this._minuteSpinbox=null,this._isShown=!1,this._option=null,this._hour=null,this._minute=null,this._initialize(t)},_initialize:function(t){this._setOption(t),this._makeSpinboxes(),this._makeTimePickerElement(),this._assignDefaultEvents(),this._setTime(this._option.defaultHour,this._option.defaultMinute,!1)},_setOption:function(t){this._option={defaultHour:0,defaultMinute:0,inputElement:null,hourStep:1,minuteStep:1,hourExclusion:null,minuteExclusion:null,showMeridian:!1,position:{}},a.extend(this._option,t)},_makeSpinboxes:function(){var t=this._option,e=t.defaultHour;t.showMeridian&&(e=s.getMeridiemHour(e)),this._hourSpinbox=new i(l,{defaultValue:e,min:t.showMeridian?1:0,max:t.showMeridian?12:23,step:t.hourStep,upBtnTag:d,downBtnTag:_,exclusion:t.hourExclusion}),this._minuteSpinbox=new i(l,{defaultValue:t.defaultMinute,min:0,max:59,step:t.minuteStep,upBtnTag:d,downBtnTag:_,exclusion:t.minuteExclusion})},_makeTimePickerElement:function(){var t,e=this._option,n=$(h),i=n.find(".timepicker-row"),s=$(u).addClass("colon").append(":");i.append(this._hourSpinbox.getContainerElement(),s,this._minuteSpinbox.getContainerElement()),e.showMeridian&&(t=$(u).addClass("meridian").append(c),this._$meridianElement=t.find("select").eq(0),i.append(t)),n.hide(),$("body").append(n),this.$timePickerElement=n,e.inputElement&&(n.css("position","absolute"),this._$inputElement=$(e.inputElement),this._setDefaultPosition(this._$inputElement))},_setDefaultPosition:function(t){var e=t[0],n=this._option.position,i=n.x,s=n.y;a.isNumber(i)&&a.isNumber(s)||(i=e.offsetLeft,s=e.offsetTop+e.offsetHeight+3),this.setXYPosition(i,s)},_assignDefaultEvents:function(){var t=this._$inputElement;t&&(this._assignEventsToInputElement(),this.on("change",function(){t.val(this.getTime())},this)),this._hourSpinbox.on("change",a.bind(this._onChangeSpinbox,this)),this._minuteSpinbox.on("change",a.bind(this._onChangeSpinbox,this)),this.$timePickerElement.on("change","select",a.bind(this._onChangeMeridiem,this))},_assignEventsToInputElement:function(){var t=this,e=this._$inputElement;e.on("click",function(e){t.open(e)}),e.on("change",function(){t.setTimeFromInputElement()||e.val(t.getTime())})},_onChangeSpinbox:function(t){var e=this._hourSpinbox.getValue(),n=this._minuteSpinbox.getValue();this._option.showMeridian&&(("up"===t&&12===e||"down"===t&&11===e)&&(this._isPM=!this._isPM),e=this._getOriginalHour(e)),this._setTime(e,n,!1)},_onChangeMeridiem:function(t){var e="PM"===t.target.value,n=this._hour,i=e?n+12:n%12;this._setTime(i,this._minuteSpinbox.getValue(),!1)},_isClickedInside:function(t){var e=$.contains(this.$timePickerElement[0],t.target),n=this._$inputElement&&this._$inputElement[0]===t.target;return e||n},_formToTimeFormat:function(){var t,e,n=this._hour,i=this._minute,a=this._getPostfix();return this._option.showMeridian&&(n=s.getMeridiemHour(n)),t=n<10?"0"+n:n,e=i<10?"0"+i:i,t+":"+e+a},_setIsPM:function(){this._isPM=this._hour>11},_getPostfix:function(){var t="";return this._option.showMeridian&&(t=this._isPM?" PM":" AM"),t},setXYPosition:function(t,e){a.isNumber(t)&&a.isNumber(e)&&(a.extend(this._option.position,{x:t,y:e}),this.$timePickerElement.css({left:t,top:e}))},show:function(){this.$timePickerElement.show(),this._isShown=!0},hide:function(){this.$timePickerElement.hide(),this._isShown=!1},open:function(t){this._isShown||($(document).on("click",a.bind(this.close,this)),this.show(),this.fire("open",t))},close:function(t){this._isShown&&!this._isClickedInside(t)&&($(document).off(t),this.hide(),this.fire("close",t))},toSpinboxes:function(){var t=this._hour,e=this._minute;this._option.showMeridian&&(t=s.getMeridiemHour(t)),this._hourSpinbox.setValue(t),this._minuteSpinbox.setValue(e)},_getOriginalHour:function(t){var e=this._isPM;return t=e?t<12?t+12:12:t<12?t%12:0},setTimeFromInputElement:function(t){var e=$(t)[0]||this._$inputElement[0];return!(!e||!this.setTimeFromString(e.value))},setHour:function(t){return this._setTime(t,this._minute,!0)},setMinute:function(t){return this._setTime(this._hour,t,!0)},setTime:function(t,e){return this._setTime(t,e)},_setTime:function(t,e,n){var i,s=a.isNumber(t)&&a.isNumber(e),o=t<24&&e<60;return!(!s||!o)&&(this._hour=t,this._minute=e,this._setIsPM(),n&&this.toSpinboxes(),this._$meridianElement&&(i=this._getPostfix().replace(/\s+/,""),this._$meridianElement.val(i)),this.fire("change",n),!0)},setTimeFromString:function(t){var e,n,i,s,a;return o.test(t)&&(e=t.split(r),n=Number(e[0]),i=Number(e[1]),n<24&&this._option.showMeridian&&(s=e[2].toUpperCase(),a="PM"===s||("AM"===s?n>12:this._isPM),a&&n<12?n+=12:a||12!==n||(n=0))),this._setTime(n,i,!0)},setHourStep:function(t){this._hourSpinbox.setStep(t),this._option.hourStep=this._hourSpinbox.getStep()},setMinuteStep:function(t){this._minuteSpinbox.setStep(t),this._option.minuteStep=this._minuteSpinbox.getStep()},addHourExclusion:function(t){this._hourSpinbox.addExclusion(t)},addMinuteExclusion:function(t){this._minuteSpinbox.addExclusion(t)},getHourStep:function(){return this._option.hourStep},getMinuteStep:function(){return this._option.minuteStep},removeHourExclusion:function(t){this._hourSpinbox.removeExclusion(t)},removeMinuteExclusion:function(t){this._minuteSpinbox.removeExclusion(t)},getHour:function(){return this._hour},getMinute:function(){return this._minute},getTime:function(){return this._formToTimeFormat()}});tui.util.CustomEvents.mixin(m),t.exports=m}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vdHVpLWNvbXBvbmVudC1kYXRlLXBpY2tlci5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDAzNDExMGU5NzI4ZjQ1NjBhYWEwIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3BpbmJveC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RhdGVwaWNrZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RpbWVwaWNrZXIuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiRGF0ZVBpY2tlciIsIlRpbWVQaWNrZXIiLCJTcGluYm94IiwidHVpIiwidXRpbCIsImRlZmluZU5hbWVzcGFjZSIsImluQXJyYXkiLCJkZWZpbmVDbGFzcyIsImluaXQiLCJjb250YWluZXIiLCJvcHRpb24iLCJ0aGlzIiwiXyRjb250YWluZXJFbGVtZW50IiwiJCIsIl8kaW5wdXRFbGVtZW50IiwiZmluZCIsIl92YWx1ZSIsIl9vcHRpb24iLCJfJHVwQnV0dG9uIiwiXyRkb3duQnV0dG9uIiwiX2NoYW5nZVR5cGUiLCJfaW5pdGlhbGl6ZSIsIl9zZXRPcHRpb24iLCJfYXNzaWduSFRNTEVsZW1lbnRzIiwiX2Fzc2lnbkRlZmF1bHRFdmVudHMiLCJzZXRWYWx1ZSIsImRlZmF1bHRWYWx1ZSIsInN0ZXAiLCJtYXgiLCJOdW1iZXIiLCJNQVhfU0FGRV9JTlRFR0VSIiwibWluIiwiTUlOX1NBRkVfSU5URUdFUiIsInVwQnRuVGFnIiwiZG93bkJ0blRhZyIsImV4dGVuZCIsImlzQXJyYXkiLCJleGNsdXNpb24iLCJfaXNWYWxpZE9wdGlvbiIsIkVycm9yIiwib3B0IiwiX2lzVmFsaWRWYWx1ZSIsIl9pc1ZhbGlkU3RlcCIsInZhbHVlIiwiaXNCZXR3ZWVuIiwiaXNOb3RJbkFycmF5IiwiaXNOdW1iZXIiLCJtYXhTdGVwIiwiX3NldElucHV0U2l6ZUFuZE1heExlbmd0aCIsIl9tYWtlQnV0dG9uIiwiJGlucHV0IiwiJHVwQnRuIiwiJGRvd25CdG4iLCJpbnNlcnRCZWZvcmUiLCJ3cmFwIiwiaW5zZXJ0QWZ0ZXIiLCJtaW5WYWx1ZUxlbmd0aCIsIlN0cmluZyIsImxlbmd0aCIsIm1heFZhbHVlTGVuZ3RoIiwibWF4bGVuZ3RoIiwiTWF0aCIsImF0dHIiLCJvbkNsaWNrIiwiYmluZCIsIl9vbkNsaWNrQnV0dG9uIiwib25LZXlEb3duIiwiX29uS2V5RG93bklucHV0RWxlbWVudCIsIm9uIiwiaXNEb3duIiwiX29uQ2hhbmdlSW5wdXQiLCJfc2V0TmV4dFZhbHVlIiwibmV4dFZhbHVlIiwiZ2V0VmFsdWUiLCJldmVudCIsImRhdGEiLCJrZXlDb2RlIiwid2hpY2giLCJuZXdWYWx1ZSIsInZhbCIsImlzQ2hhbmdlIiwiZmlyZSIsInNldFN0ZXAiLCJnZXRTdGVwIiwiY2hhbmdlIiwiZ2V0T3B0aW9uIiwiYWRkRXhjbHVzaW9uIiwicHVzaCIsInJlbW92ZUV4Y2x1c2lvbiIsImluZGV4Iiwic3BsaWNlIiwiZ2V0Q29udGFpbmVyRWxlbWVudCIsIkN1c3RvbUV2ZW50cyIsIm1peGluIiwidXRpbHMiLCJnZXREYXRlSGFzaCIsInllYXIiLCJtb250aCIsImRhdGUiLCJuRGF0ZSIsImFyZ3VtZW50cyIsIkRhdGUiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldFRvZGF5IiwiZ2V0VGltZSIsImdldERhdGVPYmplY3QiLCJnZXRGaXJzdERheSIsImdldERheSIsImdldExhc3REYXkiLCJnZXRMYXN0RGF5SW5Nb250aCIsImRhdGVIYXNoIiwiZ2V0UmVsYXRpdmVEYXRlIiwiZGF0ZU9iaiIsIm5ZZWFyIiwibk1vbnRoIiwibkRhdGVPYmoiLCJzZWFyY2giLCJmaWVsZCIsImVuZCIsImZpZWxkVmFsdWUiLCJmb3VuZCIsImxvdyIsImhpZ2giLCJmbG9vciIsImdldE1lcmlkaWVtSG91ciIsImhvdXIiLCJpc0VxdWFsRGF0ZUhhc2giLCJhIiwiYiIsImdldFNhZmVOdW1iZXIiLCJhbnkiLCJkZWZhdWx0TnVtYmVyIiwiaXNOYU4iLCJkYXRlVXRpbCIsImZvckVhY2giLCJjb21wYXJlSlNPTiIsImlzR3JlYXRlclRoYW5PckVxdWFsVG8iLCJjb21wYXJpbmdMZXZlbCIsImZvcm1hdFJlZ0V4cCIsIm1hcEZvckNvbnZlcnRpbmciLCJ5eXl5IiwiZXhwcmVzc2lvbiIsInR5cGUiLCJ5eSIsInkiLCJtbSIsImRkIiwiZCIsIkRBVEVfTEFZRVIiLCJNT05USF9MQVlFUiIsIllFQVJfTEFZRVIiLCJNSU5fWUVBUiIsIk1BWF9ZRUFSIiwiV1JBUFBFUl9UQUciLCJNSU5fRURHRSIsIk1BWF9FREdFIiwiWUVBUl9UT19NUyIsIk1PTlRIX1RPX01TIiwiUkVMQVRJVkVfTU9OVEhfVkFMVUVfS0VZIiwibGF5ZXJzIiwicG9zaXRpb25Gcm9tQm91bmRpbmdLZXlNYXBwZXIiLCJsZWZ0IiwidG9wIiwiZGF0ZUtleXMiLCJtb250aEtleXMiLCJ5ZWFyS2V5cyIsImNhbGVuZGFyIiwiZGF0ZUZvcm1hdCIsImRlZmF1bHRDZW50dXJ5IiwiZGlzYWJsZWRDbGFzc05hbWUiLCJzZWxlY3RhYmxlQ2xhc3NOYW1lIiwic2VsZWN0ZWRDbGFzc05hbWUiLCJzZWxlY3RhYmxlUmFuZ2VzIiwiZW5hYmxlU2V0RGF0ZUJ5RW50ZXJLZXkiLCJzaG93QWx3YXlzIiwidXNlVG91Y2hFdmVudCIsIl9jYWxlbmRhciIsIl8kZWxlbWVudCIsImVsZW1lbnQiLCJfJHdyYXBwZXJFbGVtZW50IiwiX2RhdGVGb3JtYXQiLCJkYXRlRm9ybSIsIl9yZWdFeHAiLCJfZm9ybU9yZGVyIiwiX2RhdGUiLCJfZGVmYXVsdENlbnR1cnkiLCJfc2VsZWN0YWJsZUNsYXNzTmFtZSIsIl9zZWxlY3RlZENsYXNzTmFtZSIsIl9lbmFibGVTZXREYXRlQnlFbnRlcktleSIsIl9zdGFydFRpbWVzIiwiX2VuZFRpbWVzIiwiX3JhbmdlcyIsIl90aW1lUGlja2VyIiwiX3BvcyIsIl9vcGVuZXJzIiwiX3Byb3h5SGFuZGxlcnMiLCJfc2hvd25MYXllcklkeCIsIl9lbmFibGVkU3RhdGUiLCJfZGlzYWJsZWRDbGFzc05hbWUiLCJkb2N1bWVudCIsIl9pbml0aWFsaXplRGF0ZVBpY2tlciIsIl9maWx0ZXJWYWxpZFJhbmdlcyIsIl9kZXRhY2hDYWxlbmRhckV2ZW50IiwiX3NldFNlbGVjdGFibGVSYW5nZXMiLCJfc2V0V3JhcHBlckVsZW1lbnQiLCJwYXJlbnRFbGVtZW50IiwiX3NldERlZmF1bHREYXRlIiwiX3NldERlZmF1bHRQb3NpdGlvbiIsInBvcyIsIl9zZXRQcm94eUhhbmRsZXJzIiwiX3NldE9wZW5lcnMiLCJvcGVuZXJzIiwiX2JpbmRLZXlkb3duRXZlbnQiLCJfc2V0VGltZVBpY2tlciIsInRpbWVQaWNrZXIiLCJzZXREYXRlRm9ybSIsImhpZGUiLCIkZWxlbWVudCIsInNob3ciLCJyYW5nZXMiLCJzdGFydEhhc2giLCJlbmRIYXNoIiwiZmlsdGVyIiwicmFuZ2UiLCJfc2V0SGFzaEluUmFuZ2UiLCJfaXNWYWxpZERhdGVIYXNoIiwiZGV0YWNoRXZlbnRUb0JvZHkiLCIkd3JhcHBlckVsZW1lbnQiLCIkcGFyZW50RWxlbWVudCIsImFwcGVuZCIsImFwcGVuZFRvIiwiYm9keSIsIm9wRGF0ZSIsInRlc3QiLCJfc2V0U2hvd25MYXllckluZGV4QnlGb3JtIiwiX2lzU2VsZWN0YWJsZSIsIl9nZXRDdXJyZW50TGF5ZXIiLCJvcFBvcyIsImJvdW5kIiwiX2dldEJvdW5kaW5nQ2xpZW50UmVjdCIsInpJbmRleCIsImJvdW5kaW5nS2V5IiwicG9zS2V5IiwiX3VwZGF0ZVRpbWVSYW5nZSIsInN0YXJ0IiwibmV3VGltZVJhbmdlIiwiZXhpc3RpbmdUaW1lUmFuZ2UiLCJtZXJnZWRUaW1lUmFuZ2UiLCJfc2VhcmNoU3RhcnRUaW1lIiwiX2lzT3ZlcmxhcHBlZFRpbWVSYW5nZSIsIl9tZXJnZVRpbWVSYW5nZXMiLCJleGlzdGluZ1N0YXJ0IiwiZXhpc3RpbmdFbmQiLCJuZXdTdGFydCIsIm5ld0VuZCIsImlzVHJ1dGh5IiwiaXNPdmVybGFwcGVkIiwidGltZXN0YW1wIiwiX3NlYXJjaEVuZFRpbWUiLCJvcE9wZW5lcnMiLCJhZGRPcGVuZXIiLCJvcGVuZXIiLCJvcFRpbWVQaWNrZXIiLCJfYmluZEN1c3RvbUV2ZW50V2l0aFRpbWVQaWNrZXIiLCJvbkNoYW5nZVRpbWVQaWNrZXIiLCJzZXREYXRlIiwic2V0VGltZUZyb21JbnB1dEVsZW1lbnQiLCJvZmYiLCJfaXNWYWxpZFllYXIiLCJfaXNWYWxpZE1vbnRoIiwiX2lzVmFsaWREYXlJbk1vbnRoIiwiX2lzT3BlbmVyIiwidGFyZ2V0IiwicmVzdWx0IiwiaSIsImxlbiIsImNvbnRhaW5zIiwiX2FycmFuZ2VMYXllciIsInN0eWxlIiwiJHRpbWVQaWNrZXJFbGVtZW50IiwiY2VpbCIsImVsIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiYm90dG9tIiwicmlnaHQiLCJfc2V0RGF0ZUZyb21TdHJpbmciLCJzdHIiLCJfZXh0cmFjdERhdGUiLCJfbWFrZURhdGVTdHJpbmciLCJyZXBsYWNlTWFwIiwiZGF0ZVN0cmluZyIsImZvcm1hdCIsInN1YnN0ciIsInJlcGxhY2UiLCJrZXkiLCJ0b0xvd2VyQ2FzZSIsImZvcm1PcmRlciIsInJlc3VsdERhdGUiLCJyZWdFeHAiLCJsYXN0SW5kZXgiLCJSZWdFeHAiLCIkMSIsIiQyIiwiJDMiLCJsYXllclR5cGUiLCJzdGFydFRpbWUiLCJzZWFyY2hSZXN1bHQiLCJzdGFydFRpbWVzIiwiX3NldFNlbGVjdGFibGVDbGFzc05hbWUiLCJhZGRDbGFzcyIsIl9zZXRTZWxlY3RlZENsYXNzTmFtZSIsImlzU2VsZWN0ZWQiLCJjdXJEYXRlSGFzaCIsIl9zZXRWYWx1ZVRvSW5wdXRFbGVtZW50IiwidGltZVN0cmluZyIsIl9zZXRSZWdFeHAiLCJyZWdFeHBTdHIiLCJtYXRjaGVkS2V5cyIsIm1hdGNoIiwicHJveGllcyIsIm9uTW91c2Vkb3duRG9jdW1lbnQiLCJfb25Nb3VzZWRvd25Eb2N1bWVudCIsIm9uS2V5ZG93bkVsZW1lbnQiLCJfb25LZXlkb3duRWxlbWVudCIsIm9uQ2xpY2tDYWxlbmRhciIsIl9vbkNsaWNrQ2FsZW5kYXIiLCJvbkNsaWNrT3BlbmVyIiwiX29uQ2xpY2tPcGVuZXIiLCJvbkJlZm9yZURyYXdDYWxlbmRhciIsIl9vbkJlZm9yZURyYXdDYWxlbmRhciIsIm9uRHJhd0NhbGVuZGFyIiwiX29uRHJhd0NhbGVuZGFyIiwib25BZnRlckRyYXdDYWxlbmRhciIsIl9vbkFmdGVyRHJhd0NhbGVuZGFyIiwiaXNDb250YWlucyIsImNsb3NlIiwicmVsYXRpdmVNb250aCIsImNsYXNzTmFtZSIsImlubmVyVGV4dCIsInRleHRDb250ZW50Iiwibm9kZVZhbHVlIiwic2hvd25MYXllcklkeCIsInNob3duRGF0ZSIsInN0YXJ0TGF5ZXJJZHgiLCJpbmRleE9mIiwiaW52b2tlIiwiZHJhdyIsImlzT3BlbmVkIiwib3BlbiIsIl91bmJpbmRPbkNsaWNrQ2FsZW5kYXIiLCJldmVudERhdGEiLCIkZGF0ZUNvbnRhaW5lciIsImNsYXNzTmFtZXMiLCJfc2hvd09ubHlWYWxpZEJ1dHRvbnMiLCJfYmluZE9uQ2xpY2tDYWxlbmRhciIsIiRoZWFkZXIiLCIkcHJldkJ0biIsIiRuZXh0QnRuIiwiZGlmZlRpbWUiLCJfZ2V0RGlmZlRpbWUiLCIkdGFyZ2V0RWwiLCJfdW5iaW5kS2V5ZG93bkV2ZW50IiwiX2JpbmRPbk1vdXNlZG93bkRvY3VtZW50IiwiZXZlbnRUeXBlIiwiX3VuYmluZE9uTW91c2Vkb3duRG9jdW1lbnQiLCJoYW5kbGVyIiwiX2JpbmRDYWxlbmRhckN1c3RvbUV2ZW50IiwicHJveHlIYW5kbGVycyIsIm9uQmVmb3JlRHJhdyIsIm9uRHJhdyIsIm9uQWZ0ZXJEcmF3IiwiYmVmb3JlRHJhdyIsImFmdGVyRHJhdyIsIl91bmJpbmRDYWxlbmRhckN1c3RvbUV2ZW50IiwiX2JpbmRPbkNsaWNrT3BlbmVyIiwiX3VuYmluZE9uQ2xpY2tPcGVuZXIiLCJfc2hvdWxkU2hvd0xheWVyIiwiY2FuZGlkYXRlcyIsIm1hdGNoZWRMYXllcnMiLCJmdW5jdG9yIiwibGF5ZXJJZHgiLCJ5ZWFyUmFuZ2UiLCJzaG93blN0YXJ0RGF0ZSIsInNob3duRW5kRGF0ZSIsInN0YXJ0RGlmZmVyZW5jZSIsImVuZERpZmZlcmVuY2UiLCJzaG93bkRhdGVIYXNoIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInNsaWNlIiwic2V0TW9udGgiLCJfZ2V0SW5mb09mWWVhclJhbmdlIiwic3RhcnRZZWFyIiwiZW5kWWVhciIsImFkZFJhbmdlIiwicmVtb3ZlUmFuZ2UiLCJzZXRSYW5nZXMiLCJzZXRYWSIsIngiLCJzZXRaSW5kZXgiLCIkb3BlbmVyIiwicmVtb3ZlT3BlbmVyIiwiZGVwdGhJZHgiLCJnZXRZZWFyIiwiZ2V0RGF5SW5Nb250aCIsInByZXZEYXRlT2JqIiwiY3VycmVudExheWVyIiwibmV3RGF0ZU9iaiIsInNob3VsZFVwZGF0ZSIsImNzcyIsImdldFRpbWVQaWNrZXIiLCJzZXRFbGVtZW50IiwiJGN1cnJlbnRFbCIsIiRuZXdFbCIsImVuYWJsZSIsIiRvcGVuZXJFbCIsIm9wZW5lckVsIiwiaWR4IiwicmVtb3ZlQXR0ciIsInJlbW92ZUNsYXNzIiwiZGlzYWJsZSIsInByb3AiLCJkZXN0cm95IiwicmVtb3ZlIiwidGltZVJlZ0V4cCIsInRpbWVTZXBlcmF0b3IiLCJ0aW1lUGlja2VyVGFnIiwiY29sdW1uVGFnIiwic3BpbkJveFRhZyIsIm1lcmlkaWVtVGFnIiwiXyRtZXJpZGlhbkVsZW1lbnQiLCJfaG91clNwaW5ib3giLCJfbWludXRlU3BpbmJveCIsIl9pc1Nob3duIiwiX2hvdXIiLCJfbWludXRlIiwiX21ha2VTcGluYm94ZXMiLCJfbWFrZVRpbWVQaWNrZXJFbGVtZW50IiwiX3NldFRpbWUiLCJkZWZhdWx0SG91ciIsImRlZmF1bHRNaW51dGUiLCJpbnB1dEVsZW1lbnQiLCJob3VyU3RlcCIsIm1pbnV0ZVN0ZXAiLCJob3VyRXhjbHVzaW9uIiwibWludXRlRXhjbHVzaW9uIiwic2hvd01lcmlkaWFuIiwicG9zaXRpb24iLCIkbWVyaWRpYW4iLCIkdHAiLCIkdHBSb3ciLCIkY29sb24iLCJlcSIsImlucHV0RWwiLCJvZmZzZXRMZWZ0Iiwib2Zmc2V0VG9wIiwib2Zmc2V0SGVpZ2h0Iiwic2V0WFlQb3NpdGlvbiIsIl9hc3NpZ25FdmVudHNUb0lucHV0RWxlbWVudCIsIl9vbkNoYW5nZVNwaW5ib3giLCJfb25DaGFuZ2VNZXJpZGllbSIsInNlbGYiLCJtaW51dGUiLCJfaXNQTSIsIl9nZXRPcmlnaW5hbEhvdXIiLCJpc1BNIiwiY3VycmVudEhvdXIiLCJfaXNDbGlja2VkSW5zaWRlIiwiaXNJbnB1dEVsZW1lbnQiLCJfZm9ybVRvVGltZUZvcm1hdCIsImZvcm1hdHRlZEhvdXIiLCJmb3JtYXR0ZWRNaW51dGUiLCJwb3N0Zml4IiwiX2dldFBvc3RmaXgiLCJfc2V0SXNQTSIsInRvU3BpbmJveGVzIiwiaW5wdXQiLCJzZXRUaW1lRnJvbVN0cmluZyIsInNldEhvdXIiLCJzZXRNaW51dGUiLCJzZXRUaW1lIiwiaXNTZXRTcGluYm94IiwiaXNWYWxpZCIsInRpbWUiLCJzcGxpdCIsInRvVXBwZXJDYXNlIiwic2V0SG91clN0ZXAiLCJzZXRNaW51dGVTdGVwIiwiYWRkSG91ckV4Y2x1c2lvbiIsImFkZE1pbnV0ZUV4Y2x1c2lvbiIsImdldEhvdXJTdGVwIiwiZ2V0TWludXRlU3RlcCIsInJlbW92ZUhvdXJFeGNsdXNpb24iLCJyZW1vdmVNaW51dGVFeGNsdXNpb24iLCJnZXRIb3VyIiwiZ2V0TWludXRlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Q0FNUyxTQUFVQSxHQ0ZuQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBRSxXQUNBRSxHQUFBSixFQUNBSyxRQUFBLEVBVUEsT0FOQVAsR0FBQUUsR0FBQU0sS0FB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QUFwSCxLQUFBTSxRQUFBK2EsZUFDQTBCLEVBQUFXLEVBQUEsR0FBQUUsY0FHQXBCLEVBREEsT0FBQU8sSUFFaUIsT0FBQUEsRUFDakIzVixFQUFBLEdBRUFwSCxLQUFBc2MsT0FHQUUsR0FBQXBWLEVBQUEsR0FDQUEsR0FBQSxHQUNpQm9WLEdBQUEsS0FBQXBWLElBQ2pCQSxFQUFBLEtBS0FwSCxLQUFBNmEsU0FBQXpULEVBQUFpVixHQUFBLElBT0F3QixZQUFBLFNBQUE3YyxHQUNBaEIsS0FBQXNhLGFBQUEvVixRQUFBdkQsR0FDQWhCLEtBQUFNLFFBQUEyYSxTQUFBamIsS0FBQXNhLGFBQUE5VixXQU9Bc1osY0FBQSxTQUFBOWMsR0FDQWhCLEtBQUF1YSxlQUFBaFcsUUFBQXZELEdBQ0FoQixLQUFBTSxRQUFBNGEsV0FBQWxiLEtBQUF1YSxlQUFBL1YsV0FPQXVaLGlCQUFBLFNBQUEzVyxHQUNBcEgsS0FBQXNhLGFBQUEzVixhQUFBeUMsSUFPQTRXLG1CQUFBLFNBQUEzQixHQUNBcmMsS0FBQXVhLGVBQUE1VixhQUFBMFgsSUFPQTRCLFlBQUEsV0FDQSxNQUFBamUsTUFBQU0sUUFBQTJhLFVBT0FpRCxjQUFBLFdBQ0EsTUFBQWxlLE1BQUFNLFFBQUE0YSxZQU9BaUQsb0JBQUEsU0FBQS9XLEdBQ0FwSCxLQUFBc2EsYUFBQXpWLGdCQUFBdUMsSUFPQWdYLHNCQUFBLFNBQUEvQixHQUNBcmMsS0FBQXVhLGVBQUExVixnQkFBQXdYLElBT0FnQyxRQUFBLFdBQ0EsTUFBQXJlLE1BQUF5YSxPQU9BNkQsVUFBQSxXQUNBLE1BQUF0ZSxNQUFBMGEsU0FPQTNVLFFBQUEsV0FDQSxNQUFBL0YsTUFBQTRjLHNCQUdBcGQsS0FBQUMsS0FBQXdGLGFBQUFDLE1BQUE1RixHQUVBUixFQUFBRCxRQUFBUyIsImZpbGUiOiJ0dWktY29tcG9uZW50LWRhdGUtcGlja2VyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogdHVpLWNvbXBvbmVudC1kYXRlLXBpY2tlci5taW4uanNcbiAqIEB2ZXJzaW9uIDEuNi4wXG4gKiBAYXV0aG9yIE5ITkVudCBGRSBEZXZlbG9wbWVudCBMYWIgPGRsX2phdmFzY3JpcHRAbmhuZW50LmNvbT5cbiAqIEBsaWNlbnNlIE1JVFxuICovXG4vKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJkaXN0XCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgRGF0ZVBpY2tlciA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdHZhciBUaW1lUGlja2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0dmFyIFNwaW5ib3ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dHVpLnV0aWwuZGVmaW5lTmFtZXNwYWNlKCd0dWkuY29tcG9uZW50Jywge1xuXHQgICAgRGF0ZVBpY2tlcjogRGF0ZVBpY2tlcixcblx0ICAgIFRpbWVQaWNrZXI6IFRpbWVQaWNrZXIsXG5cdCAgICBTcGluYm94OiBTcGluYm94XG5cdH0pO1xuXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKipcblx0ICogQ3JlYXRlZCBieSBuaG5lbnQgb24gMTUuIDQuIDI4Li5cblx0ICogQGZpbGVvdmVydmlldyBTcGluYm94IENvbXBvbmVudFxuXHQgKiBAYXV0aG9yIE5ITiBlbnQgRkUgZGV2IExhYiA8ZGxfamF2YXNjcmlwdEBuaG5lbnQuY29tPlxuXHQgKiBAZGVwZW5kZW5jeSBqcXVlcnktMS44LjMsIGNvZGUtc25pcHBldC0xLjAuMlxuXHQgKi9cblx0XG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciB1dGlsID0gdHVpLnV0aWw7XG5cdHZhciBpbkFycmF5ID0gdXRpbC5pbkFycmF5O1xuXHRcblx0LyoqXG5cdCAqIEBjb25zdHJ1Y3RvclxuXHQgKiBAcGFyYW0ge1N0cmluZ3xIVE1MRWxlbWVudH0gY29udGFpbmVyIC0gY29udGFpbmVyIG9mIHNwaW5ib3hcblx0ICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25dIC0gb3B0aW9uIGZvciBpbml0aWFsaXphdGlvblxuXHQgKlxuXHQgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5kZWZhdWx0VmFsdWUgPSAwXSAtIGluaXRpYWwgc2V0dGluZyB2YWx1ZVxuXHQgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5zdGVwID0gMV0gLSBpZiBzdGVwID0gMiwgdmFsdWUgOiAwIC0+IDIgLT4gNCAtPiAuLi5cblx0ICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24ubWF4ID0gOTAwNzE5OTI1NDc0MDk5MV0gLSBtYXggdmFsdWVcblx0ICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24ubWluID0gLTkwMDcxOTkyNTQ3NDA5OTFdIC0gbWluIHZhbHVlXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLnVwQnRuVGFnID0gYnV0dG9uIEhUTUxdIC0gdXAgYnV0dG9uIGh0bWwgc3RyaW5nXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLmRvd25CdG5UYWcgPSBidXR0b24gSFRNTF0gLSBkb3duIGJ1dHRvbiBodG1sIHN0cmluZ1xuXHQgKiBAcGFyYW0ge0FycmF5fSAgW29wdGlvbi5leGNsdXNpb24gPSBbXV0gLSB2YWx1ZSB0byBiZSBleGNsdWRlZC4gaWYgdGhpcyBpcyBbMSwzXSwgMCAtPiAyIC0+IDQgLT4gNSAtPi4uLi5cblx0ICpcblx0ICogQHR1dG9yaWFsIHNhbXBsZTRcblx0ICovXG5cdHZhciBTcGluYm94ID0gdXRpbC5kZWZpbmVDbGFzcygvKiogQGxlbmRzIFNwaW5ib3gucHJvdG90eXBlICovIHtcblx0ICAgIGluaXQ6IGZ1bmN0aW9uKGNvbnRhaW5lciwgb3B0aW9uKSB7XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuXyRjb250YWluZXJFbGVtZW50ID0gJChjb250YWluZXIpO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fJGlucHV0RWxlbWVudCA9IHRoaXMuXyRjb250YWluZXJFbGVtZW50LmZpbmQoJ2lucHV0W3R5cGU9XCJ0ZXh0XCJdJyk7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl92YWx1ZSA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9vcHRpb24gPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fJHVwQnV0dG9uID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuXyRkb3duQnV0dG9uID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHR5cGUge3N0cmluZ31cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX2NoYW5nZVR5cGUgPSAnZGVmYXVsdCc7XG5cdFxuXHQgICAgICAgIHRoaXMuX2luaXRpYWxpemUob3B0aW9uKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBJbml0aWFsaXplIHdpdGggb3B0aW9uXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uIC0gT3B0aW9uIGZvciBJbml0aWFsaXphdGlvblxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2luaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbikge1xuXHQgICAgICAgIHRoaXMuX3NldE9wdGlvbihvcHRpb24pO1xuXHQgICAgICAgIHRoaXMuX2Fzc2lnbkhUTUxFbGVtZW50cygpO1xuXHQgICAgICAgIHRoaXMuX2Fzc2lnbkRlZmF1bHRFdmVudHMoKTtcblx0ICAgICAgICB0aGlzLnNldFZhbHVlKHRoaXMuX29wdGlvbi5kZWZhdWx0VmFsdWUpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBhIG9wdGlvbiB0byBpbnN0YW5jZVxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbiAtIE9wdGlvbiB0aGF0IHlvdSB3YW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0T3B0aW9uOiBmdW5jdGlvbihvcHRpb24pIHtcblx0ICAgICAgICB0aGlzLl9vcHRpb24gPSB7XG5cdCAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogMCxcblx0ICAgICAgICAgICAgc3RlcDogMSxcblx0ICAgICAgICAgICAgbWF4OiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCA5MDA3MTk5MjU0NzQwOTkxLFxuXHQgICAgICAgICAgICBtaW46IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSIHx8IC05MDA3MTk5MjU0NzQwOTkxLFxuXHQgICAgICAgICAgICB1cEJ0blRhZzogJzxidXR0b24gdHlwZT1cImJ1dHRvblwiPjxiPis8L2I+PC9idXR0b24+Jyxcblx0ICAgICAgICAgICAgZG93bkJ0blRhZzogJzxidXR0b24gdHlwZT1cImJ1dHRvblwiPjxiPi08L2I+PC9idXR0b24+J1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdXRpbC5leHRlbmQodGhpcy5fb3B0aW9uLCBvcHRpb24pO1xuXHRcblx0ICAgICAgICBpZiAoIXV0aWwuaXNBcnJheSh0aGlzLl9vcHRpb24uZXhjbHVzaW9uKSkge1xuXHQgICAgICAgICAgICB0aGlzLl9vcHRpb24uZXhjbHVzaW9uID0gW107XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoIXRoaXMuX2lzVmFsaWRPcHRpb24oKSkge1xuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NwaW5ib3ggb3B0aW9uIGlzIGludmFpbGQnKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogaXMgYSB2YWxpZCBvcHRpb24/XG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfaXNWYWxpZE9wdGlvbjogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIG9wdCA9IHRoaXMuX29wdGlvbjtcblx0XG5cdCAgICAgICAgcmV0dXJuICh0aGlzLl9pc1ZhbGlkVmFsdWUob3B0LmRlZmF1bHRWYWx1ZSkgJiYgdGhpcy5faXNWYWxpZFN0ZXAob3B0LnN0ZXApKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBpcyBhIHZhbGlkIHZhbHVlP1xuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIGZvciBzcGluYm94XG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfaXNWYWxpZFZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIHZhciBvcHQsXG5cdCAgICAgICAgICAgIGlzQmV0d2Vlbixcblx0ICAgICAgICAgICAgaXNOb3RJbkFycmF5O1xuXHRcblx0ICAgICAgICBpZiAoIXV0aWwuaXNOdW1iZXIodmFsdWUpKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIG9wdCA9IHRoaXMuX29wdGlvbjtcblx0ICAgICAgICBpc0JldHdlZW4gPSB2YWx1ZSA8PSBvcHQubWF4ICYmIHZhbHVlID49IG9wdC5taW47XG5cdCAgICAgICAgaXNOb3RJbkFycmF5ID0gKGluQXJyYXkodmFsdWUsIG9wdC5leGNsdXNpb24pID09PSAtMSk7XG5cdFxuXHQgICAgICAgIHJldHVybiAoaXNCZXR3ZWVuICYmIGlzTm90SW5BcnJheSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogaXMgYSB2YWxpZCBzdGVwP1xuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAgZm9yIHNwaW5ib3ggdXAvZG93blxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2lzVmFsaWRTdGVwOiBmdW5jdGlvbihzdGVwKSB7XG5cdCAgICAgICAgdmFyIG1heFN0ZXAgPSAodGhpcy5fb3B0aW9uLm1heCAtIHRoaXMuX29wdGlvbi5taW4pO1xuXHRcblx0ICAgICAgICByZXR1cm4gKHV0aWwuaXNOdW1iZXIoc3RlcCkgJiYgc3RlcCA8IG1heFN0ZXApO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEFzc2lnbiBlbGVtZW50cyB0byBpbnNpZGUgb2YgY29udGFpbmVyLlxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2Fzc2lnbkhUTUxFbGVtZW50czogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdGhpcy5fc2V0SW5wdXRTaXplQW5kTWF4TGVuZ3RoKCk7XG5cdCAgICAgICAgdGhpcy5fbWFrZUJ1dHRvbigpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIE1ha2UgdXAvZG93biBidXR0b25cblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9tYWtlQnV0dG9uOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgJGlucHV0ID0gdGhpcy5fJGlucHV0RWxlbWVudCxcblx0ICAgICAgICAgICAgJHVwQnRuID0gdGhpcy5fJHVwQnV0dG9uID0gJCh0aGlzLl9vcHRpb24udXBCdG5UYWcpLFxuXHQgICAgICAgICAgICAkZG93bkJ0biA9IHRoaXMuXyRkb3duQnV0dG9uID0gJCh0aGlzLl9vcHRpb24uZG93bkJ0blRhZyk7XG5cdFxuXHQgICAgICAgICR1cEJ0bi5pbnNlcnRCZWZvcmUoJGlucHV0KTtcblx0ICAgICAgICAkdXBCdG4ud3JhcCgnPGRpdj48L2Rpdj4nKTtcblx0ICAgICAgICAkZG93bkJ0bi5pbnNlcnRBZnRlcigkaW5wdXQpO1xuXHQgICAgICAgICRkb3duQnRuLndyYXAoJzxkaXY+PC9kaXY+Jyk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IHNpemUvbWF4bGVuZ3RoIGF0dHJpYnV0ZXMgb2YgaW5wdXQgZWxlbWVudC5cblx0ICAgICAqIERlZmF1bHQgdmFsdWUgaXMgYSBkaWdpdHMgb2YgYSBsb25nZXIgdmFsdWUgb2Ygb3B0aW9uLm1pbiBvciBvcHRpb24ubWF4XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0SW5wdXRTaXplQW5kTWF4TGVuZ3RoOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgJGlucHV0ID0gdGhpcy5fJGlucHV0RWxlbWVudCxcblx0ICAgICAgICAgICAgbWluVmFsdWVMZW5ndGggPSBTdHJpbmcodGhpcy5fb3B0aW9uLm1pbikubGVuZ3RoLFxuXHQgICAgICAgICAgICBtYXhWYWx1ZUxlbmd0aCA9IFN0cmluZyh0aGlzLl9vcHRpb24ubWF4KS5sZW5ndGgsXG5cdCAgICAgICAgICAgIG1heGxlbmd0aCA9IE1hdGgubWF4KG1pblZhbHVlTGVuZ3RoLCBtYXhWYWx1ZUxlbmd0aCk7XG5cdFxuXHQgICAgICAgIGlmICghJGlucHV0LmF0dHIoJ3NpemUnKSkge1xuXHQgICAgICAgICAgICAkaW5wdXQuYXR0cignc2l6ZScsIG1heGxlbmd0aCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICghJGlucHV0LmF0dHIoJ21heGxlbmd0aCcpKSB7XG5cdCAgICAgICAgICAgICRpbnB1dC5hdHRyKCdtYXhsZW5ndGgnLCBtYXhsZW5ndGgpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBBc3NpZ24gZGVmYXVsdCBldmVudHMgdG8gdXAvZG93biBidXR0b25cblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9hc3NpZ25EZWZhdWx0RXZlbnRzOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgb25DbGljayA9IHV0aWwuYmluZCh0aGlzLl9vbkNsaWNrQnV0dG9uLCB0aGlzKSxcblx0ICAgICAgICAgICAgb25LZXlEb3duID0gdXRpbC5iaW5kKHRoaXMuX29uS2V5RG93bklucHV0RWxlbWVudCwgdGhpcyk7XG5cdFxuXHQgICAgICAgIHRoaXMuXyR1cEJ1dHRvbi5vbignY2xpY2snLCB7aXNEb3duOiBmYWxzZX0sIG9uQ2xpY2spO1xuXHQgICAgICAgIHRoaXMuXyRkb3duQnV0dG9uLm9uKCdjbGljaycsIHtpc0Rvd246IHRydWV9LCBvbkNsaWNrKTtcblx0ICAgICAgICB0aGlzLl8kaW5wdXRFbGVtZW50Lm9uKCdrZXlkb3duJywgb25LZXlEb3duKTtcblx0ICAgICAgICB0aGlzLl8kaW5wdXRFbGVtZW50Lm9uKCdjaGFuZ2UnLCB1dGlsLmJpbmQodGhpcy5fb25DaGFuZ2VJbnB1dCwgdGhpcykpO1xuXHQgICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnQub24oJ2ZvY3VzJywgdXRpbC5iaW5kKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICB0aGlzLl9jaGFuZ2VUeXBlID0gJ2RlZmF1bHQnO1xuXHQgICAgICAgIH0sIHRoaXMpKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgaW5wdXQgdmFsdWUgd2hlbiB1c2VyIGNsaWNrIGEgYnV0dG9uLlxuXHQgICAgICogQHBhcmFtIHtib29sZWFufSBpc0Rvd24gLSBJZiBhIHVzZXIgY2xpY2tlZCBhIGRvd24tYnV0dHRvbiwgdGhpcyB2YWx1ZSBpcyB0cnVlLlxuXHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICBFbHNlIGlmIGEgdXNlciBjbGlja2VkIGEgdXAtYnV0dG9uLCB0aGlzIHZhbHVlIGlzIGZhbHNlLlxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3NldE5leHRWYWx1ZTogZnVuY3Rpb24oaXNEb3duKSB7XG5cdCAgICAgICAgdmFyIG9wdCA9IHRoaXMuX29wdGlvbixcblx0ICAgICAgICAgICAgc3RlcCA9IG9wdC5zdGVwLFxuXHQgICAgICAgICAgICBtaW4gPSBvcHQubWluLFxuXHQgICAgICAgICAgICBtYXggPSBvcHQubWF4LFxuXHQgICAgICAgICAgICBleGNsdXNpb24gPSBvcHQuZXhjbHVzaW9uLFxuXHQgICAgICAgICAgICBuZXh0VmFsdWUgPSB0aGlzLmdldFZhbHVlKCk7XG5cdFxuXHQgICAgICAgIGlmIChpc0Rvd24pIHtcblx0ICAgICAgICAgICAgc3RlcCA9IC1zdGVwO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZG8ge1xuXHQgICAgICAgICAgICBuZXh0VmFsdWUgKz0gc3RlcDtcblx0ICAgICAgICAgICAgaWYgKG5leHRWYWx1ZSA+IG1heCkge1xuXHQgICAgICAgICAgICAgICAgbmV4dFZhbHVlID0gbWluO1xuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKG5leHRWYWx1ZSA8IG1pbikge1xuXHQgICAgICAgICAgICAgICAgbmV4dFZhbHVlID0gbWF4O1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSB3aGlsZSAoaW5BcnJheShuZXh0VmFsdWUsIGV4Y2x1c2lvbikgPiAtMSk7XG5cdFxuXHQgICAgICAgIHRoaXMuX2NoYW5nZVR5cGUgPSBpc0Rvd24gPyAnZG93bicgOiAndXAnO1xuXHRcblx0ICAgICAgICB0aGlzLnNldFZhbHVlKG5leHRWYWx1ZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRE9NKFVwL0Rvd24gYnV0dG9uKSBDbGljayBFdmVudCBoYW5kbGVyXG5cdCAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBldmVudC1vYmplY3Rcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9vbkNsaWNrQnV0dG9uOiBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgIHRoaXMuX3NldE5leHRWYWx1ZShldmVudC5kYXRhLmlzRG93bik7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRE9NKElucHV0IGVsZW1lbnQpIEtleWRvd24gRXZlbnQgaGFuZGxlclxuXHQgICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgZXZlbnQtb2JqZWN0XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfb25LZXlEb3duSW5wdXRFbGVtZW50OiBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgIHZhciBrZXlDb2RlID0gZXZlbnQud2hpY2ggfHwgZXZlbnQua2V5Q29kZTtcblx0ICAgICAgICB2YXIgaXNEb3duO1xuXHRcblx0ICAgICAgICBzd2l0Y2ggKGtleUNvZGUpIHtcblx0ICAgICAgICAgICAgY2FzZSAzODpcblx0ICAgICAgICAgICAgICAgIGlzRG93biA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGNhc2UgNDA6XG5cdCAgICAgICAgICAgICAgICBpc0Rvd24gPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMuX3NldE5leHRWYWx1ZShpc0Rvd24pO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERPTShJbnB1dCBlbGVtZW50KSBDaGFuZ2UgRXZlbnQgaGFuZGxlclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX29uQ2hhbmdlSW5wdXQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBuZXdWYWx1ZSA9IE51bWJlcih0aGlzLl8kaW5wdXRFbGVtZW50LnZhbCgpKSxcblx0ICAgICAgICAgICAgaXNDaGFuZ2UgPSB0aGlzLl9pc1ZhbGlkVmFsdWUobmV3VmFsdWUpICYmIHRoaXMuX3ZhbHVlICE9PSBuZXdWYWx1ZSxcblx0ICAgICAgICAgICAgbmV4dFZhbHVlID0gKGlzQ2hhbmdlKSA/IG5ld1ZhbHVlIDogdGhpcy5fdmFsdWU7XG5cdFxuXHQgICAgICAgIHRoaXMuX3ZhbHVlID0gbmV4dFZhbHVlO1xuXHQgICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnQudmFsKG5leHRWYWx1ZSk7XG5cdFxuXHQgICAgICAgIHRoaXMuZmlyZSgnY2hhbmdlJywgdGhpcy5fY2hhbmdlVHlwZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogc2V0IHN0ZXAgb2Ygc3BpbmJveFxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAgZm9yIHNwaW5ib3hcblx0ICAgICAqL1xuXHQgICAgc2V0U3RlcDogZnVuY3Rpb24oc3RlcCkge1xuXHQgICAgICAgIGlmICghdGhpcy5faXNWYWxpZFN0ZXAoc3RlcCkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0aGlzLl9vcHRpb24uc3RlcCA9IHN0ZXA7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogZ2V0IHN0ZXAgb2Ygc3BpbmJveFxuXHQgICAgICogQHJldHVybnMge251bWJlcn0gc3RlcFxuXHQgICAgICovXG5cdCAgICBnZXRTdGVwOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9uLnN0ZXA7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJuIGEgaW5wdXQgdmFsdWUuXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBEYXRhIGluIGlucHV0LWJveFxuXHQgICAgICovXG5cdCAgICBnZXRWYWx1ZTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBhIHZhbHVlIHRvIGlucHV0LWJveC5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIFZhbHVlIHRoYXQgeW91IHdhbnRcblx0ICAgICAqL1xuXHQgICAgc2V0VmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgdGhpcy5fJGlucHV0RWxlbWVudC52YWwodmFsdWUpLmNoYW5nZSgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybiBhIG9wdGlvbiBvZiBpbnN0YW5jZS5cblx0ICAgICAqIEByZXR1cm5zIHtPYmplY3R9IE9wdGlvbiBvZiBpbnN0YW5jZVxuXHQgICAgICovXG5cdCAgICBnZXRPcHRpb246IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLl9vcHRpb247XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQWRkIHZhbHVlIHRoYXQgd2lsbCBiZSBleGNsdWRlZC5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIFZhbHVlIHRoYXQgd2lsbCBiZSBleGNsdWRlZC5cblx0ICAgICAqL1xuXHQgICAgYWRkRXhjbHVzaW9uOiBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIHZhciBleGNsdXNpb24gPSB0aGlzLl9vcHRpb24uZXhjbHVzaW9uO1xuXHRcblx0ICAgICAgICBpZiAoaW5BcnJheSh2YWx1ZSwgZXhjbHVzaW9uKSA+IC0xKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZXhjbHVzaW9uLnB1c2godmFsdWUpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJlbW92ZSBhIHZhbHVlIHdoaWNoIHdhcyBleGNsdWRlZC5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIFZhbHVlIHRoYXQgd2lsbCBiZSByZW1vdmVkIGZyb20gYSBleGNsdXNpb24gbGlzdCBvZiBpbnN0YW5jZVxuXHQgICAgICovXG5cdCAgICByZW1vdmVFeGNsdXNpb246IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgdmFyIGV4Y2x1c2lvbiA9IHRoaXMuX29wdGlvbi5leGNsdXNpb24sXG5cdCAgICAgICAgICAgIGluZGV4ID0gaW5BcnJheSh2YWx1ZSwgZXhjbHVzaW9uKTtcblx0XG5cdCAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGV4Y2x1c2lvbi5zcGxpY2UoaW5kZXgsIDEpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIGdldCBjb250YWluZXIgZWxlbWVudFxuXHQgICAgICogQHJldHVybnMge0hUTUxFbGVtZW50fSBlbGVtZW50XG5cdCAgICAgKi9cblx0ICAgIGdldENvbnRhaW5lckVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLl8kY29udGFpbmVyRWxlbWVudFswXTtcblx0ICAgIH1cblx0fSk7XG5cdFxuXHR0dWkudXRpbC5DdXN0b21FdmVudHMubWl4aW4oU3BpbmJveCk7XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IFNwaW5ib3g7XG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8qKlxuXHQgKiBAZmlsZW92ZXJ2aWV3IFV0aWxzIGZvciBjYWxlbmRhciBjb21wb25lbnRcblx0ICogQGF1dGhvciBOSE4gTmV0LiBGRSBkZXYgTGFiLiA8ZGxfamF2YXNjcmlwdEBuaG5lbnQuY29tPlxuXHQgKiBAZGVwZW5kZW5jeSB0dWktY29kZS1zbmlwcGV0IF4xLjAuMlxuXHQgKi9cblx0XG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdC8qKlxuXHQgKiBVdGlscyBvZiBjYWxlbmRhclxuXHQgKiBAbmFtZXNwYWNlIGRhdGVVdGlsXG5cdCAqIEBpZ25vcmVcblx0ICovXG5cdHZhciB1dGlscyA9IHtcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJuIGRhdGUgaGFzaCBieSBwYXJhbWV0ZXIuXG5cdCAgICAgKiAgaWYgdGhlcmUgYXJlIDMgcGFyYW1ldGVyLCB0aGUgcGFyYW1ldGVyIGlzIGNvcmduaXplZCBEYXRlIG9iamVjdFxuXHQgICAgICogIGlmIHRoZXJlIGFyZSBubyBwYXJhbWV0ZXIsIHJldHVybiB0b2RheSdzIGhhc2ggZGF0ZVxuXHQgICAgICogQHBhcmFtIHtEYXRlfG51bWJlcn0gW3llYXJdIEEgZGF0ZSBpbnN0YW5jZSBvciB5ZWFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gW21vbnRoXSBBIG1vbnRoXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gW2RhdGVdIEEgZGF0ZVxuXHQgICAgICogQHJldHVybnMge3t5ZWFyOiAqLCBtb250aDogKiwgZGF0ZTogKn19XG5cdCAgICAgKi9cblx0ICAgIGdldERhdGVIYXNoOiBmdW5jdGlvbih5ZWFyLCBtb250aCwgZGF0ZSkge1xuXHQgICAgICAgIHZhciBuRGF0ZTtcblx0XG5cdCAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAzKSB7XG5cdCAgICAgICAgICAgIG5EYXRlID0gYXJndW1lbnRzWzBdIHx8IG5ldyBEYXRlKCk7XG5cdFxuXHQgICAgICAgICAgICB5ZWFyID0gbkRhdGUuZ2V0RnVsbFllYXIoKTtcblx0ICAgICAgICAgICAgbW9udGggPSBuRGF0ZS5nZXRNb250aCgpICsgMTtcblx0ICAgICAgICAgICAgZGF0ZSA9IG5EYXRlLmdldERhdGUoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIHllYXI6IHllYXIsXG5cdCAgICAgICAgICAgIG1vbnRoOiBtb250aCxcblx0ICAgICAgICAgICAgZGF0ZTogZGF0ZVxuXHQgICAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJuIHRvZGF5IHRoYXQgc2F2ZWQgb24gY29tcG9uZW50IG9yIGNyZWF0ZSBuZXcgZGF0ZS5cblx0ICAgICAqIEByZXR1cm5zIHt7eWVhcjogKiwgbW9udGg6ICosIGRhdGU6ICp9fVxuXHQgICAgICovXG5cdCAgICBnZXRUb2RheTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHV0aWxzLmdldERhdGVIYXNoKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IHVuaXggdGltZSBmcm9tIGRhdGUgaGFzaFxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGUgQSBkYXRlIGhhc2hcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlLnllYXIgQSB5ZWFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gZGF0ZS5tb250aCBBIG1vbnRoXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gZGF0ZS5kYXRlIEEgZGF0ZVxuXHQgICAgICogQHJldHVybnMge251bWJlcn1cblx0ICAgICAqIEBleGFtcGxlXG5cdCAgICAgKiB1dGlscy5nZXRUaW1lKHt5ZWFyOjIwMTAsIG1vbnRoOjUsIGRhdGU6MTJ9KTsgLy8gMTI3MzU5MDAwMDAwMFxuXHQgICAgICovXG5cdCAgICBnZXRUaW1lOiBmdW5jdGlvbihkYXRlKSB7XG5cdCAgICAgICAgcmV0dXJuIHV0aWxzLmdldERhdGVPYmplY3QoZGF0ZSkuZ2V0VGltZSgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdldCB3aGljaCBkYXkgaXMgZmlyc3QgYnkgcGFyYW1ldGVycyB0aGF0IGluY2x1ZGUgeWVhciBhbmQgbW9udGggaW5mb3JtYXRpb24uXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMH42KVxuXHQgICAgICovXG5cdCAgICBnZXRGaXJzdERheTogZnVuY3Rpb24oeWVhciwgbW9udGgpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCAxKS5nZXREYXkoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgd2hpY2ggZGF5IGlzIGxhc3QgYnkgcGFyYW1ldGVycyB0aGF0IGluY2x1ZGUgeWVhciBhbmQgbW9udGggaW5mb3JtYXRpb24uXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMH42KVxuXHQgICAgICovXG5cdCAgICBnZXRMYXN0RGF5OiBmdW5jdGlvbih5ZWFyLCBtb250aCkge1xuXHQgICAgICAgIHJldHVybiBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkuZ2V0RGF5KCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IGxhc3QgZGF0ZSBieSBwYXJhbWV0ZXJzIHRoYXQgaW5jbHVkZSB5ZWFyIGFuZCBtb250aCBpbmZvcm1hdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcblx0ICAgICAqIEByZXR1cm5zIHtudW1iZXJ9ICgxfjMxKVxuXHQgICAgICovXG5cdCAgICBnZXRMYXN0RGF5SW5Nb250aDogZnVuY3Rpb24oeWVhciwgbW9udGgpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGgsIDApLmdldERhdGUoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgZGF0ZSBpbnN0YW5jZS5cblx0ICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGRhdGVIYXNoIEEgZGF0ZSBoYXNoXG5cdCAgICAgKiBAcmV0dXJucyB7RGF0ZX0gRGF0ZVxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqICBkYXRlVXRpbC5nZXREYXRlT2JqZWN0KHt5ZWFyOjIwMTAsIG1vbnRoOjUsIGRhdGU6MTJ9KTtcblx0ICAgICAqICBkYXRlVXRpbC5nZXREYXRlT2JqZWN0KDIwMTAsIDUsIDEyKTsgLy95ZWFyLG1vbnRoLGRhdGVcblx0ICAgICAqL1xuXHQgICAgZ2V0RGF0ZU9iamVjdDogZnVuY3Rpb24oZGF0ZUhhc2gpIHtcblx0ICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykge1xuXHQgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0gLSAxLCBhcmd1bWVudHNbMl0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGVIYXNoLnllYXIsIGRhdGVIYXNoLm1vbnRoIC0gMSwgZGF0ZUhhc2guZGF0ZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IHJlbGF0ZWQgZGF0ZSBoYXNoIHdpdGggcGFyYW1ldGVycyB0aGF0IGluY2x1ZGUgZGF0ZSBpbmZvcm1hdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgcmVsYXRlZCB2YWx1ZSBmb3IgeWVhcih5b3UgY2FuIHVzZSArLy0pXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gbW9udGggQSByZWxhdGVkIHZhbHVlIGZvciBtb250aCAoeW91IGNhbiB1c2UgKy8tKVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUgQSByZWxhdGVkIHZhbHVlIGZvciBkYXkgKHlvdSBjYW4gdXNlICsvLSlcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRlT2JqIHN0YW5kYXJkIGRhdGUgaGFzaFxuXHQgICAgICogQHJldHVybnMge09iamVjdH0gZGF0ZU9ialxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqICBkYXRlVXRpbC5nZXRSZWxhdGl2ZURhdGUoMSwgMCwgMCwge3llYXI6MjAwMCwgbW9udGg6MSwgZGF0ZToxfSk7IC8vIHt5ZWFyOjIwMDEsIG1vbnRoOjEsIGRhdGU6MX1cblx0ICAgICAqICBkYXRlVXRpbC5nZXRSZWxhdGl2ZURhdGUoMCwgMCwgLTEsIHt5ZWFyOjIwMTAsIG1vbnRoOjEsIGRhdGU6MX0pOyAvLyB7eWVhcjoyMDA5LCBtb250aDoxMiwgZGF0ZTozMX1cblx0ICAgICAqL1xuXHQgICAgZ2V0UmVsYXRpdmVEYXRlOiBmdW5jdGlvbih5ZWFyLCBtb250aCwgZGF0ZSwgZGF0ZU9iaikge1xuXHQgICAgICAgIHZhciBuWWVhciA9IChkYXRlT2JqLnllYXIgKyB5ZWFyKSxcblx0ICAgICAgICAgICAgbk1vbnRoID0gKGRhdGVPYmoubW9udGggKyBtb250aCAtIDEpLFxuXHQgICAgICAgICAgICBuRGF0ZSA9IChkYXRlT2JqLmRhdGUgKyBkYXRlKSxcblx0ICAgICAgICAgICAgbkRhdGVPYmogPSBuZXcgRGF0ZShuWWVhciwgbk1vbnRoLCBuRGF0ZSk7XG5cdFxuXHQgICAgICAgIHJldHVybiB1dGlscy5nZXREYXRlSGFzaChuRGF0ZU9iaik7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQmluYXJ5IHNlYXJjaFxuXHQgICAgICogQHBhcmFtIHtBcnJheX0gZmllbGQgLSBTZWFyY2ggZmllbGRcblx0ICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlIC0gU2VhcmNoIHRhcmdldFxuXHQgICAgICogQHJldHVybnMge3tmb3VuZDogYm9vbGVhbiwgaW5kZXg6IG51bWJlcn19IFJlc3VsdFxuXHQgICAgICovXG5cdCAgICBzZWFyY2g6IGZ1bmN0aW9uKGZpZWxkLCB2YWx1ZSkge1xuXHQgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlLFxuXHQgICAgICAgICAgICBsb3cgPSAwLFxuXHQgICAgICAgICAgICBoaWdoID0gZmllbGQubGVuZ3RoIC0gMSxcblx0ICAgICAgICAgICAgZW5kLCBpbmRleCwgZmllbGRWYWx1ZTtcblx0XG5cdCAgICAgICAgd2hpbGUgKCFmb3VuZCAmJiAhZW5kKSB7XG5cdCAgICAgICAgICAgIGluZGV4ID0gTWF0aC5mbG9vcigobG93ICsgaGlnaCkgLyAyKTtcblx0ICAgICAgICAgICAgZmllbGRWYWx1ZSA9IGZpZWxkW2luZGV4XTtcblx0XG5cdCAgICAgICAgICAgIGlmIChmaWVsZFZhbHVlID09PSB2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKGZpZWxkVmFsdWUgPCB2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgbG93ID0gaW5kZXggKyAxO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgaGlnaCA9IGluZGV4IC0gMTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlbmQgPSAobG93ID4gaGlnaCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBmb3VuZDogZm91bmQsXG5cdCAgICAgICAgICAgIGluZGV4OiAoZm91bmQgfHwgZmllbGRWYWx1ZSA+IHZhbHVlKSA/IGluZGV4IDogaW5kZXggKyAxXG5cdCAgICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgbWVyaWRpZW0gaG91clxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IGhvdXIgLSBPcmlnaW5hbCBob3VyXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBDb252ZXJ0ZWQgbWVyaWRpZW0gaG91clxuXHQgICAgICovXG5cdCAgICBnZXRNZXJpZGllbUhvdXI6IGZ1bmN0aW9uKGhvdXIpIHtcblx0ICAgICAgICBob3VyICU9IDEyO1xuXHRcblx0ICAgICAgICBpZiAoaG91ciA9PT0gMCkge1xuXHQgICAgICAgICAgICBob3VyID0gMTI7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gaG91cjtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBXaGV0aGVyIHRoZSB0d28gZGF0ZUhhc2ggb2JqZWN0cyBhcmUgZXF1YWxcblx0ICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGEgLSBkYXRlSGFzaFxuXHQgICAgICogQHBhcmFtIHtkYXRlSGFzaH0gYiAtIGRhdGVIYXNoXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICAgICAqL1xuXHQgICAgaXNFcXVhbERhdGVIYXNoOiBmdW5jdGlvbihhLCBiKSB7XG5cdCAgICAgICAgcmV0dXJuIGEueWVhciA9PT0gYi55ZWFyXG5cdCAgICAgICAgICAgICYmIGEubW9udGggPT09IGIubW9udGhcblx0ICAgICAgICAgICAgJiYgYS5kYXRlID09PSBiLmRhdGU7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJucyBudW1iZXIgb3IgZGVmYXVsdFxuXHQgICAgICogQHBhcmFtIHsqfSBhbnkgLSBBbnkgdmFsdWVcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWZhdWx0TnVtYmVyIC0gRGVmYXVsdCBudW1iZXJcblx0ICAgICAqIEB0aHJvd3MgV2lsbCB0aHJvdyBhbiBlcnJvciBpZiB0aGUgZGVmYXVsdE51bWJlciBpcyBpbnZhbGlkLlxuXHQgICAgICogQHJldHVybnMge251bWJlcn1cblx0ICAgICAqL1xuXHQgICAgZ2V0U2FmZU51bWJlcjogZnVuY3Rpb24oYW55LCBkZWZhdWx0TnVtYmVyKSB7XG5cdCAgICAgICAgaWYgKGlzTmFOKGRlZmF1bHROdW1iZXIpIHx8ICF0dWkudXRpbC5pc051bWJlcihkZWZhdWx0TnVtYmVyKSkge1xuXHQgICAgICAgICAgICB0aHJvdyBFcnJvcignVGhlIGRlZmF1bHROdW1iZXIgbXVzdCBiZSBhIHZhbGlkIG51bWJlci4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGlzTmFOKGFueSkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHROdW1iZXI7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gTnVtYmVyKGFueSk7XG5cdCAgICB9XG5cdH07XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IHV0aWxzO1xuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKipcblx0ICogQGZpbGVvdmVydmlldyBUaGlzIGNvbXBvbmVudCBwcm92aWRlcyBhIGNhbGVuZGFyIGZvciBwaWNraW5nIGEgZGF0ZSAmIHRpbWUuXG5cdCAqIEBhdXRob3IgTkhOIGVudCBGRSBkZXYgTGFiIDxkbF9qYXZhc2NyaXB0QG5obmVudC5jb20+XG5cdCAqL1xuXHQndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgZGF0ZVV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0dmFyIHV0aWwgPSB0dWkudXRpbDtcblx0dmFyIGV4dGVuZCA9IHV0aWwuZXh0ZW5kO1xuXHR2YXIgYmluZCA9IHV0aWwuYmluZDtcblx0dmFyIGZvckVhY2ggPSB1dGlsLmZvckVhY2g7XG5cdHZhciBpc051bWJlciA9IHV0aWwuaXNOdW1iZXI7XG5cdHZhciBjb21wYXJlSlNPTiA9IHV0aWwuY29tcGFyZUpTT047XG5cdHZhciBpc0dyZWF0ZXJUaGFuT3JFcXVhbFRvID0gZnVuY3Rpb24oYSwgYiwgY29tcGFyaW5nTGV2ZWwpIHtcblx0ICAgIGNvbXBhcmluZ0xldmVsID0gY29tcGFyaW5nTGV2ZWwgfHwgMTtcblx0XG5cdCAgICByZXR1cm4gTWF0aC5mbG9vcigoYSAvIGNvbXBhcmluZ0xldmVsKSkgPj0gTWF0aC5mbG9vcigoYiAvIGNvbXBhcmluZ0xldmVsKSk7XG5cdH07XG5cdFxuXHR2YXIgaW5BcnJheSA9IHV0aWwuaW5BcnJheTtcblx0dmFyIGZvcm1hdFJlZ0V4cCA9IC95eXl5fHl5fG1tfG18ZGR8ZC9naTtcblx0dmFyIG1hcEZvckNvbnZlcnRpbmcgPSB7XG5cdCAgICB5eXl5OiB7XG5cdCAgICAgICAgZXhwcmVzc2lvbjogJyhcXFxcZHs0fXxcXFxcZHsyfSknLFxuXHQgICAgICAgIHR5cGU6ICd5ZWFyJ1xuXHQgICAgfSxcblx0ICAgIHl5OiB7XG5cdCAgICAgICAgZXhwcmVzc2lvbjogJyhcXFxcZHs0fXxcXFxcZHsyfSknLFxuXHQgICAgICAgIHR5cGU6ICd5ZWFyJ1xuXHQgICAgfSxcblx0ICAgIHk6IHtcblx0ICAgICAgICBleHByZXNzaW9uOiAnKFxcXFxkezR9fFxcXFxkezJ9KScsXG5cdCAgICAgICAgdHlwZTogJ3llYXInXG5cdCAgICB9LFxuXHQgICAgbW06IHtcblx0ICAgICAgICBleHByZXNzaW9uOiAnKDFbMDEyXXwwWzEtOV18WzEtOV1cXFxcYiknLFxuXHQgICAgICAgIHR5cGU6ICdtb250aCdcblx0ICAgIH0sXG5cdCAgICBtOiB7XG5cdCAgICAgICAgZXhwcmVzc2lvbjogJygxWzAxMl18MFsxLTldfFsxLTldXFxcXGIpJyxcblx0ICAgICAgICB0eXBlOiAnbW9udGgnXG5cdCAgICB9LFxuXHQgICAgZGQ6IHtcblx0ICAgICAgICBleHByZXNzaW9uOiAnKFsxMl1cXFxcZHsxfXwzWzAxXXwwWzEtOV18WzEtOV1cXFxcYiknLFxuXHQgICAgICAgIHR5cGU6ICdkYXRlJ1xuXHQgICAgfSxcblx0ICAgIGQ6IHtcblx0ICAgICAgICBleHByZXNzaW9uOiAnKFsxMl1cXFxcZHsxfXwzWzAxXXwwWzEtOV18WzEtOV1cXFxcYiknLFxuXHQgICAgICAgIHR5cGU6ICdkYXRlJ1xuXHQgICAgfVxuXHR9O1xuXHR2YXIgREFURV9MQVlFUiA9ICdkYXRlJztcblx0dmFyIE1PTlRIX0xBWUVSID0gJ21vbnRoJztcblx0dmFyIFlFQVJfTEFZRVIgPSAneWVhcic7XG5cdHZhciBNSU5fWUVBUiA9IDE5MDA7XG5cdHZhciBNQVhfWUVBUiA9IDI5OTk7XG5cdHZhciBXUkFQUEVSX1RBRyA9ICc8ZGl2IHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7XCI+PC9kaXY+Jztcblx0dmFyIE1JTl9FREdFID0gTnVtYmVyKG5ldyBEYXRlKDApKTtcblx0dmFyIE1BWF9FREdFID0gTnVtYmVyKG5ldyBEYXRlKDI5OTksIDExLCAzMSkpO1xuXHR2YXIgWUVBUl9UT19NUyA9IDMxNTM2MDAwMDAwO1xuXHR2YXIgTU9OVEhfVE9fTVMgPSAyNjI4MDAwMDAwO1xuXHR2YXIgUkVMQVRJVkVfTU9OVEhfVkFMVUVfS0VZID0gJ3JlbGF0aXZlTW9udGhWYWx1ZSc7XG5cdFxuXHR2YXIgbGF5ZXJzID0gW0RBVEVfTEFZRVIsIE1PTlRIX0xBWUVSLCBZRUFSX0xBWUVSXTtcblx0dmFyIHBvc2l0aW9uRnJvbUJvdW5kaW5nS2V5TWFwcGVyID0ge1xuXHQgICAgbGVmdDogJ2xlZnQnLFxuXHQgICAgdG9wOiAnYm90dG9tJ1xuXHR9O1xuXHR2YXIgZGF0ZUtleXMgPSBbJ2RkJywgJ2QnXTtcblx0dmFyIG1vbnRoS2V5cyA9IFsnbW0nLCAnbSddO1xuXHR2YXIgeWVhcktleXMgPSBbJ3l5eXknLCAneXknLCAneSddO1xuXHRcblx0LyoqXG5cdCAqIEEgbnVtYmVyLCBvciBhIHN0cmluZyBjb250YWluaW5nIGEgbnVtYmVyLlxuXHQgKiBAdHlwZWRlZiB7T2JqZWN0fSBkYXRlSGFzaFxuXHQgKiBAcHJvcGVydHkge251bWJlcn0geWVhciAtIDE5NzB+Mjk5OVxuXHQgKiBAcHJvcGVydHkge251bWJlcn0gbW9udGggLSAxfjEyXG5cdCAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBkYXRlIC0gMX4zMVxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAdHlwZWRlZiB7RnVuY3Rpb259IENhbGVuZGFyXG5cdCAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9uaG5lbnQvdHVpLmNvbXBvbmVudC5jYWxlbmRhcn1cblx0ICovXG5cdFxuXHQvKipcblx0ICogQ3JlYXRlIERhdGVQaWNrZXI8YnI+XG5cdCAqIFlvdSBjYW4gZ2V0IGEgZGF0ZSBmcm9tICdnZXRZZWFyJywgJ2dldE1vbnRoJywgJ2dldERheUluTW9udGgnLCAnZ2V0RGF0ZUhhc2gnXG5cdCAqIEBjb25zdHJ1Y3RvclxuXHQgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uIC0gT3B0aW9uc1xuXHQgKiAgICAgIEBwYXJhbSB7SFRNTEVsZW1lbnR8c3RyaW5nfGpRdWVyeX0gb3B0aW9uLmVsZW1lbnQgLSBJbnB1dCBlbGVtZW50KG9yIHNlbGVjdG9yKSBvZiBEYXRlUGlja2VyXG5cdCAqICAgICAgQHBhcmFtIHtkYXRlSGFzaHwnYmxhbmsnfSBbb3B0aW9uLmRhdGUgPSB0b2RheV0gLSBJbml0aWFsIGRhdGUgb2JqZWN0LiBJZiBubyB3YW50IGluaXRpYWwgZGF0ZXRpbWUsIHR5cGUgXCJibGFua1wiXG5cdCAqICAgICAgQHBhcmFtIHtzdHJpbmd9IFtvcHRpb24uZGF0ZUZvcm1hdCA9ICd5eXl5LW1tLWRkJ10gLSBEYXRlIHN0cmluZyBmb3JtYXRcblx0ICogICAgICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbi5kZWZhdWx0Q2VudHVyeSA9IDIwXSAtIERlZmF1bHQgY2VudHVyeSBmb3IgJ3l5JyBmb3JtYXQuXG5cdCAqICAgICAgQHBhcmFtIHtIVE1MRWxlbWVudHxzdHJpbmd8alF1ZXJ5fSBbb3B0aW9uLnBhcmVudEVsZW1lbnRdIC0gVGhlIHdyYXBwZXIgZWxlbWVudCB3aWxsIGJlIGluc2VydGVkIGludG9cblx0ICogICAgICAgICAgIHRoaXMgZWxlbWVudC4gKHNpbmNlIDEuMy4wKVxuXHQgKiAgICAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLnNlbGVjdGFibGVDbGFzc05hbWUgPSAnc2VsZWN0YWJsZSddIC0gRm9yIHNlbGVjdGFibGUgZGF0ZSBlbGVtZW50c1xuXHQgKiAgICAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLnNlbGVjdGVkQ2xhc3NOYW1lID0gJ3NlbGVjdGVkJ10gLSBGb3Igc2VsZWN0ZWQgZGF0ZSBlbGVtZW50XG5cdCAqICAgICAgQHBhcmFtIHtib29sZWFufSBbb3B0aW9uLmVuYWJsZVNldERhdGVCeUVudGVyS2V5ID0gdHJ1ZV0gLSBTZXQgZGF0ZSB3aGVuIHRoZSAnRW50ZXInIGtleSBwcmVzc2VkIChzaW5jZSAxLjMuMClcblx0ICogICAgICBAcGFyYW0ge0FycmF5LjxBcnJheS48ZGF0ZUhhc2g+Pn0gW29wdGlvbnMuc2VsZWN0YWJsZVJhbmdlc10gLSBTZWxlY3RhYmxlIGRhdGUgcmFuZ2VzLlxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZWUgdGhpcyBleGFtcGxlIFwie0B0dXRvcmlhbCBzYW1wbGU1fVwiXG5cdCAqICAgICAgQHBhcmFtIHtPYmplY3R9IFtvcHRpb24ucG9zXSAtIGNhbGVuZGFyIHBvc2l0aW9uIHN0eWxlIHZhbHVlXG5cdCAqICAgICAgICAgIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9uLnBvcy5sZWZ0XSAtIHBvc2l0aW9uIGxlZnQgb2YgY2FsZW5kYXJcblx0ICogICAgICAgICAgQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24ucG9zLnRvcF0gLSBwb3NpdGlvbiB0b3Agb2YgY2FsZW5kYXJcblx0ICogICAgICAgICAgQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24ucG9zLnpJbmRleF0gLSB6LWluZGV4IG9mIGNhbGVuZGFyXG5cdCAqICAgICAgQHBhcmFtIHtPYmplY3R9IFtvcHRpb24ub3BlbmVycyA9IFtlbGVtZW50XV0gLSBvcGVuZXIgYnV0dG9uIGxpc3QgKGV4YW1wbGUgLSBpY29uLCBidXR0b24sIGV0Yy4pXG5cdCAqICAgICAgQHBhcmFtIHtib29sZWFufSBbb3B0aW9uLnNob3dBbHdheXMgPSBmYWxzZV0gLSB3aGV0aGVyIHRoZSBkYXRlcGlja2VyIHNob3dzIHRoZSBjYWxlbmRhciBhbHdheXNcblx0ICogICAgICBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb24udXNlVG91Y2hFdmVudCA9IHRydWVdIC0gd2hldGhlciB0aGUgZGF0ZXBpY2tlciB1c2VzIHRvdWNoIGV2ZW50c1xuXHQgKiAgICAgIEBwYXJhbSB7VGltZVBpY2tlcn0gW29wdGlvbi50aW1lUGlja2VyXSAtIFRpbWVQaWNrZXIgaW5zdGFuY2Vcblx0ICogQHBhcmFtIHtDYWxlbmRhcn0gY2FsZW5kYXIgLSBDYWxlbmRhciBpbnN0YW5jZVxuXHQgKiBAZXhhbXBsZVxuXHQgKiAgIHZhciBjYWxlbmRhciA9IG5ldyB0dWkuY29tcG9uZW50LkNhbGVuZGFyKHtcblx0ICogICAgICAgZWxlbWVudDogJyNsYXllcicsXG5cdCAqICAgICAgIHRpdGxlRm9ybWF0OiAneXl5eeuFhCBt7JuUJyxcblx0ICogICAgICAgdG9kYXlGb3JtYXQ6ICd5eXl564WEIG1t7JuUIGRk7J28IChEKSdcblx0ICogICB9KTtcblx0ICpcblx0ICogICB2YXIgdGltZVBpY2tlciA9IG5ldyB0dWkuY29tcG9uZW50LlRpbWVQaWNrZXIoe1xuXHQgKiAgICAgICBzaG93TWVyaWRpYW46IHRydWUsXG5cdCAqICAgICAgIGRlZmF1bHRIb3VyOiAxMyxcblx0ICogICAgICAgZGVmYXVsdE1pbnV0ZTogMjRcblx0ICogICB9KTtcblx0ICpcblx0ICogICB2YXIgcmFuZ2UxID0gW1xuXHQgKiAgICAgICAgICB7eWVhcjogMjAxNSwgbW9udGg6MSwgZGF0ZTogMX0sXG5cdCAqICAgICAgICAgIHt5ZWFyOiAyMDE1LCBtb250aDoyLCBkYXRlOiAxfVxuXHQgKiAgICAgIF0sXG5cdCAqICAgICAgcmFuZ2UyID0gW1xuXHQgKiAgICAgICAgICB7eWVhcjogMjAxNSwgbW9udGg6MywgZGF0ZTogMX0sXG5cdCAqICAgICAgICAgIHt5ZWFyOiAyMDE1LCBtb250aDo0LCBkYXRlOiAxfVxuXHQgKiAgICAgIF0sXG5cdCAqICAgICAgcmFuZ2UzID0gW1xuXHQgKiAgICAgICAgICB7eWVhcjogMjAxNSwgbW9udGg6NiwgZGF0ZTogMX0sXG5cdCAqICAgICAgICAgIHt5ZWFyOiAyMDE1LCBtb250aDo3LCBkYXRlOiAxfVxuXHQgKiAgICAgIF07XG5cdCAqXG5cdCAqICAgdmFyIHBpY2tlcjEgPSBuZXcgdHVpLmNvbXBvbmVudC5EYXRlUGlja2VyKHtcblx0ICogICAgICAgZWxlbWVudDogJyNwaWNrZXInLFxuXHQgKiAgICAgICBkYXRlRm9ybWF0OiAneXl5eeuFhCBtbeyblCBkZOydvCAtICcsXG5cdCAqICAgICAgIC8vZGF0ZUZvcm1hdDogJ3l5eXnrhYQgbW3sm5QnLFxuXHQgKiAgICAgICAvL2RhdGVGb3JtYXQ6ICd5eXl564WEJyxcblx0ICogICAgICAgZGF0ZToge3llYXI6IDIwMTUsIG1vbnRoOiAxLCBkYXRlOiAxfSwgLy8gb3Igc3RyaW5nIGxpdGVyYWwgJ2JsYW5rJyB3aXRob3V0IGRlZmF1bHQgZGF0ZSBhc3NpZ25cblx0ICogICAgICAgc2VsZWN0YWJsZVJhbmdlczogW3JhbmdlMSwgcmFuZ2UyLCByYW5nZTNdLFxuXHQgKiAgICAgICBvcGVuZXJzOiBbJyNvcGVuZXInXSxcblx0ICogICAgICAgdGltZVBpY2tlcjogdGltZVBpY2tlclxuXHQgKiAgIH0sIGNhbGVuZGFyKTtcblx0ICpcblx0ICogICAvLyBDbG9zZSBjYWxlbmRhciB3aGVuIHNlbGVjdCBhIGRhdGVcblx0ICogICAkKCcjbGF5ZXInKS5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuXHQgKiAgICAgICB2YXIgJGVsID0gJChldmVudC50YXJnZXQpO1xuXHQgKlxuXHQgKiAgICAgICBpZiAoJGVsLmhhc0NsYXNzKCdzZWxlY3RhYmxlJykpIHtcblx0ICogICAgICAgICAgIHBpY2tlcjEuY2xvc2UoKTtcblx0ICogICAgICAgfVxuXHQgKiAgIH0pO1xuXHQgKlxuXHQgKiBAdHV0b3JpYWwgc2FtcGxlMVxuXHQgKiBAdHV0b3JpYWwgc2FtcGxlMlxuXHQgKiBAdHV0b3JpYWwgc2FtcGxlNVxuXHQgKiBAdHV0b3JpYWwgc2FtcGxlNlxuXHQgKi9cblx0dmFyIERhdGVQaWNrZXIgPSB1dGlsLmRlZmluZUNsYXNzKC8qKiBAbGVuZHMgRGF0ZVBpY2tlci5wcm90b3R5cGUgKi97XG5cdCAgICBpbml0OiBmdW5jdGlvbihvcHRpb24sIGNhbGVuZGFyKSB7XG5cdCAgICAgICAgLy8gc2V0IGRlZmF1bHRzXG5cdCAgICAgICAgb3B0aW9uID0gZXh0ZW5kKHtcblx0ICAgICAgICAgICAgZGF0ZUZvcm1hdDogJ3l5eXktbW0tZGQgJyxcblx0ICAgICAgICAgICAgZGVmYXVsdENlbnR1cnk6ICcyMCcsXG5cdCAgICAgICAgICAgIGRpc2FibGVkQ2xhc3NOYW1lOiAnZGlzYWJsZWQnLFxuXHQgICAgICAgICAgICBzZWxlY3RhYmxlQ2xhc3NOYW1lOiAnc2VsZWN0YWJsZScsXG5cdCAgICAgICAgICAgIHNlbGVjdGVkQ2xhc3NOYW1lOiAnc2VsZWN0ZWQnLFxuXHQgICAgICAgICAgICBzZWxlY3RhYmxlUmFuZ2VzOiBbXSxcblx0ICAgICAgICAgICAgZW5hYmxlU2V0RGF0ZUJ5RW50ZXJLZXk6IHRydWUsXG5cdCAgICAgICAgICAgIHNob3dBbHdheXM6IGZhbHNlLFxuXHQgICAgICAgICAgICB1c2VUb3VjaEV2ZW50OiB0cnVlXG5cdCAgICAgICAgfSwgb3B0aW9uKTtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQ2FsZW5kYXIgaW5zdGFuY2Vcblx0ICAgICAgICAgKiBAdHlwZSB7Q2FsZW5kYXJ9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9jYWxlbmRhciA9IGNhbGVuZGFyO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBFbGVtZW50IGZvciBkaXNwbGF5aW5nIGEgZGF0ZSB2YWx1ZVxuXHQgICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuXyRlbGVtZW50ID0gJChvcHRpb24uZWxlbWVudCk7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEVsZW1lbnQgd3JhcHBpbmcgY2FsZW5kYXJcblx0ICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl8kd3JhcHBlckVsZW1lbnQgPSAkKFdSQVBQRVJfVEFHKTtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogRm9ybWF0IG9mIGRhdGUgc3RyaW5nXG5cdCAgICAgICAgICogQHR5cGUge3N0cmluZ31cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX2RhdGVGb3JtYXQgPSBvcHRpb24uZGF0ZUZvcm0gfHwgb3B0aW9uLmRhdGVGb3JtYXQ7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIFJlZ0V4cCBpbnN0YW5jZSBmb3IgZm9ybWF0IG9mIGRhdGUgc3RyaW5nXG5cdCAgICAgICAgICogQHR5cGUge1JlZ0V4cH1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX3JlZ0V4cCA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEFycmF5IHNhdmluZyBhIG9yZGVyIG9mIGZvcm1hdFxuXHQgICAgICAgICAqIEB0eXBlIHtBcnJheX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqIEBzZWUge0RhdGVQaWNrZXIucHJvdG90eXBlLnNldERhdGVGb3JtfVxuXHQgICAgICAgICAqIEBleGFtcGxlXG5cdCAgICAgICAgICogLy8gSWYgdGhlIGZvcm1hdCBpcyBhICdtbS1kZCwgeXl5eSdcblx0ICAgICAgICAgKiAvLyBgdGhpcy5fZm9ybU9yZGVyYCBpcyBbJ21vbnRoJywgJ2RhdGUnLCAneWVhciddXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fZm9ybU9yZGVyID0gW107XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIE9iamVjdCBoYXZpbmcgZGF0ZSB2YWx1ZXNcblx0ICAgICAgICAgKiBAdHlwZSB7ZGF0ZUhhc2h9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9kYXRlID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogVGhpcyB2YWx1ZSBpcyBwcmVwZW5kZWQgYXV0b21hdGljYWxseSB3aGVuIHllYXItZm9ybWF0IGlzICd5eSdcblx0ICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICogQGV4YW1wbGVcblx0ICAgICAgICAgKiAvL1xuXHQgICAgICAgICAqIC8vIElmIHRoaXMgdmFsdWUgaXMgJzIwJywgdGhlIGZvcm1hdCBpcyAneXktbW0tZGQnIGFuZCB0aGUgZGF0ZSBzdHJpbmcgaXMgJzE1LTA0LTEyJyxcblx0ICAgICAgICAgKiAvLyB0aGUgZGF0ZSB2YWx1ZSBvYmplY3QgaXNcblx0ICAgICAgICAgKiAvLyAge1xuXHQgICAgICAgICAqIC8vICAgICAgeWVhcjogMjAxNSxcblx0ICAgICAgICAgKiAvLyAgICAgIG1vbnRoOiA0LFxuXHQgICAgICAgICAqIC8vICAgICAgZGF0ZTogMTJcblx0ICAgICAgICAgKiAvLyAgfVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX2RlZmF1bHRDZW50dXJ5ID0gb3B0aW9uLmRlZmF1bHRDZW50dXJ5O1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBDbGFzcyBuYW1lIGZvciBzZWxlY3RhYmxlIGRhdGUgZWxlbWVudHNcblx0ICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fc2VsZWN0YWJsZUNsYXNzTmFtZSA9IG9wdGlvbi5zZWxlY3RhYmxlQ2xhc3NOYW1lO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBDbGFzcyBuYW1lIGZvciBzZWxlY3RlZCBkYXRlIGVsZW1lbnRcblx0ICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fc2VsZWN0ZWRDbGFzc05hbWUgPSBvcHRpb24uc2VsZWN0ZWRDbGFzc05hbWU7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIFdoZXRoZXIgc2V0IGRhdGUgZnJvbSB0aGUgaW5wdXQgdmFsdWUgd2hlbiB0aGUgJ0VudGVyJyBrZXkgcHJlc3NlZFxuXHQgICAgICAgICAqIEB0eXBlIHtCb29sZWFufVxuXHQgICAgICAgICAqIEBzaW5jZSAxLjMuMFxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fZW5hYmxlU2V0RGF0ZUJ5RW50ZXJLZXkgPSBvcHRpb24uZW5hYmxlU2V0RGF0ZUJ5RW50ZXJLZXk7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEl0IGlzIHN0YXJ0IHRpbWVzdGFtcHMgZnJvbSB0aGlzLl9yYW5nZXNcblx0ICAgICAgICAgKiBAdHlwZSB7QXJyYXkuPG51bWJlcj59XG5cdCAgICAgICAgICogQHNpbmNlIDEuMi4wXG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9zdGFydFRpbWVzID0gW107XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEl0IGlzIGVuZCB0aW1lc3RhbXBzIGZyb20gdGhpcy5fcmFuZ2VzXG5cdCAgICAgICAgICogQHR5cGUge0FycmF5LjxudW1iZXI+fVxuXHQgICAgICAgICAqIEBzaW5jZSAxLjIuMFxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fZW5kVGltZXMgPSBbXTtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogU2VsZWN0YWJsZSBkYXRlIHJhbmdlc1xuXHQgICAgICAgICAqIEB0eXBlIHtBcnJheS48QXJyYXkuPGRhdGVIYXNoPj59XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKiBAc2luY2UgMS4yLjBcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9yYW5nZXMgPSBvcHRpb24uc2VsZWN0YWJsZVJhbmdlcztcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogVGltZVBpY2tlciBpbnN0YW5jZVxuXHQgICAgICAgICAqIEB0eXBlIHtUaW1lUGlja2VyfVxuXHQgICAgICAgICAqIEBzaW5jZSAxLjEuMFxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fdGltZVBpY2tlciA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIHBvc2l0aW9uIC0gbGVmdCAmIHRvcCAmIHpJbmRleFxuXHQgICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKiBAc2luY2UgMS4xLjFcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9wb3MgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBvcGVuZXJzIC0gb3BlbmVyIGxpc3Rcblx0ICAgICAgICAgKiBAdHlwZSB7QXJyYXl9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKiBAc2luY2UgMS4xLjFcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9vcGVuZXJzID0gW107XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEhhbmRsZXJzIGJpbmRpbmcgY29udGV4dFxuXHQgICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9wcm94eUhhbmRsZXJzID0ge307XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEluZGV4IG9mIHNob3duIGxheWVyXG5cdCAgICAgICAgICogQHR5cGUge251bWJlcn1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX3Nob3duTGF5ZXJJZHggPSAwO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBTdGF0ZSBvZiBwaWNrZXIgZW5hYmxlXG5cdCAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKiBAc2luY2UgMS40LjBcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9lbmFibGVkU3RhdGUgPSB0cnVlO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBDbGFzcyBuYW1lIGZvciBkaXNhYmxlZCBkYXRlIGVsZW1lbnRcblx0ICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICogQHNpbmNlIDEuNC4wXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fZGlzYWJsZWRDbGFzc05hbWUgPSBvcHRpb24uZGlzYWJsZWRDbGFzc05hbWU7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIFdoZXRoZXIgdGhlIGRhdGVwaWNrZXIgc2hvd3MgYWx3YXlzXG5cdCAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XG5cdCAgICAgICAgICogQHNpbmNlIDEuMi4wXG5cdCAgICAgICAgICogQGV4YW1wbGVcblx0ICAgICAgICAgKiBkYXRlcGlja2VyLnNob3dBbHdheXMgPSB0cnVlO1xuXHQgICAgICAgICAqIGRhdGVwaWNrZXIub3BlbigpO1xuXHQgICAgICAgICAqIC8vIFRoZSBkYXRlcGlja2VyIHdpbGwgYmUgbm90IGNsb3NlZCBpZiB5b3UgY2xpY2sgdGhlIG91dHNpZGUgb2YgdGhlIGRhdGVwaWNrZXJcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLnNob3dBbHdheXMgPSBvcHRpb24uc2hvd0Fsd2F5cztcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogV2hldGhlciB0aGUgZGF0ZXBpY2tlciB1c2UgdG91Y2ggZXZlbnQuXG5cdCAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XG5cdCAgICAgICAgICogQHNpbmNlIDEuMi4wXG5cdCAgICAgICAgICogQGV4YW1wbGVcblx0ICAgICAgICAgKiBkYXRlcGlja2VyLnVzZVRvdWNoRXZlbnQgPSBmYWxzZTtcblx0ICAgICAgICAgKiAvLyBUaGUgZGF0ZXBpY2tlciB3aWxsIGJlIHVzZSBvbmx5ICdjbGljaycsICdtb3VzZWRvd24nIGV2ZW50c1xuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMudXNlVG91Y2hFdmVudCA9ICEhKFxuXHQgICAgICAgICAgICAoKCdjcmVhdGVUb3VjaCcgaW4gZG9jdW1lbnQpIHx8ICgnb250b3VjaHN0YXJ0JyBpbiBkb2N1bWVudCkpICYmXG5cdCAgICAgICAgICAgIG9wdGlvbi51c2VUb3VjaEV2ZW50XG5cdCAgICAgICAgKTtcblx0XG5cdCAgICAgICAgdGhpcy5faW5pdGlhbGl6ZURhdGVQaWNrZXIob3B0aW9uKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBJbml0aWFsaXplIG1ldGhvZFxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbiAtIHVzZXIgb3B0aW9uXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfaW5pdGlhbGl6ZURhdGVQaWNrZXI6IGZ1bmN0aW9uKG9wdGlvbikge1xuXHQgICAgICAgIHRoaXMuX3JhbmdlcyA9IHRoaXMuX2ZpbHRlclZhbGlkUmFuZ2VzKHRoaXMuX3Jhbmdlcyk7XG5cdFxuXHQgICAgICAgIHRoaXMuX2RldGFjaENhbGVuZGFyRXZlbnQoKTtcblx0ICAgICAgICB0aGlzLl9zZXRTZWxlY3RhYmxlUmFuZ2VzKCk7XG5cdCAgICAgICAgdGhpcy5fc2V0V3JhcHBlckVsZW1lbnQob3B0aW9uLnBhcmVudEVsZW1lbnQpO1xuXHQgICAgICAgIHRoaXMuX3NldERlZmF1bHREYXRlKG9wdGlvbi5kYXRlKTtcblx0ICAgICAgICB0aGlzLl9zZXREZWZhdWx0UG9zaXRpb24ob3B0aW9uLnBvcyk7XG5cdCAgICAgICAgdGhpcy5fc2V0UHJveHlIYW5kbGVycygpO1xuXHQgICAgICAgIHRoaXMuX3NldE9wZW5lcnMob3B0aW9uLm9wZW5lcnMpO1xuXHQgICAgICAgIHRoaXMuX2JpbmRLZXlkb3duRXZlbnQodGhpcy5fJGVsZW1lbnQpO1xuXHQgICAgICAgIHRoaXMuX3NldFRpbWVQaWNrZXIob3B0aW9uLnRpbWVQaWNrZXIpO1xuXHQgICAgICAgIHRoaXMuc2V0RGF0ZUZvcm0oKTtcblx0XG5cdCAgICAgICAgdGhpcy5fJHdyYXBwZXJFbGVtZW50LmhpZGUoKTtcblx0ICAgICAgICB0aGlzLl9jYWxlbmRhci4kZWxlbWVudC5zaG93KCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTG9va3MgdGhyb3VnaCBlYWNoIHZhbHVlIGluIHRoZSByYW5nZXMsIHJldHVybmluZyBhbiBhcnJheSBvZiBvbmx5IHZhbGlkIHJhbmdlcy5cblx0ICAgICAqIEBwYXJhbSB7QXJyYXkuPEFycmF5LjxkYXRlSGFzaD4+fSByYW5nZXMgLSByYW5nZXNcblx0ICAgICAqIEByZXR1cm5zIHtBcnJheS48QXJyYXkuPGRhdGVIYXNoPj59IGZpbHRlcmVkIHJhbmdlc1xuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2ZpbHRlclZhbGlkUmFuZ2VzOiBmdW5jdGlvbihyYW5nZXMpIHtcblx0ICAgICAgICB2YXIgc3RhcnRIYXNoLCBlbmRIYXNoO1xuXHRcblx0ICAgICAgICByZXR1cm4gdXRpbC5maWx0ZXIocmFuZ2VzLCBmdW5jdGlvbihyYW5nZSkge1xuXHQgICAgICAgICAgICBzdGFydEhhc2ggPSByYW5nZVswXTtcblx0ICAgICAgICAgICAgZW5kSGFzaCA9IHJhbmdlWzFdO1xuXHQgICAgICAgICAgICB0aGlzLl9zZXRIYXNoSW5SYW5nZShzdGFydEhhc2gsIGVuZEhhc2gpO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9pc1ZhbGlkRGF0ZUhhc2goc3RhcnRIYXNoKSAmJiB0aGlzLl9pc1ZhbGlkRGF0ZUhhc2goZW5kSGFzaCkpO1xuXHQgICAgICAgIH0sIHRoaXMpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERldGFjaCBldmVudCBvbiBjYWxlbmRhclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2RldGFjaENhbGVuZGFyRXZlbnQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHRoaXMuX2NhbGVuZGFyLmRldGFjaEV2ZW50VG9Cb2R5KCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IHdyYXBwZXIgZWxlbWVudCg9IGNvbnRhaW5lcilcblx0ICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBbcGFyZW50RWxlbWVudF0gLSBwYXJlbnQgZWxlbWVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3NldFdyYXBwZXJFbGVtZW50OiBmdW5jdGlvbihwYXJlbnRFbGVtZW50KSB7XG5cdCAgICAgICAgdmFyICR3cmFwcGVyRWxlbWVudCA9IHRoaXMuXyR3cmFwcGVyRWxlbWVudDtcblx0ICAgICAgICB2YXIgJHBhcmVudEVsZW1lbnQgPSAkKHBhcmVudEVsZW1lbnQpO1xuXHRcblx0ICAgICAgICAkd3JhcHBlckVsZW1lbnQuYXBwZW5kKHRoaXMuX2NhbGVuZGFyLiRlbGVtZW50KTtcblx0XG5cdCAgICAgICAgaWYgKCRwYXJlbnRFbGVtZW50WzBdKSB7XG5cdCAgICAgICAgICAgICR3cmFwcGVyRWxlbWVudC5hcHBlbmRUbygkcGFyZW50RWxlbWVudCk7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGlzLl8kZWxlbWVudFswXSkge1xuXHQgICAgICAgICAgICAkd3JhcHBlckVsZW1lbnQuaW5zZXJ0QWZ0ZXIodGhpcy5fJGVsZW1lbnQpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICR3cmFwcGVyRWxlbWVudC5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IGRlZmF1bHQgZGF0ZVxuXHQgICAgICogQHBhcmFtIHtkYXRlSGFzaHxzdHJpbmd9IG9wRGF0ZSAtIHVzZXIgc2V0dGluZzogZGF0ZVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqIEB0b2RvIFJlZmFjdG9yOiBJbnRlZ3JhdGUgd2l0aCBcInNldERhdGVcIiBtZXRob2QuXG5cdCAgICAgKi9cblx0ICAgIF9zZXREZWZhdWx0RGF0ZTogZnVuY3Rpb24ob3BEYXRlKSB7XG5cdCAgICAgICAgaWYgKC9eYmxhbmskL2kudGVzdChvcERhdGUpKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmICghb3BEYXRlKSB7XG5cdCAgICAgICAgICAgIG9wRGF0ZSA9IGRhdGVVdGlsLmdldFRvZGF5KCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgb3BEYXRlID0ge1xuXHQgICAgICAgICAgICAgICAgeWVhcjogZGF0ZVV0aWwuZ2V0U2FmZU51bWJlcihvcERhdGUueWVhciwgTUlOX1lFQVIpLFxuXHQgICAgICAgICAgICAgICAgbW9udGg6IGRhdGVVdGlsLmdldFNhZmVOdW1iZXIob3BEYXRlLm1vbnRoLCAxKSxcblx0ICAgICAgICAgICAgICAgIGRhdGU6IGRhdGVVdGlsLmdldFNhZmVOdW1iZXIob3BEYXRlLmRhdGUsIDEpXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLl9zZXRTaG93bkxheWVySW5kZXhCeUZvcm0oKTtcblx0ICAgICAgICBpZiAodGhpcy5faXNTZWxlY3RhYmxlKG9wRGF0ZSwgdGhpcy5fZ2V0Q3VycmVudExheWVyKCkpKSB7XG5cdCAgICAgICAgICAgIHRoaXMuX2RhdGUgPSBvcERhdGU7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNhdmUgZGVmYXVsdCBzdHlsZS1wb3NpdGlvbiBvZiBjYWxlbmRhclxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IG9wUG9zIFtvcHRpb24ucG9zXSAtIHVzZXIgc2V0dGluZzogcG9zaXRpb24obGVmdCwgdG9wLCB6SW5kZXgpXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0RGVmYXVsdFBvc2l0aW9uOiBmdW5jdGlvbihvcFBvcykge1xuXHQgICAgICAgIHZhciBwb3MgPSB0aGlzLl9wb3MgPSBvcFBvcyB8fCB7fTtcblx0ICAgICAgICB2YXIgYm91bmQgPSB0aGlzLl9nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XG5cdCAgICAgICAgaWYgKCFpc051bWJlcihwb3MuekluZGV4KSkge1xuXHQgICAgICAgICAgICBwb3MuekluZGV4ID0gOTk5OTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHV0aWwuZm9yRWFjaChwb3NpdGlvbkZyb21Cb3VuZGluZ0tleU1hcHBlciwgZnVuY3Rpb24oYm91bmRpbmdLZXksIHBvc0tleSkge1xuXHQgICAgICAgICAgICBpZiAoIWlzTnVtYmVyKHBvc1twb3NLZXldKSkge1xuXHQgICAgICAgICAgICAgICAgcG9zW3Bvc0tleV0gPSBib3VuZFtib3VuZGluZ0tleV0gfHwgMDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBzdGFydC9lbmQgZWRnZSBmcm9tIHNlbGVjdGFibGUtcmFuZ2VzXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0U2VsZWN0YWJsZVJhbmdlczogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdGhpcy5fc3RhcnRUaW1lcyA9IFtdO1xuXHQgICAgICAgIHRoaXMuX2VuZFRpbWVzID0gW107XG5cdFxuXHQgICAgICAgIGZvckVhY2godGhpcy5fcmFuZ2VzLCBmdW5jdGlvbihyYW5nZSkge1xuXHQgICAgICAgICAgICB0aGlzLl91cGRhdGVUaW1lUmFuZ2Uoe1xuXHQgICAgICAgICAgICAgICAgc3RhcnQ6IGRhdGVVdGlsLmdldFRpbWUocmFuZ2VbMF0pLFxuXHQgICAgICAgICAgICAgICAgZW5kOiBkYXRlVXRpbC5nZXRUaW1lKHJhbmdlWzFdKVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9LCB0aGlzKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBVcGRhdGUgdGltZSByYW5nZSAoc3RhcnRUaW1lcywgZW5kVGltZXMpXG5cdCAgICAgKiBAcGFyYW0ge3tzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcn19IG5ld1RpbWVSYW5nZSAtIFRpbWUgcmFuZ2UgZm9yIHVwZGF0ZVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3VwZGF0ZVRpbWVSYW5nZTogZnVuY3Rpb24obmV3VGltZVJhbmdlKSB7XG5cdCAgICAgICAgdmFyIGluZGV4LCBleGlzdGluZ1RpbWVSYW5nZSwgbWVyZ2VkVGltZVJhbmdlO1xuXHRcblx0ICAgICAgICBpbmRleCA9IHRoaXMuX3NlYXJjaFN0YXJ0VGltZShuZXdUaW1lUmFuZ2Uuc3RhcnQpLmluZGV4O1xuXHQgICAgICAgIGV4aXN0aW5nVGltZVJhbmdlID0ge1xuXHQgICAgICAgICAgICBzdGFydDogdGhpcy5fc3RhcnRUaW1lc1tpbmRleF0sXG5cdCAgICAgICAgICAgIGVuZDogdGhpcy5fZW5kVGltZXNbaW5kZXhdXG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgaWYgKHRoaXMuX2lzT3ZlcmxhcHBlZFRpbWVSYW5nZShleGlzdGluZ1RpbWVSYW5nZSwgbmV3VGltZVJhbmdlKSkge1xuXHQgICAgICAgICAgICBtZXJnZWRUaW1lUmFuZ2UgPSB0aGlzLl9tZXJnZVRpbWVSYW5nZXMoZXhpc3RpbmdUaW1lUmFuZ2UsIG5ld1RpbWVSYW5nZSk7XG5cdCAgICAgICAgICAgIHRoaXMuX3N0YXJ0VGltZXMuc3BsaWNlKGluZGV4LCAxLCBtZXJnZWRUaW1lUmFuZ2Uuc3RhcnQpO1xuXHQgICAgICAgICAgICB0aGlzLl9lbmRUaW1lcy5zcGxpY2UoaW5kZXgsIDEsIG1lcmdlZFRpbWVSYW5nZS5lbmQpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHRoaXMuX3N0YXJ0VGltZXMuc3BsaWNlKGluZGV4LCAwLCBuZXdUaW1lUmFuZ2Uuc3RhcnQpO1xuXHQgICAgICAgICAgICB0aGlzLl9lbmRUaW1lcy5zcGxpY2UoaW5kZXgsIDAsIG5ld1RpbWVSYW5nZS5lbmQpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBXaGV0aGVyIHRoZSByYW5nZXMgYXJlIG92ZXJsYXBwZWRcblx0ICAgICAqIEBwYXJhbSB7e3N0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyfX0gZXhpc3RpbmdUaW1lUmFuZ2UgLSBFeGlzdGluZyB0aW1lIHJhbmdlXG5cdCAgICAgKiBAcGFyYW0ge3tzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcn19IG5ld1RpbWVSYW5nZSAtIE5ldyB0aW1lIHJhbmdlXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2hldGhlciB0aGUgcmFuZ2VzIGFyZSBvdmVybGFwcGVkXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfaXNPdmVybGFwcGVkVGltZVJhbmdlOiBmdW5jdGlvbihleGlzdGluZ1RpbWVSYW5nZSwgbmV3VGltZVJhbmdlKSB7XG5cdCAgICAgICAgdmFyIGV4aXN0aW5nU3RhcnQgPSBleGlzdGluZ1RpbWVSYW5nZS5zdGFydCxcblx0ICAgICAgICAgICAgZXhpc3RpbmdFbmQgPSBleGlzdGluZ1RpbWVSYW5nZS5lbmQsXG5cdCAgICAgICAgICAgIG5ld1N0YXJ0ID0gbmV3VGltZVJhbmdlLnN0YXJ0LFxuXHQgICAgICAgICAgICBuZXdFbmQgPSBuZXdUaW1lUmFuZ2UuZW5kLFxuXHQgICAgICAgICAgICBpc1RydXRoeSA9IGV4aXN0aW5nU3RhcnQgJiYgZXhpc3RpbmdFbmQgJiYgbmV3U3RhcnQgJiYgbmV3RW5kLFxuXHQgICAgICAgICAgICBpc092ZXJsYXBwZWQgPSAhKFxuXHQgICAgICAgICAgICAgICAgKG5ld1N0YXJ0IDwgZXhpc3RpbmdTdGFydCAmJiBuZXdFbmQgPCBleGlzdGluZ1N0YXJ0KSB8fFxuXHQgICAgICAgICAgICAgICAgKG5ld1N0YXJ0ID4gZXhpc3RpbmdFbmQgJiYgbmV3RW5kID4gZXhpc3RpbmdFbmQpXG5cdCAgICAgICAgICAgICk7XG5cdFxuXHQgICAgICAgIHJldHVybiBpc1RydXRoeSAmJiBpc092ZXJsYXBwZWQ7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTWVyZ2UgdGhlIG92ZXJsYXBwZWQgdGltZSByYW5nZXNcblx0ICAgICAqIEBwYXJhbSB7e3N0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyfX0gZXhpc3RpbmdUaW1lUmFuZ2UgLSBFeGlzdGluZyB0aW1lIHJhbmdlXG5cdCAgICAgKiBAcGFyYW0ge3tzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcn19IG5ld1RpbWVSYW5nZSAtIE5ldyB0aW1lIHJhbmdlXG5cdCAgICAgKiBAcmV0dXJucyB7e3N0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyfX0gTWVyZ2VkIHRpbWUgcmFuZ2Vcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9tZXJnZVRpbWVSYW5nZXM6IGZ1bmN0aW9uKGV4aXN0aW5nVGltZVJhbmdlLCBuZXdUaW1lUmFuZ2UpIHtcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBzdGFydDogTWF0aC5taW4oZXhpc3RpbmdUaW1lUmFuZ2Uuc3RhcnQsIG5ld1RpbWVSYW5nZS5zdGFydCksXG5cdCAgICAgICAgICAgIGVuZDogTWF0aC5tYXgoZXhpc3RpbmdUaW1lUmFuZ2UuZW5kLCBuZXdUaW1lUmFuZ2UuZW5kKVxuXHQgICAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2VhcmNoIHRpbWVzdGFtcCBpbiBzdGFydFRpbWVzXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gdGltZXN0YW1wIC0gdGltZXN0YW1wXG5cdCAgICAgKiBAcmV0dXJucyB7e2ZvdW5kOiBib29sZWFuLCBpbmRleDogbnVtYmVyfX0gcmVzdWx0XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2VhcmNoU3RhcnRUaW1lOiBmdW5jdGlvbih0aW1lc3RhbXApIHtcblx0ICAgICAgICByZXR1cm4gZGF0ZVV0aWwuc2VhcmNoKHRoaXMuX3N0YXJ0VGltZXMsIHRpbWVzdGFtcCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2VhcmNoIHRpbWVzdGFtcCBpbiBlbmRUaW1lc1xuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lc3RhbXAgLSB0aW1lc3RhbXBcblx0ICAgICAqIEByZXR1cm5zIHt7Zm91bmQ6IGJvb2xlYW4sIGluZGV4OiBudW1iZXJ9fSByZXN1bHRcblx0ICAgICAqL1xuXHQgICAgX3NlYXJjaEVuZFRpbWU6IGZ1bmN0aW9uKHRpbWVzdGFtcCkge1xuXHQgICAgICAgIHJldHVybiBkYXRlVXRpbC5zZWFyY2godGhpcy5fZW5kVGltZXMsIHRpbWVzdGFtcCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU3RvcmUgb3BlbmVyIGVsZW1lbnQgbGlzdFxuXHQgICAgICogQHBhcmFtIHtBcnJheX0gb3BPcGVuZXJzIFtvcHRpb24ub3BlbmVyc10gLSBvcGVuZXIgZWxlbWVudCBsaXN0XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0T3BlbmVyczogZnVuY3Rpb24ob3BPcGVuZXJzKSB7XG5cdCAgICAgICAgdGhpcy5hZGRPcGVuZXIodGhpcy5fJGVsZW1lbnQpO1xuXHQgICAgICAgIGZvckVhY2gob3BPcGVuZXJzLCBmdW5jdGlvbihvcGVuZXIpIHtcblx0ICAgICAgICAgICAgdGhpcy5hZGRPcGVuZXIob3BlbmVyKTtcblx0ICAgICAgICB9LCB0aGlzKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgVGltZVBpY2tlciBpbnN0YW5jZVxuXHQgICAgICogQHBhcmFtIHtUaW1lUGlja2VyfSBbb3BUaW1lUGlja2VyXSAtIFRpbWVQaWNrZXIgaW5zdGFuY2Vcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXRUaW1lUGlja2VyOiBmdW5jdGlvbihvcFRpbWVQaWNrZXIpIHtcblx0ICAgICAgICBpZiAoIW9wVGltZVBpY2tlcikge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLl90aW1lUGlja2VyID0gb3BUaW1lUGlja2VyO1xuXHQgICAgICAgIHRoaXMuX2JpbmRDdXN0b21FdmVudFdpdGhUaW1lUGlja2VyKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQmluZCBjdXN0b20gZXZlbnQgd2l0aCBUaW1lUGlja2VyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYmluZEN1c3RvbUV2ZW50V2l0aFRpbWVQaWNrZXI6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBvbkNoYW5nZVRpbWVQaWNrZXIgPSBiaW5kKHRoaXMuc2V0RGF0ZSwgdGhpcyk7XG5cdFxuXHQgICAgICAgIHRoaXMub24oJ29wZW4nLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgdGhpcy5fdGltZVBpY2tlci5zZXRUaW1lRnJvbUlucHV0RWxlbWVudCh0aGlzLl8kZWxlbWVudCk7XG5cdCAgICAgICAgICAgIHRoaXMuX3RpbWVQaWNrZXIub24oJ2NoYW5nZScsIG9uQ2hhbmdlVGltZVBpY2tlcik7XG5cdCAgICAgICAgfSwgdGhpcyk7XG5cdCAgICAgICAgdGhpcy5vbignY2xvc2UnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgdGhpcy5fdGltZVBpY2tlci5vZmYoJ2NoYW5nZScsIG9uQ2hhbmdlVGltZVBpY2tlcik7XG5cdCAgICAgICAgfSwgdGhpcyk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ2hlY2sgdmFsaWRhdGlvbiBvZiBhIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIC0geWVhclxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gd2hldGhlciB0aGUgeWVhciBpcyB2YWxpZCBvciBub3Rcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9pc1ZhbGlkWWVhcjogZnVuY3Rpb24oeWVhcikge1xuXHQgICAgICAgIHJldHVybiBpc051bWJlcih5ZWFyKSAmJiB5ZWFyID49IE1JTl9ZRUFSICYmIHllYXIgPD0gTUFYX1lFQVI7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ2hlY2sgdmFsaWRhdGlvbiBvZiBhIG1vbnRoXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gbW9udGggLSBtb250aFxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gd2hldGhlciB0aGUgbW9udGggaXMgdmFsaWQgb3Igbm90XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfaXNWYWxpZE1vbnRoOiBmdW5jdGlvbihtb250aCkge1xuXHQgICAgICAgIHJldHVybiBpc051bWJlcihtb250aCkgJiYgbW9udGggPiAwICYmIG1vbnRoIDwgMTM7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogV2hldGhlciB0aGUgZGF5LWluLW1vbnRoIGlzIHZhbGlkXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciAtIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCAtIG1vbnRoXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gZGF0ZSAtIGRhdGVcblx0ICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2lzVmFsaWREYXlJbk1vbnRoOiBmdW5jdGlvbih5ZWFyLCBtb250aCwgZGF0ZSkge1xuXHQgICAgICAgIHJldHVybiBpc051bWJlcihkYXRlKSAmJiAoZGF0ZSA+IDApICYmIChkYXRlIDw9IGRhdGVVdGlsLmdldExhc3REYXlJbk1vbnRoKHllYXIsIG1vbnRoKSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogV2hldGhlciB0aGUgdmFsdWVzIGluIGEgZGF0ZUhhc2ggYXJlIHZhbGlkXG5cdCAgICAgKiBAcGFyYW0ge2RhdGVIYXNofSBkYXRlSGFzaCAtIGRhdGVIYXNoXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9pc1ZhbGlkRGF0ZUhhc2g6IGZ1bmN0aW9uKGRhdGVIYXNoKSB7XG5cdCAgICAgICAgdmFyIHllYXIsIG1vbnRoLCBkYXRlO1xuXHRcblx0ICAgICAgICBpZiAoIWRhdGVIYXNoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHllYXIgPSBkYXRlSGFzaC55ZWFyIHx8IHRoaXMuX2RhdGUueWVhcjtcblx0ICAgICAgICBtb250aCA9IGRhdGVIYXNoLm1vbnRoIHx8IHRoaXMuX2RhdGUubW9udGg7XG5cdCAgICAgICAgZGF0ZSA9IGRhdGVIYXNoLmRhdGUgfHwgdGhpcy5fZGF0ZS5kYXRlO1xuXHRcblx0ICAgICAgICByZXR1cm4gdGhpcy5faXNWYWxpZFllYXIoeWVhcikgJiYgdGhpcy5faXNWYWxpZE1vbnRoKG1vbnRoKSAmJiB0aGlzLl9pc1ZhbGlkRGF5SW5Nb250aCh5ZWFyLCBtb250aCwgZGF0ZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ2hlY2sgYW4gZWxlbWVudCBpcyBhbiBvcGVuZXIuXG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgZWxlbWVudFxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gb3BlbmVyIHRydWUvZmFsc2Vcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9pc09wZW5lcjogZnVuY3Rpb24odGFyZ2V0KSB7XG5cdCAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuXHQgICAgICAgIHZhciBvcGVuZXJzID0gdGhpcy5fb3BlbmVycztcblx0ICAgICAgICB2YXIgaSA9IDA7XG5cdCAgICAgICAgdmFyIGxlbiA9IG9wZW5lcnMubGVuZ3RoO1xuXHRcblx0ICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSArPSAxKSB7XG5cdCAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IG9wZW5lcnNbaV0gfHwgJC5jb250YWlucyhvcGVuZXJzW2ldLCB0YXJnZXQpKSB7XG5cdCAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiByZXN1bHQ7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IHN0eWxlLXBvc2l0aW9uIG9mIGNhbGVuZGFyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYXJyYW5nZUxheWVyOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLl8kd3JhcHBlckVsZW1lbnRbMF0uc3R5bGUsXG5cdCAgICAgICAgICAgIHBvcyA9IHRoaXMuX3Bvcztcblx0XG5cdCAgICAgICAgc3R5bGUubGVmdCA9IHBvcy5sZWZ0ICsgJ3B4Jztcblx0ICAgICAgICBzdHlsZS50b3AgPSBwb3MudG9wICsgJ3B4Jztcblx0ICAgICAgICBzdHlsZS56SW5kZXggPSBwb3MuekluZGV4O1xuXHQgICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5hcHBlbmQodGhpcy5fY2FsZW5kYXIuJGVsZW1lbnQpO1xuXHQgICAgICAgIGlmICh0aGlzLl90aW1lUGlja2VyKSB7XG5cdCAgICAgICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5hcHBlbmQodGhpcy5fdGltZVBpY2tlci4kdGltZVBpY2tlckVsZW1lbnQpO1xuXHQgICAgICAgICAgICB0aGlzLl90aW1lUGlja2VyLnNob3coKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IGJvdW5kaW5nQ2xpZW50UmVjdCBvZiBhbiBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fGpRdWVyeX0gW2VsZW1lbnRdIC0gZWxlbWVudFxuXHQgICAgICogQHJldHVybnMge09iamVjdH0gLSBhbiBvYmplY3QgaGF2aW5nIGxlZnQsIHRvcCwgYm90dG9tLCByaWdodCBvZiBlbGVtZW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfZ2V0Qm91bmRpbmdDbGllbnRSZWN0OiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdCAgICAgICAgdmFyIGVsID0gJChlbGVtZW50KVswXSB8fCB0aGlzLl8kZWxlbWVudFswXSxcblx0ICAgICAgICAgICAgYm91bmQsXG5cdCAgICAgICAgICAgIGNlaWw7XG5cdFxuXHQgICAgICAgIGlmICghZWwpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHt9O1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgYm91bmQgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0ICAgICAgICBjZWlsID0gTWF0aC5jZWlsO1xuXHRcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBsZWZ0OiBjZWlsKGJvdW5kLmxlZnQpLFxuXHQgICAgICAgICAgICB0b3A6IGNlaWwoYm91bmQudG9wKSxcblx0ICAgICAgICAgICAgYm90dG9tOiBjZWlsKGJvdW5kLmJvdHRvbSksXG5cdCAgICAgICAgICAgIHJpZ2h0OiBjZWlsKGJvdW5kLnJpZ2h0KVxuXHQgICAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IGRhdGUgZnJvbSBzdHJpbmdcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgLSBkYXRlIHN0cmluZ1xuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3NldERhdGVGcm9tU3RyaW5nOiBmdW5jdGlvbihzdHIpIHtcblx0ICAgICAgICB2YXIgZGF0ZSA9IHRoaXMuX2V4dHJhY3REYXRlKHN0cik7XG5cdFxuXHQgICAgICAgIGRhdGUgPSBleHRlbmQoe30sIHRoaXMuX2RhdGUsIGRhdGUpO1xuXHRcblx0ICAgICAgICBpZiAoZGF0ZSAmJiB0aGlzLl9pc1NlbGVjdGFibGUoZGF0ZSkpIHtcblx0ICAgICAgICAgICAgaWYgKHRoaXMuX3RpbWVQaWNrZXIpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVQaWNrZXIuc2V0VGltZUZyb21JbnB1dEVsZW1lbnQodGhpcy5fJGVsZW1lbnQpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHRoaXMuc2V0RGF0ZShkYXRlLnllYXIsIGRhdGUubW9udGgsIGRhdGUuZGF0ZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgdGhpcy5zZXREYXRlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybiBmb3JtZWQgZGF0ZS1zdHJpbmcgZnJvbSBkYXRlIG9iamVjdFxuXHQgICAgICogQHJldHVybnMge3N0cmluZ30gLSBmb3JtZWQgZGF0ZS1zdHJpbmdcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9tYWtlRGF0ZVN0cmluZzogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIHllYXIgPSB0aGlzLl9kYXRlLnllYXIsXG5cdCAgICAgICAgICAgIG1vbnRoID0gdGhpcy5fZGF0ZS5tb250aCxcblx0ICAgICAgICAgICAgZGF0ZSA9IHRoaXMuX2RhdGUuZGF0ZSxcblx0ICAgICAgICAgICAgZm9ybWF0ID0gdGhpcy5fZGF0ZUZvcm1hdCxcblx0ICAgICAgICAgICAgcmVwbGFjZU1hcCxcblx0ICAgICAgICAgICAgZGF0ZVN0cmluZztcblx0XG5cdCAgICAgICAgbW9udGggPSBtb250aCA8IDEwID8gKCcwJyArIG1vbnRoKSA6IG1vbnRoO1xuXHQgICAgICAgIGRhdGUgPSBkYXRlIDwgMTAgPyAoJzAnICsgZGF0ZSkgOiBkYXRlO1xuXHRcblx0ICAgICAgICByZXBsYWNlTWFwID0ge1xuXHQgICAgICAgICAgICB5eXl5OiB5ZWFyLFxuXHQgICAgICAgICAgICB5eTogU3RyaW5nKHllYXIpLnN1YnN0cigyLCAyKSxcblx0ICAgICAgICAgICAgbW06IG1vbnRoLFxuXHQgICAgICAgICAgICBtOiBOdW1iZXIobW9udGgpLFxuXHQgICAgICAgICAgICBkZDogZGF0ZSxcblx0ICAgICAgICAgICAgZDogTnVtYmVyKGRhdGUpXG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgZGF0ZVN0cmluZyA9IGZvcm1hdC5yZXBsYWNlKGZvcm1hdFJlZ0V4cCwgZnVuY3Rpb24oa2V5KSB7XG5cdCAgICAgICAgICAgIHJldHVybiByZXBsYWNlTWFwW2tleS50b0xvd2VyQ2FzZSgpXSB8fCAnJztcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgcmV0dXJuIGRhdGVTdHJpbmc7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRXh0cmFjdCBkYXRlLW9iamVjdCBmcm9tIGlucHV0IHN0cmluZyB3aXRoIGNvbXBhcmluZyBkYXRlLWZvcm1hdDxicj5cblx0ICAgICAqIElmIGNhbiBub3QgZXh0cmFjdCwgcmV0dXJuIGZhbHNlXG5cdCAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIC0gaW5wdXQgc3RyaW5nKHRleHQpXG5cdCAgICAgKiBAcmV0dXJucyB7ZGF0ZUhhc2h8ZmFsc2V9IC0gZXh0cmFjdGVkIGRhdGUgb2JqZWN0IG9yIGZhbHNlXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfZXh0cmFjdERhdGU6IGZ1bmN0aW9uKHN0cikge1xuXHQgICAgICAgIHZhciBmb3JtT3JkZXIgPSB0aGlzLl9mb3JtT3JkZXIsXG5cdCAgICAgICAgICAgIHJlc3VsdERhdGUgPSB7fSxcblx0ICAgICAgICAgICAgcmVnRXhwID0gdGhpcy5fcmVnRXhwO1xuXHRcblx0ICAgICAgICByZWdFeHAubGFzdEluZGV4ID0gMDtcblx0ICAgICAgICBpZiAocmVnRXhwLnRlc3Qoc3RyKSkge1xuXHQgICAgICAgICAgICBpZiAoZm9ybU9yZGVyWzBdKSB7XG5cdCAgICAgICAgICAgICAgICByZXN1bHREYXRlW2Zvcm1PcmRlclswXV0gPSBOdW1iZXIoUmVnRXhwLiQxKTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgaWYgKGZvcm1PcmRlclsxXSkge1xuXHQgICAgICAgICAgICAgICAgcmVzdWx0RGF0ZVtmb3JtT3JkZXJbMV1dID0gTnVtYmVyKFJlZ0V4cC4kMik7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIGlmIChmb3JtT3JkZXJbMl0pIHtcblx0ICAgICAgICAgICAgICAgIHJlc3VsdERhdGVbZm9ybU9yZGVyWzJdXSA9IE51bWJlcihSZWdFeHAuJDMpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKFN0cmluZyhyZXN1bHREYXRlLnllYXIpLmxlbmd0aCA9PT0gMikge1xuXHQgICAgICAgICAgICByZXN1bHREYXRlLnllYXIgPSBOdW1iZXIodGhpcy5fZGVmYXVsdENlbnR1cnkgKyByZXN1bHREYXRlLnllYXIpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIHJlc3VsdERhdGU7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogV2hldGhlciBhIGRhdGVIYXNoIGlzIHNlbGVjdGFibGVcblx0ICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGRhdGVIYXNoIC0gZGF0ZUhhc2hcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbGF5ZXJUeXBlID0gREFURV9MQVlFUl0gLSBZRUFSX0xBWUVSIHwgTU9OVEhfTEFZRVIgfCBkZWZhdWx0XG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBXaGV0aGVyIGEgZGF0ZUhhc2ggaXMgc2VsZWN0YWJsZVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2lzU2VsZWN0YWJsZTogZnVuY3Rpb24oZGF0ZUhhc2gsIGxheWVyVHlwZSkge1xuXHQgICAgICAgIHZhciBzdGFydFRpbWVzID0gdGhpcy5fc3RhcnRUaW1lcztcblx0ICAgICAgICB2YXIgc3RhcnRUaW1lLCBzZWFyY2hSZXN1bHQsIHRpbWVzdGFtcCwgY29tcGFyaW5nTGV2ZWw7XG5cdFxuXHQgICAgICAgIGRhdGVIYXNoID0gZXh0ZW5kKHt9LCBkYXRlSGFzaCk7XG5cdCAgICAgICAgc3dpdGNoIChsYXllclR5cGUpIHtcblx0ICAgICAgICAgICAgY2FzZSBZRUFSX0xBWUVSOlxuXHQgICAgICAgICAgICAgICAgZGF0ZUhhc2gubW9udGggPSAxO1xuXHQgICAgICAgICAgICAgICAgZGF0ZUhhc2guZGF0ZSA9IDE7XG5cdCAgICAgICAgICAgICAgICBjb21wYXJpbmdMZXZlbCA9IFlFQVJfVE9fTVM7XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgY2FzZSBNT05USF9MQVlFUjpcblx0ICAgICAgICAgICAgICAgIGRhdGVIYXNoLmRhdGUgPSAxO1xuXHQgICAgICAgICAgICAgICAgY29tcGFyaW5nTGV2ZWwgPSBNT05USF9UT19NUztcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBkZWZhdWx0OlxuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoIXRoaXMuX2lzVmFsaWREYXRlSGFzaChkYXRlSGFzaCkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAoIXN0YXJ0VGltZXMubGVuZ3RoKSB7IC8vIE5vIHJhbmdlcy4gQWxsIGRhdGVzIGFyZSBzZWxlY3RhYmxlLlxuXHQgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRpbWVzdGFtcCA9IGRhdGVVdGlsLmdldFRpbWUoZGF0ZUhhc2gpO1xuXHQgICAgICAgIHNlYXJjaFJlc3VsdCA9IHRoaXMuX3NlYXJjaEVuZFRpbWUodGltZXN0YW1wKTtcblx0ICAgICAgICBzdGFydFRpbWUgPSBzdGFydFRpbWVzW3NlYXJjaFJlc3VsdC5pbmRleF07XG5cdFxuXHQgICAgICAgIHJldHVybiBzZWFyY2hSZXN1bHQuZm91bmQgfHwgaXNHcmVhdGVyVGhhbk9yRXF1YWxUbyh0aW1lc3RhbXAsIHN0YXJ0VGltZSwgY29tcGFyaW5nTGV2ZWwpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBzZWxlY3RhYmxlLWNsYXNzLW5hbWUgdG8gc2VsZWN0YWJsZSBkYXRlIGVsZW1lbnQuXG5cdCAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1lbnQgLSBkYXRlIGVsZW1lbnRcblx0ICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGRhdGVIYXNoIC0gZGF0ZSBvYmplY3Rcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYXllclR5cGUgLSBZRUFSX0xBWUVSIHwgTU9OVEhfTEFZRVIgfCBEQVRFX0xBWUVSXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0U2VsZWN0YWJsZUNsYXNzTmFtZTogZnVuY3Rpb24oJGVsZW1lbnQsIGRhdGVIYXNoLCBsYXllclR5cGUpIHtcblx0ICAgICAgICBpZiAodGhpcy5faXNTZWxlY3RhYmxlKGRhdGVIYXNoLCBsYXllclR5cGUpKSB7XG5cdCAgICAgICAgICAgICRlbGVtZW50LmFkZENsYXNzKHRoaXMuX3NlbGVjdGFibGVDbGFzc05hbWUpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgc2VsZWN0ZWQtY2xhc3MtbmFtZSB0byBzZWxlY3RlZCBkYXRlIGVsZW1lbnRcblx0ICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBlbGVtZW50IC0gZGF0ZSBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXIsIGRhdGU6IG51bWJlcn19IGRhdGVIYXNoIC0gZGF0ZSBvYmplY3Rcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYXllclR5cGUgLSBZRUFSX0xBWUVSIHwgTU9OVEhfTEFZRVIgfCBEQVRFX0xBWUVSXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0U2VsZWN0ZWRDbGFzc05hbWU6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGVIYXNoLCBsYXllclR5cGUpIHtcblx0ICAgICAgICB2YXIgY3VyRGF0ZUhhc2ggPSB0aGlzLl9kYXRlO1xuXHQgICAgICAgIHZhciBpc1NlbGVjdGVkO1xuXHRcblx0ICAgICAgICBzd2l0Y2ggKGxheWVyVHlwZSkge1xuXHQgICAgICAgICAgICBjYXNlIE1PTlRIX0xBWUVSOlxuXHQgICAgICAgICAgICAgICAgZGF0ZUhhc2guZGF0ZSA9IGN1ckRhdGVIYXNoLmRhdGU7XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgY2FzZSBZRUFSX0xBWUVSOlxuXHQgICAgICAgICAgICAgICAgZGF0ZUhhc2guZGF0ZSA9IGN1ckRhdGVIYXNoLmRhdGU7XG5cdCAgICAgICAgICAgICAgICBkYXRlSGFzaC5tb250aCA9IGN1ckRhdGVIYXNoLm1vbnRoO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGRlZmF1bHQ6XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlzU2VsZWN0ZWQgPSBkYXRlVXRpbC5pc0VxdWFsRGF0ZUhhc2goY3VyRGF0ZUhhc2gsIGRhdGVIYXNoKTtcblx0ICAgICAgICBpZiAoaXNTZWxlY3RlZCkge1xuXHQgICAgICAgICAgICAkKGVsZW1lbnQpLmFkZENsYXNzKHRoaXMuX3NlbGVjdGVkQ2xhc3NOYW1lKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IHZhbHVlIGEgZGF0ZS1zdHJpbmcgb2YgY3VycmVudCB0aGlzIGluc3RhbmNlIHRvIGlucHV0IGVsZW1lbnRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXRWYWx1ZVRvSW5wdXRFbGVtZW50OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgZGF0ZVN0cmluZywgdGltZVN0cmluZztcblx0XG5cdCAgICAgICAgaWYgKCF0aGlzLl9kYXRlKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGRhdGVTdHJpbmcgPSB0aGlzLl9tYWtlRGF0ZVN0cmluZygpO1xuXHQgICAgICAgIHRpbWVTdHJpbmcgPSAnJztcblx0XG5cdCAgICAgICAgaWYgKHRoaXMuX3RpbWVQaWNrZXIpIHtcblx0ICAgICAgICAgICAgdGltZVN0cmluZyA9IHRoaXMuX3RpbWVQaWNrZXIuZ2V0VGltZSgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5fJGVsZW1lbnQudmFsKGRhdGVTdHJpbmcgKyB0aW1lU3RyaW5nKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQob3IgbWFrZSkgUmVnRXhwIGluc3RhbmNlIGZyb20gdGhlIGRhdGUtZm9ybWF0IG9mIHRoaXMgaW5zdGFuY2UuXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0UmVnRXhwOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgcmVnRXhwU3RyID0gJ14nO1xuXHQgICAgICAgIHZhciBmb3JtT3JkZXIgPSB0aGlzLl9mb3JtT3JkZXI7XG5cdFxuXHQgICAgICAgIHZhciBtYXRjaGVkS2V5cyA9IHRoaXMuX2RhdGVGb3JtYXQubWF0Y2goZm9ybWF0UmVnRXhwKTtcblx0ICAgICAgICB1dGlsLmZvckVhY2gobWF0Y2hlZEtleXMsIGZ1bmN0aW9uKGtleSwgaW5kZXgpIHtcblx0ICAgICAgICAgICAga2V5ID0ga2V5LnRvTG93ZXJDYXNlKCk7XG5cdCAgICAgICAgICAgIHJlZ0V4cFN0ciArPSAobWFwRm9yQ29udmVydGluZ1trZXldLmV4cHJlc3Npb24gKyAnW1xcXFxEXFxcXHNdKicpO1xuXHQgICAgICAgICAgICBmb3JtT3JkZXJbaW5kZXhdID0gbWFwRm9yQ29udmVydGluZ1trZXldLnR5cGU7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHRoaXMuX3JlZ0V4cCA9IG5ldyBSZWdFeHAocmVnRXhwU3RyLCAnZ2knKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgZXZlbnQgaGFuZGxlcnMgdG8gYmluZCBjb250ZXh0IGFuZCB0aGVuIHN0b3JlLlxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3NldFByb3h5SGFuZGxlcnM6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBwcm94aWVzID0gdGhpcy5fcHJveHlIYW5kbGVycztcblx0XG5cdCAgICAgICAgLy8gRXZlbnQgaGFuZGxlcnMgZm9yIGVsZW1lbnRcblx0ICAgICAgICBwcm94aWVzLm9uTW91c2Vkb3duRG9jdW1lbnQgPSBiaW5kKHRoaXMuX29uTW91c2Vkb3duRG9jdW1lbnQsIHRoaXMpO1xuXHQgICAgICAgIHByb3hpZXMub25LZXlkb3duRWxlbWVudCA9IGJpbmQodGhpcy5fb25LZXlkb3duRWxlbWVudCwgdGhpcyk7XG5cdCAgICAgICAgcHJveGllcy5vbkNsaWNrQ2FsZW5kYXIgPSBiaW5kKHRoaXMuX29uQ2xpY2tDYWxlbmRhciwgdGhpcyk7XG5cdCAgICAgICAgcHJveGllcy5vbkNsaWNrT3BlbmVyID0gYmluZCh0aGlzLl9vbkNsaWNrT3BlbmVyLCB0aGlzKTtcblx0XG5cdCAgICAgICAgLy8gRXZlbnQgaGFuZGxlcnMgZm9yIGN1c3RvbSBldmVudCBvZiBjYWxlbmRhclxuXHQgICAgICAgIHByb3hpZXMub25CZWZvcmVEcmF3Q2FsZW5kYXIgPSBiaW5kKHRoaXMuX29uQmVmb3JlRHJhd0NhbGVuZGFyLCB0aGlzKTtcblx0ICAgICAgICBwcm94aWVzLm9uRHJhd0NhbGVuZGFyID0gYmluZCh0aGlzLl9vbkRyYXdDYWxlbmRhciwgdGhpcyk7XG5cdCAgICAgICAgcHJveGllcy5vbkFmdGVyRHJhd0NhbGVuZGFyID0gYmluZCh0aGlzLl9vbkFmdGVyRHJhd0NhbGVuZGFyLCB0aGlzKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIGZvciBtb3VzZWRvd24gb2YgZG9jdW1lbnQ8YnI+XG5cdCAgICAgKiAtIFdoZW4gY2xpY2sgdGhlIG91dCBvZiBsYXllciwgY2xvc2UgdGhlIGxheWVyXG5cdCAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCAtIGV2ZW50IG9iamVjdFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX29uTW91c2Vkb3duRG9jdW1lbnQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdCAgICAgICAgdmFyIGlzQ29udGFpbnMgPSAkLmNvbnRhaW5zKHRoaXMuXyR3cmFwcGVyRWxlbWVudFswXSwgZXZlbnQudGFyZ2V0KTtcblx0XG5cdCAgICAgICAgaWYgKCghaXNDb250YWlucyAmJiAhdGhpcy5faXNPcGVuZXIoZXZlbnQudGFyZ2V0KSkpIHtcblx0ICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIGZvciBlbnRlci1rZXkgZG93biBvZiBpbnB1dCBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge0V2ZW50fSBbZXZlbnRdIC0gZXZlbnQgb2JqZWN0XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfb25LZXlkb3duRWxlbWVudDogZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICBpZiAoIWV2ZW50IHx8IGV2ZW50LmtleUNvZGUgIT09IDEzKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5fc2V0RGF0ZUZyb21TdHJpbmcodGhpcy5fJGVsZW1lbnQudmFsKCkpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIGNsaWNrIG9mIGNhbGVuZGFyPGJyPlxuXHQgICAgICogLSBVcGRhdGUgZGF0ZSBmb3JtIGV2ZW50LXRhcmdldFxuXHQgICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSBldmVudCBvYmplY3Rcblx0ICAgICAqIEB0b2RvIHJlZmFjdG9yIC0gY29tcGxleGl0eVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX29uQ2xpY2tDYWxlbmRhcjogZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuXHQgICAgICAgIHZhciBjbGFzc05hbWUgPSB0YXJnZXQuY2xhc3NOYW1lO1xuXHQgICAgICAgIHZhciB2YWx1ZSA9ICh0YXJnZXQuaW5uZXJUZXh0IHx8IHRhcmdldC50ZXh0Q29udGVudCB8fCB0YXJnZXQubm9kZVZhbHVlKTtcblx0ICAgICAgICB2YXIgc2hvd25MYXllcklkeCA9IHRoaXMuX2NhbGVuZGFyLnNob3duTGF5ZXJJZHg7XG5cdCAgICAgICAgdmFyIHNob3duRGF0ZSA9IHRoaXMuX2NhbGVuZGFyLmdldERhdGUoKTtcblx0ICAgICAgICB2YXIgc3RhcnRMYXllcklkeCA9IHRoaXMuX3Nob3duTGF5ZXJJZHg7XG5cdCAgICAgICAgdmFyIGRhdGVIYXNoLCByZWxhdGl2ZU1vbnRoO1xuXHRcblx0ICAgICAgICBpZiAoY2xhc3NOYW1lLmluZGV4T2YoJ3ByZXYtbW9udGgnKSA+IC0xKSB7XG5cdCAgICAgICAgICAgIHJlbGF0aXZlTW9udGggPSAtMTtcblx0ICAgICAgICB9IGVsc2UgaWYgKGNsYXNzTmFtZS5pbmRleE9mKCduZXh0LW1vbnRoJykgPiAtMSkge1xuXHQgICAgICAgICAgICByZWxhdGl2ZU1vbnRoID0gMTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICByZWxhdGl2ZU1vbnRoID0gJCh0YXJnZXQpLmRhdGEoUkVMQVRJVkVfTU9OVEhfVkFMVUVfS0VZKSB8fCAwO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgc2hvd25EYXRlLmRhdGUgPSAoIXNob3duTGF5ZXJJZHgpID8gTnVtYmVyKHZhbHVlKSA6IDE7XG5cdCAgICAgICAgZGF0ZUhhc2ggPSBkYXRlVXRpbC5nZXRSZWxhdGl2ZURhdGUoMCwgcmVsYXRpdmVNb250aCwgMCwgc2hvd25EYXRlKTtcblx0XG5cdCAgICAgICAgaWYgKHN0YXJ0TGF5ZXJJZHggPT09IHNob3duTGF5ZXJJZHgpIHtcblx0ICAgICAgICAgICAgdGhpcy5zZXREYXRlKGRhdGVIYXNoLnllYXIsIGRhdGVIYXNoLm1vbnRoLCBkYXRlSGFzaC5kYXRlKTtcblx0XG5cdCAgICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICAgKiBQaWNrIGV2ZW50XG5cdCAgICAgICAgICAgICAqIEBldmVudCBEYXRlUGlja2VyI3BpY2tcblx0ICAgICAgICAgICAgICogQGV4YW1wbGVcblx0ICAgICAgICAgICAgICogZGF0ZXBpY2tlci5vbigncGljaycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgKiAgICAgIHJldHVybiBmYWxzZTsgLy8gQ2FuY2VsIHRvIGNsb3NlIGxheWVyXG5cdCAgICAgICAgICAgICAqICAgICAgLy8gcmV0dXJuIHRydWU7IC8vIExheWVyIGlzIGNsb3NlZFxuXHQgICAgICAgICAgICAgKiB9KTtcblx0ICAgICAgICAgICAgICovXG5cdCAgICAgICAgICAgIGlmICghdGhpcy5pbnZva2UoJ3BpY2snKSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBpZiAoIXRoaXMuc2hvd0Fsd2F5cykge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHsgLy8gbW92ZSBwcmV2aW91cyBsYXllclxuXHQgICAgICAgICAgICB0aGlzLl9jYWxlbmRhci5kcmF3KGRhdGVIYXNoLnllYXIsIGRhdGVIYXNoLm1vbnRoLCBmYWxzZSwgc2hvd25MYXllcklkeCAtIDEpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIGZvciBjbGljayBvZiBvcGVuZXItZWxlbWVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX29uQ2xpY2tPcGVuZXI6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBpc09wZW5lZCA9IHRoaXMuaXNPcGVuZWQoKTtcblx0XG5cdCAgICAgICAgaWYgKGlzT3BlbmVkKSB7XG5cdCAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICB0aGlzLm9wZW4oKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRXZlbnQgaGFuZGxlciBmb3IgJ2JlZm9yZURyYXcnLWN1c3RvbSBldmVudCBvZiBjYWxlbmRhclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqIEBzZWUge3R1aS5jb21wb25lbnQuQ2FsZW5kYXIuZHJhd31cblx0ICAgICAqL1xuXHQgICAgX29uQmVmb3JlRHJhd0NhbGVuZGFyOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aGlzLl91bmJpbmRPbkNsaWNrQ2FsZW5kYXIoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIGZvciAnZHJhdyctY3VzdG9tIGV2ZW50IG9mIGNhbGVuZGFyXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnREYXRhIC0gY3VzdG9tIGV2ZW50IGRhdGFcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKiBAc2VlIHt0dWkuY29tcG9uZW50LkNhbGVuZGFyLmRyYXd9XG5cdCAgICAgKiBAdG9kbyBUaGUgZXZlbnREYXRhIG9mIGNhbGVuZGFyLSdkcmF3JyBzaG91bGQgaGF2ZSBhIHByb3BlcnR5IGluZGljYXRpbmcgd2hhdCBpcyBhIGJlaW5nIGRyYXduIGxheWVyLlxuXHQgICAgICovXG5cdCAgICBfb25EcmF3Q2FsZW5kYXI6IGZ1bmN0aW9uKGV2ZW50RGF0YSkge1xuXHQgICAgICAgIHZhciAkZGF0ZUNvbnRhaW5lciA9IGV2ZW50RGF0YS4kZGF0ZUNvbnRhaW5lcjtcblx0ICAgICAgICB2YXIgY2xhc3NOYW1lcyA9ICRkYXRlQ29udGFpbmVyLmF0dHIoJ2NsYXNzJyk7XG5cdCAgICAgICAgdmFyIGRhdGVIYXNoID0ge1xuXHQgICAgICAgICAgICB5ZWFyOiBldmVudERhdGEueWVhcixcblx0ICAgICAgICAgICAgbW9udGg6IGV2ZW50RGF0YS5tb250aCB8fCAxLFxuXHQgICAgICAgICAgICBkYXRlOiBldmVudERhdGEuZGF0ZSB8fCAxXG5cdCAgICAgICAgfTtcblx0ICAgICAgICB2YXIgbGF5ZXJUeXBlO1xuXHRcblx0ICAgICAgICAvLyAnZGF0ZScgYW5kICdtb250aCcgY2xhc3NOYW1lcyBjYW4gYmUgZHVwbGljYXRlZCAoZXgtJ2NhbGVuZGFyLWRhdGUuY2FsZW5kYXItcHJldi1tb250aCcpLlxuXHQgICAgICAgIC8vIElmIHRoZSBhYm92ZSAndG9kbycgaXMgcmVzb2x2ZWQsIHRoaXMgY29uZGl0aW9uYWwgc3RhdGVtZW50cyBhcmUgdW5uZWNlc3NhcnkuXG5cdCAgICAgICAgaWYgKGNsYXNzTmFtZXMuaW5kZXhPZihEQVRFX0xBWUVSKSA+IC0xKSB7XG5cdCAgICAgICAgICAgIGxheWVyVHlwZSA9IERBVEVfTEFZRVI7XG5cdCAgICAgICAgfSBlbHNlIGlmIChjbGFzc05hbWVzLmluZGV4T2YoTU9OVEhfTEFZRVIpID4gLTEpIHtcblx0ICAgICAgICAgICAgbGF5ZXJUeXBlID0gTU9OVEhfTEFZRVI7XG5cdCAgICAgICAgfSBlbHNlIGlmIChjbGFzc05hbWVzLmluZGV4T2YoWUVBUl9MQVlFUikgPiAtMSkge1xuXHQgICAgICAgICAgICBsYXllclR5cGUgPSBZRUFSX0xBWUVSO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5fc2V0U2VsZWN0YWJsZUNsYXNzTmFtZSgkZGF0ZUNvbnRhaW5lciwgZGF0ZUhhc2gsIGxheWVyVHlwZSk7XG5cdCAgICAgICAgaWYgKHRoaXMuX2RhdGUpIHtcblx0ICAgICAgICAgICAgdGhpcy5fc2V0U2VsZWN0ZWRDbGFzc05hbWUoJGRhdGVDb250YWluZXIsIGRhdGVIYXNoLCBsYXllclR5cGUpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIGZvciAnYWZ0ZXJEcmF3Jy1jdXN0b20gZXZlbnQgb2YgY2FsZW5kYXJcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKiBAc2VlIHt0dWkuY29tcG9uZW50LkNhbGVuZGFyLmRyYXd9XG5cdCAgICAgKi9cblx0ICAgIF9vbkFmdGVyRHJhd0NhbGVuZGFyOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aGlzLl9zaG93T25seVZhbGlkQnV0dG9ucygpO1xuXHQgICAgICAgIHRoaXMuX2JpbmRPbkNsaWNrQ2FsZW5kYXIoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTaG93IG9ubHkgdmFsaWQgYnV0dG9ucyBpbiBjYWxlbmRhclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3Nob3dPbmx5VmFsaWRCdXR0b25zOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgJGhlYWRlciA9IHRoaXMuX2NhbGVuZGFyLiRoZWFkZXI7XG5cdCAgICAgICAgdmFyICRwcmV2QnRuID0gJGhlYWRlci5maW5kKCdbY2xhc3MqPVwiYnRuLXByZXZcIl0nKS5oaWRlKCk7XG5cdCAgICAgICAgdmFyICRuZXh0QnRuID0gJGhlYWRlci5maW5kKCdbY2xhc3MqPVwiYnRuLW5leHRcIl0nKS5oaWRlKCk7XG5cdCAgICAgICAgdmFyIGRpZmZUaW1lID0gdGhpcy5fZ2V0RGlmZlRpbWUoKTtcblx0XG5cdCAgICAgICAgaWYgKGRpZmZUaW1lLnN0YXJ0ID4gMCkge1xuXHQgICAgICAgICAgICAkcHJldkJ0bi5zaG93KCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoZGlmZlRpbWUuZW5kID4gMCkge1xuXHQgICAgICAgICAgICAkbmV4dEJ0bi5zaG93KCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEJpbmQga2V5ZG93biBldmVudCBoYW5kbGVyIHRvIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgICAgICogQHBhcmFtIHtqUXVlcnl9ICR0YXJnZXRFbCAtIHRhcmdldCBlbGVtZW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYmluZEtleWRvd25FdmVudDogZnVuY3Rpb24oJHRhcmdldEVsKSB7XG5cdCAgICAgICAgaWYgKHRoaXMuX2VuYWJsZVNldERhdGVCeUVudGVyS2V5KSB7XG5cdCAgICAgICAgICAgICR0YXJnZXRFbC5vbigna2V5ZG93bicsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25LZXlkb3duRWxlbWVudCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFVuYmluZCBrZXlkb3duIGV2ZW50IGhhbmRsZXIgZnJvbSB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkdGFyZ2V0RWwgLSB0YXJnZXQgZWxlbWVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3VuYmluZEtleWRvd25FdmVudDogZnVuY3Rpb24oJHRhcmdldEVsKSB7XG5cdCAgICAgICAgaWYgKHRoaXMuX2VuYWJsZVNldERhdGVCeUVudGVyS2V5KSB7XG5cdCAgICAgICAgICAgICR0YXJnZXRFbC5vZmYoJ2tleWRvd24nLCB0aGlzLl9wcm94eUhhbmRsZXJzLm9uS2V5ZG93bkVsZW1lbnQpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBCaW5kIGEgKG1vdXNlZG93bnx0b3VjaHN0YXJ0KSBldmVudCBvZiBkb2N1bWVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2JpbmRPbk1vdXNlZG93bkRvY3VtZW50OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgZXZlbnRUeXBlID0gKHRoaXMudXNlVG91Y2hFdmVudCkgPyAndG91Y2hzdGFydCcgOiAnbW91c2Vkb3duJztcblx0ICAgICAgICAkKGRvY3VtZW50KS5vbihldmVudFR5cGUsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25Nb3VzZWRvd25Eb2N1bWVudCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogVW5iaW5kIG1vdXNlZG93bix0b3VjaHN0YXJ0IGV2ZW50cyBvZiBkb2N1bWVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3VuYmluZE9uTW91c2Vkb3duRG9jdW1lbnQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICQoZG9jdW1lbnQpLm9mZignbW91c2Vkb3duIHRvdWNoc3RhcnQnLCB0aGlzLl9wcm94eUhhbmRsZXJzLm9uTW91c2Vkb3duRG9jdW1lbnQpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEJpbmQgY2xpY2sgZXZlbnQgb2YgY2FsZW5kYXJcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9iaW5kT25DbGlja0NhbGVuZGFyOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX3Byb3h5SGFuZGxlcnMub25DbGlja0NhbGVuZGFyLFxuXHQgICAgICAgICAgICBldmVudFR5cGUgPSAodGhpcy51c2VUb3VjaEV2ZW50KSA/ICd0b3VjaGVuZCcgOiAnY2xpY2snO1xuXHQgICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5maW5kKCcuJyArIHRoaXMuX3NlbGVjdGFibGVDbGFzc05hbWUpLm9uKGV2ZW50VHlwZSwgaGFuZGxlcik7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogVW5iaW5kIGNsaWNrIGV2ZW50IG9mIGNhbGVuZGFyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfdW5iaW5kT25DbGlja0NhbGVuZGFyOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX3Byb3h5SGFuZGxlcnMub25DbGlja0NhbGVuZGFyO1xuXHQgICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5maW5kKCcuJyArIHRoaXMuX3NlbGVjdGFibGVDbGFzc05hbWUpLm9mZignY2xpY2sgdG91Y2hlbmQnLCBoYW5kbGVyKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBCaW5kIGN1c3RvbSBldmVudCBvZiBjYWxlbmRhclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2JpbmRDYWxlbmRhckN1c3RvbUV2ZW50OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgcHJveHlIYW5kbGVycyA9IHRoaXMuX3Byb3h5SGFuZGxlcnMsXG5cdCAgICAgICAgICAgIG9uQmVmb3JlRHJhdyA9IHByb3h5SGFuZGxlcnMub25CZWZvcmVEcmF3Q2FsZW5kYXIsXG5cdCAgICAgICAgICAgIG9uRHJhdyA9IHByb3h5SGFuZGxlcnMub25EcmF3Q2FsZW5kYXIsXG5cdCAgICAgICAgICAgIG9uQWZ0ZXJEcmF3ID0gcHJveHlIYW5kbGVycy5vbkFmdGVyRHJhd0NhbGVuZGFyO1xuXHRcblx0ICAgICAgICB0aGlzLl9jYWxlbmRhci5vbih7XG5cdCAgICAgICAgICAgICdiZWZvcmVEcmF3Jzogb25CZWZvcmVEcmF3LFxuXHQgICAgICAgICAgICAnZHJhdyc6IG9uRHJhdyxcblx0ICAgICAgICAgICAgJ2FmdGVyRHJhdyc6IG9uQWZ0ZXJEcmF3XG5cdCAgICAgICAgfSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogVW5iaW5kIGN1c3RvbSBldmVudCBvZiBjYWxlbmRhclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3VuYmluZENhbGVuZGFyQ3VzdG9tRXZlbnQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBwcm94eUhhbmRsZXJzID0gdGhpcy5fcHJveHlIYW5kbGVycyxcblx0ICAgICAgICAgICAgb25CZWZvcmVEcmF3ID0gcHJveHlIYW5kbGVycy5vbkJlZm9yZURyYXdDYWxlbmRhcixcblx0ICAgICAgICAgICAgb25EcmF3ID0gcHJveHlIYW5kbGVycy5vbkRyYXdDYWxlbmRhcixcblx0ICAgICAgICAgICAgb25BZnRlckRyYXcgPSBwcm94eUhhbmRsZXJzLm9uQWZ0ZXJEcmF3Q2FsZW5kYXI7XG5cdFxuXHQgICAgICAgIHRoaXMuX2NhbGVuZGFyLm9mZih7XG5cdCAgICAgICAgICAgICdiZWZvcmVEcmF3Jzogb25CZWZvcmVEcmF3LFxuXHQgICAgICAgICAgICAnZHJhdyc6IG9uRHJhdyxcblx0ICAgICAgICAgICAgJ2FmdGVyRHJhdyc6IG9uQWZ0ZXJEcmF3XG5cdCAgICAgICAgfSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQmluZCBjbGljayBldmVudCBvZiBvcGVuZXJcblx0ICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBlbGVtZW50IC0gT3BlbmVyIGVsZW1lbnRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9iaW5kT25DbGlja09wZW5lcjogZnVuY3Rpb24oZWxlbWVudCkge1xuXHQgICAgICAgIHZhciBldmVudFR5cGUgPSAodGhpcy51c2VUb3VjaEV2ZW50KSA/ICd0b3VjaGVuZCcgOiAnY2xpY2snO1xuXHQgICAgICAgICQoZWxlbWVudCkub24oZXZlbnRUeXBlLCB0aGlzLl9wcm94eUhhbmRsZXJzLm9uQ2xpY2tPcGVuZXIpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFVuYmluZCBjbGljayBldmVudCBvZiBvcGVuZXJcblx0ICAgICAqIEBwYXJhbSB7alF1ZXJ5fSBlbGVtZW50IC0gT3BlbmVyIGVsZW1lbnRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF91bmJpbmRPbkNsaWNrT3BlbmVyOiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdCAgICAgICAgdmFyIGV2ZW50VHlwZSA9ICh0aGlzLnVzZVRvdWNoRXZlbnQpID8gJ3RvdWNoZW5kJyA6ICdjbGljayc7XG5cdCAgICAgICAgJChlbGVtZW50KS5vbihldmVudFR5cGUsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25DbGlja09wZW5lcik7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IGN1cnJlbnQgbGF5ZXIgdHlwZVxuXHQgICAgICogQHJldHVybnMge3N0cmluZ31cblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9nZXRDdXJyZW50TGF5ZXI6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiBsYXllcnNbdGhpcy5fc2hvd25MYXllcklkeF07XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogV2hldGhlciB0aGUgbGF5ZXItdHlwZSBzaG91bGQgYmUgc2hvd24uXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIGxheWVyIHR5cGUgKFlFQVJfTEFZRVIsIE1PTlRIX0xBWUVSLCBEQVRFX0xBWUVSKVxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2hvdWxkU2hvd0xheWVyOiBmdW5jdGlvbih0eXBlKSB7XG5cdCAgICAgICAgdmFyIG1hdGNoZWRMYXllcnMgPSB0aGlzLl9kYXRlRm9ybWF0Lm1hdGNoKGZvcm1hdFJlZ0V4cCk7XG5cdCAgICAgICAgdmFyIGZ1bmN0b3IgPSBmdW5jdGlvbih2YWwpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG1hdGNoZWRMYXllcnMuaW5kZXhPZih2YWwpID4gLTE7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB2YXIgY2FuZGlkYXRlcztcblx0XG5cdCAgICAgICAgc3dpdGNoICh0eXBlKSB7XG5cdCAgICAgICAgICAgIGNhc2UgREFURV9MQVlFUjpcblx0ICAgICAgICAgICAgICAgIGNhbmRpZGF0ZXMgPSBkYXRlS2V5cztcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBjYXNlIE1PTlRIX0xBWUVSOlxuXHQgICAgICAgICAgICAgICAgY2FuZGlkYXRlcyA9IG1vbnRoS2V5cztcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBjYXNlIFlFQVJfTEFZRVI6XG5cdCAgICAgICAgICAgICAgICBjYW5kaWRhdGVzID0geWVhcktleXM7XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgZGVmYXVsdDpcblx0ICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiAhIXV0aWwuZmlsdGVyKGNhbmRpZGF0ZXMsIGZ1bmN0b3IpLmxlbmd0aDtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgc2hvd24gbGF5ZXIgYnkgZm9ybWF0XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0U2hvd25MYXllckluZGV4QnlGb3JtOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgbGF5ZXJJZHggPSAwO1xuXHRcblx0ICAgICAgICBpZiAodGhpcy5fc2hvdWxkU2hvd0xheWVyKFlFQVJfTEFZRVIpKSB7XG5cdCAgICAgICAgICAgIGxheWVySWR4ID0gbGF5ZXJzLmluZGV4T2YoWUVBUl9MQVlFUik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICh0aGlzLl9zaG91bGRTaG93TGF5ZXIoTU9OVEhfTEFZRVIpKSB7XG5cdCAgICAgICAgICAgIGxheWVySWR4ID0gbGF5ZXJzLmluZGV4T2YoTU9OVEhfTEFZRVIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAodGhpcy5fc2hvdWxkU2hvd0xheWVyKERBVEVfTEFZRVIpKSB7XG5cdCAgICAgICAgICAgIGxheWVySWR4ID0gbGF5ZXJzLmluZGV4T2YoREFURV9MQVlFUik7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLl9zaG93bkxheWVySWR4ID0gbGF5ZXJJZHg7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IGhhc2ggZGF0ZSBpbiByYW5nZVxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IHN0YXJ0SGFzaCAtIFN0YXJ0IGRhdGVcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbmRIYXNoIC0gRW5kIGRhdGVcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXRIYXNoSW5SYW5nZTogZnVuY3Rpb24oc3RhcnRIYXNoLCBlbmRIYXNoKSB7XG5cdCAgICAgICAgc3RhcnRIYXNoLm1vbnRoID0gc3RhcnRIYXNoLm1vbnRoIHx8IDE7XG5cdCAgICAgICAgZW5kSGFzaC5tb250aCA9IGVuZEhhc2gubW9udGggfHwgMTI7XG5cdFxuXHQgICAgICAgIHN0YXJ0SGFzaC5kYXRlID0gc3RhcnRIYXNoLmRhdGUgfHwgMTtcblx0ICAgICAgICBlbmRIYXNoLmRhdGUgPSBlbmRIYXNoLmRhdGUgfHwgZGF0ZVV0aWwuZ2V0TGFzdERheUluTW9udGgoZW5kSGFzaC55ZWFyLCBlbmRIYXNoLm1vbnRoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgZGlmZmVyZW5jZSBzdGFydCB0byBlbmQgdGltZVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFRpbWUgZGlmZmVyZW5jZSB2YWx1ZVxuXHQgICAgICovXG5cdCAgICBfZ2V0RGlmZlRpbWU6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBzaG93bkxheWVySWR4ID0gdGhpcy5fY2FsZW5kYXIuc2hvd25MYXllcklkeDtcblx0ICAgICAgICB2YXIgc2hvd25EYXRlSGFzaCA9IHRoaXMuX2NhbGVuZGFyLmdldERhdGUoKTtcblx0ICAgICAgICB2YXIgc2hvd25EYXRlID0gbmV3IERhdGUoc2hvd25EYXRlSGFzaC55ZWFyLCBzaG93bkRhdGVIYXNoLm1vbnRoIC0gMSk7XG5cdCAgICAgICAgdmFyIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHRoaXMuX3N0YXJ0VGltZXNbMF0gfHwgTUlOX0VER0UpLnNldERhdGUoMSk7XG5cdCAgICAgICAgdmFyIGVuZERhdGUgPSBuZXcgRGF0ZSh0aGlzLl9lbmRUaW1lcy5zbGljZSgtMSlbMF0gfHwgTUFYX0VER0UpLnNldERhdGUoMSk7XG5cdCAgICAgICAgdmFyIHllYXJSYW5nZSwgc2hvd25TdGFydERhdGUsIHNob3duRW5kRGF0ZSwgc3RhcnREaWZmZXJlbmNlLCBlbmREaWZmZXJlbmNlO1xuXHRcblx0ICAgICAgICBpZiAoc2hvd25MYXllcklkeCA9PT0gMCkge1xuXHQgICAgICAgICAgICBzdGFydERpZmZlcmVuY2UgPSBzaG93bkRhdGUgLSBzdGFydERhdGU7XG5cdCAgICAgICAgICAgIGVuZERpZmZlcmVuY2UgPSBlbmREYXRlIC0gc2hvd25EYXRlO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoc2hvd25MYXllcklkeCA9PT0gMSkge1xuXHQgICAgICAgICAgICBzaG93blN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHNob3duRGF0ZSkuc2V0TW9udGgoMCk7XG5cdCAgICAgICAgICAgIHNob3duRW5kRGF0ZSA9IG5ldyBEYXRlKHNob3duRGF0ZSkuc2V0TW9udGgoMTEpO1xuXHRcblx0ICAgICAgICAgICAgc3RhcnREaWZmZXJlbmNlID0gc2hvd25TdGFydERhdGUgLSBzdGFydERhdGU7XG5cdCAgICAgICAgICAgIGVuZERpZmZlcmVuY2UgPSBlbmREYXRlIC0gc2hvd25FbmREYXRlO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoc2hvd25MYXllcklkeCA9PT0gMikge1xuXHQgICAgICAgICAgICB5ZWFyUmFuZ2UgPSB0aGlzLl9jYWxlbmRhci5fZ2V0SW5mb09mWWVhclJhbmdlKHNob3duRGF0ZUhhc2gueWVhcik7XG5cdCAgICAgICAgICAgIHNob3duU3RhcnREYXRlID0gTnVtYmVyKG5ldyBEYXRlKHllYXJSYW5nZS5zdGFydFllYXIsIDApKTtcblx0ICAgICAgICAgICAgc2hvd25FbmREYXRlID0gTnVtYmVyKG5ldyBEYXRlKHllYXJSYW5nZS5lbmRZZWFyLCAwKSk7XG5cdFxuXHQgICAgICAgICAgICBzdGFydERhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpLnNldE1vbnRoKDApO1xuXHQgICAgICAgICAgICBlbmREYXRlID0gbmV3IERhdGUoZW5kRGF0ZSkuc2V0TW9udGgoMCk7XG5cdFxuXHQgICAgICAgICAgICBzdGFydERpZmZlcmVuY2UgPSBzaG93blN0YXJ0RGF0ZSAtIHN0YXJ0RGF0ZTtcblx0ICAgICAgICAgICAgZW5kRGlmZmVyZW5jZSA9IGVuZERhdGUgLSBzaG93bkVuZERhdGU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBzdGFydDogc3RhcnREaWZmZXJlbmNlLFxuXHQgICAgICAgICAgICBlbmQ6IGVuZERpZmZlcmVuY2Vcblx0ICAgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEFkZCBhIHJhbmdlXG5cdCAgICAgKiBAcGFyYW0ge2RhdGVIYXNofSBzdGFydEhhc2ggLSBTdGFydCBkYXRlSGFzaFxuXHQgICAgICogQHBhcmFtIHtkYXRlSGFzaH0gZW5kSGFzaCAtIEVuZCBkYXRlSGFzaFxuXHQgICAgICogQHNpbmNlIDEuMi4wXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogdmFyIHN0YXJ0ID0ge3llYXI6IDIwMTUsIG1vbnRoOiAyLCBkYXRlOiAzfSxcblx0ICAgICAqICAgICBlbmQgPSB7eWVhcjogMjAxNSwgbW9udGg6IDMsIGRhdGU6IDZ9O1xuXHQgICAgICpcblx0ICAgICAqIGRhdGVwaWNrZXIuYWRkUmFuZ2Uoc3RhcnQsIGVuZCk7XG5cdCAgICAgKi9cblx0ICAgIGFkZFJhbmdlOiBmdW5jdGlvbihzdGFydEhhc2gsIGVuZEhhc2gpIHtcblx0ICAgICAgICBzdGFydEhhc2ggPSBleHRlbmQoe30sIHN0YXJ0SGFzaCk7XG5cdCAgICAgICAgZW5kSGFzaCA9IGV4dGVuZCh7fSwgZW5kSGFzaCk7XG5cdFxuXHQgICAgICAgIHRoaXMuX3NldEhhc2hJblJhbmdlKHN0YXJ0SGFzaCwgZW5kSGFzaCk7XG5cdFxuXHQgICAgICAgIGlmICh0aGlzLl9pc1ZhbGlkRGF0ZUhhc2goc3RhcnRIYXNoKSAmJiB0aGlzLl9pc1ZhbGlkRGF0ZUhhc2goZW5kSGFzaCkpIHtcblx0ICAgICAgICAgICAgdGhpcy5fcmFuZ2VzLnB1c2goW3N0YXJ0SGFzaCwgZW5kSGFzaF0pO1xuXHQgICAgICAgICAgICB0aGlzLl9zZXRTZWxlY3RhYmxlUmFuZ2VzKCk7XG5cdCAgICAgICAgICAgIHRoaXMuX2NhbGVuZGFyLmRyYXcoMCwgMCwgZmFsc2UsIHRoaXMuX3Nob3duTGF5ZXJJZHgpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZW1vdmUgYSByYW5nZVxuXHQgICAgICogQHBhcmFtIHtkYXRlSGFzaH0gc3RhcnRIYXNoIC0gU3RhcnQgZGF0ZUhhc2hcblx0ICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGVuZEhhc2ggLSBFbmQgZGF0ZUhhc2hcblx0ICAgICAqIEBzaW5jZSAxLjIuMFxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqIHZhciBzdGFydCA9IHt5ZWFyOiAyMDE1LCBtb250aDogMiwgZGF0ZTogM30sXG5cdCAgICAgKiAgICAgZW5kID0ge3llYXI6IDIwMTUsIG1vbnRoOiAzLCBkYXRlOiA2fTtcblx0ICAgICAqXG5cdCAgICAgKiBkYXRlcGlja2VyLmFkZFJhbmdlKHN0YXJ0LCBlbmQpO1xuXHQgICAgICogZGF0ZXBpY2tlci5yZW1vdmVSYW5nZShzdGFydCwgZW5kKTtcblx0ICAgICAqL1xuXHQgICAgcmVtb3ZlUmFuZ2U6IGZ1bmN0aW9uKHN0YXJ0SGFzaCwgZW5kSGFzaCkge1xuXHQgICAgICAgIHZhciByYW5nZXMgPSB0aGlzLl9yYW5nZXM7XG5cdCAgICAgICAgdmFyIGkgPSAwO1xuXHQgICAgICAgIHZhciBsZW4gPSByYW5nZXMubGVuZ3RoO1xuXHQgICAgICAgIHZhciB0YXJnZXQ7XG5cdFxuXHQgICAgICAgIHN0YXJ0SGFzaCA9IGV4dGVuZCh7fSwgc3RhcnRIYXNoKTtcblx0ICAgICAgICBlbmRIYXNoID0gZXh0ZW5kKHt9LCBlbmRIYXNoKTtcblx0XG5cdCAgICAgICAgdGhpcy5fc2V0SGFzaEluUmFuZ2Uoc3RhcnRIYXNoLCBlbmRIYXNoKTtcblx0XG5cdCAgICAgICAgdGFyZ2V0ID0gW3N0YXJ0SGFzaCwgZW5kSGFzaF07XG5cdFxuXHQgICAgICAgIGZvciAoOyBpIDwgbGVuOyBpICs9IDEpIHtcblx0ICAgICAgICAgICAgaWYgKGNvbXBhcmVKU09OKHRhcmdldCwgcmFuZ2VzW2ldKSkge1xuXHQgICAgICAgICAgICAgICAgcmFuZ2VzLnNwbGljZShpLCAxKTtcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLl9zZXRTZWxlY3RhYmxlUmFuZ2VzKCk7XG5cdCAgICAgICAgdGhpcy5fY2FsZW5kYXIuZHJhdygwLCAwLCBmYWxzZSwgdGhpcy5fc2hvd25MYXllcklkeCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IHNlbGVjdGFibGUgcmFuZ2VzXG5cdCAgICAgKiBAcGFyYW0ge0FycmF5LjxBcnJheS48ZGF0ZUhhc2g+Pn0gcmFuZ2VzIC0gVGhlIHNhbWUgd2l0aCB0aGUgc2VsZWN0YWJsZVJhbmdlcyBvcHRpb24gdmFsdWVzXG5cdCAgICAgKiBAc2luY2UgMS4zLjBcblx0ICAgICAqL1xuXHQgICAgc2V0UmFuZ2VzOiBmdW5jdGlvbihyYW5nZXMpIHtcblx0ICAgICAgICB0aGlzLl9yYW5nZXMgPSB0aGlzLl9maWx0ZXJWYWxpZFJhbmdlcyhyYW5nZXMpO1xuXHQgICAgICAgIHRoaXMuX3NldFNlbGVjdGFibGVSYW5nZXMoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgcG9zaXRpb24tbGVmdCwgdG9wIG9mIGNhbGVuZGFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geCAtIHBvc2l0aW9uLWxlZnRcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gcG9zaXRpb24tdG9wXG5cdCAgICAgKiBAc2luY2UgMS4xLjFcblx0ICAgICAqL1xuXHQgICAgc2V0WFk6IGZ1bmN0aW9uKHgsIHkpIHtcblx0ICAgICAgICB2YXIgcG9zID0gdGhpcy5fcG9zO1xuXHRcblx0ICAgICAgICBwb3MubGVmdCA9IGlzTnVtYmVyKHgpID8geCA6IHBvcy5sZWZ0O1xuXHQgICAgICAgIHBvcy50b3AgPSBpc051bWJlcih5KSA/IHkgOiBwb3MudG9wO1xuXHQgICAgICAgIHRoaXMuX2FycmFuZ2VMYXllcigpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCB6LWluZGV4IG9mIGNhbGVuZGFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gekluZGV4IC0gei1pbmRleCB2YWx1ZVxuXHQgICAgICogQHNpbmNlIDEuMS4xXG5cdCAgICAgKi9cblx0ICAgIHNldFpJbmRleDogZnVuY3Rpb24oekluZGV4KSB7XG5cdCAgICAgICAgaWYgKCFpc051bWJlcih6SW5kZXgpKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMuX3Bvcy56SW5kZXggPSB6SW5kZXg7XG5cdCAgICAgICAgdGhpcy5fYXJyYW5nZUxheWVyKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogYWRkIG9wZW5lclxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxqUXVlcnl8c3RyaW5nfSBvcGVuZXIgLSBlbGVtZW50IG9yIHNlbGVjdG9yXG5cdCAgICAgKi9cblx0ICAgIGFkZE9wZW5lcjogZnVuY3Rpb24ob3BlbmVyKSB7XG5cdCAgICAgICAgdmFyIGV2ZW50VHlwZSA9ICh0aGlzLnVzZVRvdWNoRXZlbnQpID8gJ3RvdWNoZW5kJyA6ICdjbGljaycsXG5cdCAgICAgICAgICAgICRvcGVuZXIgPSAkKG9wZW5lcik7XG5cdFxuXHQgICAgICAgIG9wZW5lciA9ICRvcGVuZXJbMF07XG5cdCAgICAgICAgaWYgKG9wZW5lciAmJiBpbkFycmF5KG9wZW5lciwgdGhpcy5fb3BlbmVycykgPCAwKSB7XG5cdCAgICAgICAgICAgIHRoaXMuX29wZW5lcnMucHVzaChvcGVuZXIpO1xuXHQgICAgICAgICAgICAkb3BlbmVyLm9uKGV2ZW50VHlwZSwgdGhpcy5fcHJveHlIYW5kbGVycy5vbkNsaWNrT3BlbmVyKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogcmVtb3ZlIG9wZW5lclxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxqUXVlcnl8c3RyaW5nfSBvcGVuZXIgLSBlbGVtZW50IG9yIHNlbGVjdG9yXG5cdCAgICAgKi9cblx0ICAgIHJlbW92ZU9wZW5lcjogZnVuY3Rpb24ob3BlbmVyKSB7XG5cdCAgICAgICAgdmFyICRvcGVuZXIgPSAkKG9wZW5lciksXG5cdCAgICAgICAgICAgIGluZGV4ID0gaW5BcnJheSgkb3BlbmVyWzBdLCB0aGlzLl9vcGVuZXJzKTtcblx0XG5cdCAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcblx0ICAgICAgICAgICAgJG9wZW5lci5vZmYoJ2NsaWNrIHRvdWNoZW5kJywgdGhpcy5fcHJveHlIYW5kbGVycy5vbkNsaWNrT3BlbmVyKTtcblx0ICAgICAgICAgICAgdGhpcy5fb3BlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBPcGVuIGNhbGVuZGFyIHdpdGggYXJyYW5naW5nIHBvc2l0aW9uXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogZGF0ZXBpY2tlci5vcGVuKCk7XG5cdCAgICAgKi9cblx0ICAgIG9wZW46IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBkYXRlO1xuXHRcblx0ICAgICAgICBpZiAodGhpcy5pc09wZW5lZCgpIHx8ICF0aGlzLl9lbmFibGVkU3RhdGUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZGF0ZSA9IHRoaXMuX2RhdGUgfHwgZGF0ZVV0aWwuZ2V0VG9kYXkoKTtcblx0XG5cdCAgICAgICAgdGhpcy5fYXJyYW5nZUxheWVyKCk7XG5cdCAgICAgICAgdGhpcy5fYmluZENhbGVuZGFyQ3VzdG9tRXZlbnQoKTtcblx0ICAgICAgICB0aGlzLl9jYWxlbmRhci5kcmF3KGRhdGUueWVhciwgZGF0ZS5tb250aCwgZmFsc2UsIHRoaXMuX3Nob3duTGF5ZXJJZHgpO1xuXHQgICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5zaG93KCk7XG5cdCAgICAgICAgaWYgKCF0aGlzLnNob3dBbHdheXMpIHtcblx0ICAgICAgICAgICAgdGhpcy5fYmluZE9uTW91c2Vkb3duRG9jdW1lbnQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEBldmVudCBEYXRlUGlja2VyI29wZW5cblx0ICAgICAgICAgKiBAZXhhbXBsZVxuXHQgICAgICAgICAqIGRhdGVQaWNrZXIub24oJ29wZW4nLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgKiAgICAgYWxlcnQoJ29wZW4nKTtcblx0ICAgICAgICAgKiB9KTtcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLmZpcmUoJ29wZW4nKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDbG9zZSBjYWxlbmRhciB3aXRoIHVuYmluZGluZyBzb21lIGV2ZW50c1xuXHQgICAgICogQGV4bWFwbGVcblx0ICAgICAqIGRhdGVwaWNrZXIuY2xvc2UoKTtcblx0ICAgICAqL1xuXHQgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc09wZW5lZCgpKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5fdW5iaW5kQ2FsZW5kYXJDdXN0b21FdmVudCgpO1xuXHQgICAgICAgIHRoaXMuX3VuYmluZE9uTW91c2Vkb3duRG9jdW1lbnQoKTtcblx0ICAgICAgICB0aGlzLl8kd3JhcHBlckVsZW1lbnQuaGlkZSgpO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBDbG9zZSBldmVudCAtIERhdGVQaWNrZXJcblx0ICAgICAgICAgKiBAZXZlbnQgRGF0ZVBpY2tlciNjbG9zZVxuXHQgICAgICAgICAqIEBleGFtcGxlXG5cdCAgICAgICAgICogZGF0ZVBpY2tlci5vbignY2xvc2UnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgKiAgICAgYWxlcnQoJ2Nsb3NlJyk7XG5cdCAgICAgICAgICogfSk7XG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5maXJlKCdjbG9zZScpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdldCBkYXRlLW9iamVjdCBvZiBjdXJyZW50IERhdGVQaWNrZXIgaW5zdGFuY2UuXG5cdCAgICAgKiBAcmV0dXJucyB7P2RhdGVIYXNofSAtIGRhdGVIYXNoIGhhdmluZyB5ZWFyLCBtb250aCBhbmQgZGF5LWluLW1vbnRoXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogLy8gMjAxNS0wNC0xM1xuXHQgICAgICogZGF0ZXBpY2tlci5nZXREYXRlSGFzaCgpOyAvLyB7eWVhcjogMjAxNSwgbW9udGg6IDQsIGRhdGU6IDEzfVxuXHQgICAgICovXG5cdCAgICBnZXREYXRlSGFzaDogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGRhdGVIYXNoLCBkZXB0aElkeDtcblx0XG5cdCAgICAgICAgaWYgKCF0aGlzLl9kYXRlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZGF0ZUhhc2ggPSB7fTtcblx0ICAgICAgICBkZXB0aElkeCA9IHRoaXMuX3Nob3duTGF5ZXJJZHg7XG5cdFxuXHQgICAgICAgIGV4dGVuZChkYXRlSGFzaCwgdGhpcy5fZGF0ZSk7XG5cdFxuXHQgICAgICAgIGlmIChkZXB0aElkeCA+IDEpIHtcblx0ICAgICAgICAgICAgZGVsZXRlIGRhdGVIYXNoLm1vbnRoO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKGRlcHRoSWR4ID4gMCkge1xuXHQgICAgICAgICAgICBkZWxldGUgZGF0ZUhhc2guZGF0ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBkYXRlSGFzaDtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm4geWVhclxuXHQgICAgICogQHJldHVybnMge251bWJlcn0gLSB5ZWFyXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogLy8gMjAxNS0wNC0xM1xuXHQgICAgICogZGF0ZXBpY2tlci5nZXRZZWFyKCk7IC8vIDIwMTVcblx0ICAgICAqL1xuXHQgICAgZ2V0WWVhcjogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGUueWVhcjtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm4gbW9udGhcblx0ICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IC0gbW9udGhcblx0ICAgICAqIEBleGFtcGxlXG5cdCAgICAgKiAvLyAyMDE1LTA0LTEzXG5cdCAgICAgKiBkYXRlcGlja2VyLmdldE1vbnRoKCk7IC8vIDRcblx0ICAgICAqL1xuXHQgICAgZ2V0TW9udGg6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLl9kYXRlLm1vbnRoO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybiBkYXktaW4tbW9udGhcblx0ICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IC0gZGF5LWluLW1vbnRoXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogLy8gMjAxNS0wNC0xM1xuXHQgICAgICogZGF0ZXBpY2tlci5nZXREYXlJbk1vbnRoKCk7IC8vIDEzXG5cdCAgICAgKi9cblx0ICAgIGdldERheUluTW9udGg6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLl9kYXRlLmRhdGU7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IGRhdGUgZnJvbSB2YWx1ZXMoeWVhciwgbW9udGgsIGRhdGUpIGFuZCB0aGVuIGZpcmUgJ3VwZGF0ZScgY3VzdG9tIGV2ZW50XG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IFt5ZWFyXSAtIHllYXJcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gW21vbnRoXSAtIG1vbnRoXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IFtkYXRlXSAtIGRheSBpbiBtb250aFxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqIGRhdGVwaWNrZXIuc2V0RGF0ZSgyMDE0LCAxMiwgMyk7IC8vIDIwMTQtMTItIDAzXG5cdCAgICAgKiBkYXRlcGlja2VyLnNldERhdGUobnVsbCwgMTEsIDIzKTsgLy8gMjAxNC0xMS0yM1xuXHQgICAgICogZGF0ZXBpY2tlci5zZXREYXRlKCcyMDE1JywgJzUnLCAzKTsgLy8gMjAxNS0wNS0wM1xuXHQgICAgICogZGF0ZXBpY2tlci5zZXREYXRlKDIwMTYsIDEwKTsgLy8gMjAxNi0xMFxuXHQgICAgICogZGF0ZXBpY2tlci5zZXREYXRlKDIwMTcpOyAvLyAyMDE3XG5cdCAgICAgKi9cblx0ICAgIHNldERhdGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlKSB7XG5cdCAgICAgICAgdmFyIGRhdGVPYmogPSB0aGlzLl9kYXRlIHx8IGRhdGVVdGlsLmdldFRvZGF5KCk7XG5cdCAgICAgICAgdmFyIHByZXZEYXRlT2JqID0gZXh0ZW5kKHt9LCB0aGlzLl9kYXRlKTtcblx0ICAgICAgICB2YXIgY3VycmVudExheWVyID0gdGhpcy5fZ2V0Q3VycmVudExheWVyKCk7XG5cdCAgICAgICAgdmFyIG5ld0RhdGVPYmogPSB7XG5cdCAgICAgICAgICAgIHllYXI6IHllYXIgfHwgZGF0ZU9iai55ZWFyLFxuXHQgICAgICAgICAgICBtb250aDogbW9udGggfHwgZGF0ZU9iai5tb250aCxcblx0ICAgICAgICAgICAgZGF0ZTogZGF0ZSB8fCBkYXRlT2JqLmRhdGVcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHZhciBzaG91bGRVcGRhdGUgPSAoXG5cdCAgICAgICAgICAgIHRoaXMuX2lzU2VsZWN0YWJsZShuZXdEYXRlT2JqLCBjdXJyZW50TGF5ZXIpXG5cdCAgICAgICAgICAgICYmICFkYXRlVXRpbC5pc0VxdWFsRGF0ZUhhc2gocHJldkRhdGVPYmosIG5ld0RhdGVPYmopXG5cdCAgICAgICAgKTtcblx0XG5cdCAgICAgICAgaWYgKHNob3VsZFVwZGF0ZSkge1xuXHQgICAgICAgICAgICB0aGlzLl9kYXRlID0gbmV3RGF0ZU9iajtcblx0ICAgICAgICAgICAgdGhpcy5fc2V0VmFsdWVUb0lucHV0RWxlbWVudCgpO1xuXHQgICAgICAgICAgICB0aGlzLl9jYWxlbmRhci5kcmF3KG5ld0RhdGVPYmoueWVhciwgbmV3RGF0ZU9iai5tb250aCwgZmFsc2UsIGN1cnJlbnRMYXllcik7XG5cdCAgICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICAgKiBVcGRhdGUgZXZlbnRcblx0ICAgICAgICAgICAgICogQGV2ZW50IERhdGVQaWNrZXIjdXBkYXRlXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLmZpcmUoJ3VwZGF0ZScpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHRoaXMuX3NldFZhbHVlVG9JbnB1dEVsZW1lbnQoKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IG9yIHVwZGF0ZSBkYXRlLWZvcm1cblx0ICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbZm9ybWF0XSAtIGRhdGUtZm9ybWF0XG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogZGF0ZXBpY2tlci5zZXREYXRlRm9ybSgneXl5eS1tbS1kZCcpO1xuXHQgICAgICogZGF0ZXBpY2tlci5zZXREYXRlRm9ybSgnbW0tZGQsIHl5eXknKTtcblx0ICAgICAqIGRhdGVwaWNrZXIuc2V0RGF0ZUZvcm0oJ3kvbS9kJyk7XG5cdCAgICAgKiBkYXRlcGlja2VyLnNldERhdGVGb3JtKCd5eS9tbS9kZCcpO1xuXHQgICAgICovXG5cdCAgICBzZXREYXRlRm9ybTogZnVuY3Rpb24oZm9ybWF0KSB7XG5cdCAgICAgICAgdGhpcy5fZGF0ZUZvcm1hdCA9IGZvcm1hdCB8fCB0aGlzLl9kYXRlRm9ybWF0O1xuXHRcblx0ICAgICAgICB0aGlzLl9zZXRTaG93bkxheWVySW5kZXhCeUZvcm0oKTtcblx0ICAgICAgICB0aGlzLl9zZXRSZWdFeHAoKTtcblx0ICAgICAgICBpZiAodGhpcy5fZGF0ZSkge1xuXHQgICAgICAgICAgICB0aGlzLnNldERhdGUoKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJuIHdoZXRoZXIgdGhlIGNhbGVuZGFyIGlzIG9wZW5lZCBvciBub3Rcblx0ICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIHRydWUgaWYgb3BlbmVkLCBmYWxzZSBvdGhlcndpc2Vcblx0ICAgICAqIEBleGFtcGxlXG5cdCAgICAgKiBkYXRlcGlja2VyLmNsb3NlKCk7XG5cdCAgICAgKiBkYXRlcGlja2VyLmlzT3BlbmVkKCk7IC8vIGZhbHNlXG5cdCAgICAgKlxuXHQgICAgICogZGF0ZXBpY2tlci5vcGVuKCk7XG5cdCAgICAgKiBkYXRlcGlja2VyLmlzT3BlbmVkKCk7IC8vIHRydWVcblx0ICAgICAqL1xuXHQgICAgaXNPcGVuZWQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiAodGhpcy5fJHdyYXBwZXJFbGVtZW50LmNzcygnZGlzcGxheScpID09PSAnYmxvY2snKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm4gVGltZVBpY2tlciBpbnN0YW5jZVxuXHQgICAgICogQHJldHVybnMge1RpbWVQaWNrZXJ9IC0gVGltZVBpY2tlciBpbnN0YW5jZVxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqIHZhciB0aW1lcGlja2VyID0gdGhpcy5nZXRUaW1lcGlja2VyKCk7XG5cdCAgICAgKi9cblx0ICAgIGdldFRpbWVQaWNrZXI6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLl90aW1lUGlja2VyO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBpbnB1dCBlbGVtZW50IG9mIHRoaXMgaW5zdGFuY2Vcblx0ICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBlbGVtZW50IC0gaW5wdXQgZWxlbWVudFxuXHQgICAgICogQHNpbmNlIDEuMy4wXG5cdCAgICAgKi9cblx0ICAgIHNldEVsZW1lbnQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgICAgICB2YXIgJGN1cnJlbnRFbCA9IHRoaXMuXyRlbGVtZW50O1xuXHQgICAgICAgIHZhciAkbmV3RWwgPSAkKGVsZW1lbnQpO1xuXHRcblx0ICAgICAgICBpZiAoJGN1cnJlbnRFbFswXSkge1xuXHQgICAgICAgICAgICB0aGlzLnJlbW92ZU9wZW5lcigkY3VycmVudEVsKTtcblx0ICAgICAgICAgICAgdGhpcy5fdW5iaW5kS2V5ZG93bkV2ZW50KCRjdXJyZW50RWwpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5hZGRPcGVuZXIoJG5ld0VsKTtcblx0ICAgICAgICB0aGlzLl9iaW5kS2V5ZG93bkV2ZW50KCRuZXdFbCk7XG5cdCAgICAgICAgdGhpcy5fc2V0RGF0ZUZyb21TdHJpbmcoJG5ld0VsLnZhbCgpKTtcblx0ICAgICAgICB0aGlzLl8kZWxlbWVudCA9ICRuZXdFbDtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFbmFibGUgcGlja2VyXG5cdCAgICAgKiBAc2luY2UgMS40LjBcblx0ICAgICAqIEBleGFtcGxlXG5cdCAgICAgKiBkYXRlcGlja2VyLmRpc2FibGUoKTtcblx0ICAgICAqIGRhdGVwaWNrZXIuZW5hYmxlKCk7XG5cdCAgICAgKi9cblx0ICAgIGVuYWJsZTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyICRvcGVuZXJFbDtcblx0XG5cdCAgICAgICAgaWYgKHRoaXMuX2VuYWJsZWRTdGF0ZSkge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuX2VuYWJsZWRTdGF0ZSA9IHRydWU7XG5cdFxuXHQgICAgICAgIGZvckVhY2godGhpcy5fb3BlbmVycywgZnVuY3Rpb24ob3BlbmVyRWwsIGlkeCkge1xuXHQgICAgICAgICAgICAkb3BlbmVyRWwgPSAkKG9wZW5lckVsKTtcblx0ICAgICAgICAgICAgJG9wZW5lckVsLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG5cdCAgICAgICAgICAgICRvcGVuZXJFbC5yZW1vdmVDbGFzcyh0aGlzLl9kaXNhYmxlZENsYXNzTmFtZSk7XG5cdCAgICAgICAgICAgIHRoaXMuX2JpbmRPbkNsaWNrT3BlbmVyKCRvcGVuZXJFbCk7XG5cdFxuXHQgICAgICAgICAgICBpZiAoIWlkeCkge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5fYmluZEtleWRvd25FdmVudCgkb3BlbmVyRWwpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSwgdGhpcyk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRGlzYWJsZSBwaWNrZXJcblx0ICAgICAqIEBzaW5jZSAxLjQuMFxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqIGRhdGVwaWNrZXIuZW5hYmxlKCk7XG5cdCAgICAgKiBkYXRlcGlja2VyLmRpc2FibGUoKTtcblx0ICAgICAqL1xuXHQgICAgZGlzYWJsZTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyICRvcGVuZXJFbDtcblx0XG5cdCAgICAgICAgaWYgKCF0aGlzLl9lbmFibGVkU3RhdGUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5fZW5hYmxlZFN0YXRlID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5jbG9zZSgpO1xuXHRcblx0ICAgICAgICBmb3JFYWNoKHRoaXMuX29wZW5lcnMsIGZ1bmN0aW9uKG9wZW5lckVsLCBpZHgpIHtcblx0ICAgICAgICAgICAgJG9wZW5lckVsID0gJChvcGVuZXJFbCk7XG5cdCAgICAgICAgICAgICRvcGVuZXJFbC5hZGRDbGFzcyh0aGlzLl9kaXNhYmxlZENsYXNzTmFtZSk7XG5cdCAgICAgICAgICAgICRvcGVuZXJFbC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuXHQgICAgICAgICAgICB0aGlzLl91bmJpbmRPbkNsaWNrT3BlbmVyKCRvcGVuZXJFbCk7XG5cdCAgICAgICAgICAgIGlmICghaWR4KSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLl91bmJpbmRLZXlkb3duRXZlbnQoJG9wZW5lckVsKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sIHRoaXMpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERlc3Ryb3kgLSBkZWxldGUgd3JhcHBlciBlbGVtZW50IGFuZCBhdHRhY2ggZXZlbnRzXG5cdCAgICAgKiBAc2luY2UgMS40LjBcblx0ICAgICAqL1xuXHQgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyICRjdXJyZW50RWwgPSB0aGlzLl8kZWxlbWVudDtcblx0XG5cdCAgICAgICAgaWYgKCRjdXJyZW50RWxbMF0pIHtcblx0ICAgICAgICAgICAgdGhpcy5fdW5iaW5kS2V5ZG93bkV2ZW50KCRjdXJyZW50RWwpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5fdW5iaW5kT25Nb3VzZWRvd25Eb2N1bWVudCgpO1xuXHQgICAgICAgIHRoaXMuX3VuYmluZE9uQ2xpY2tDYWxlbmRhcigpO1xuXHQgICAgICAgIHRoaXMuX3VuYmluZENhbGVuZGFyQ3VzdG9tRXZlbnQoKTtcblx0ICAgICAgICB0aGlzLl8kd3JhcHBlckVsZW1lbnQucmVtb3ZlKCk7XG5cdCAgICB9XG5cdH0pO1xuXHRcblx0dXRpbC5DdXN0b21FdmVudHMubWl4aW4oRGF0ZVBpY2tlcik7XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IERhdGVQaWNrZXI7XG5cblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qKlxuXHQgKiBAZmlsZW92ZXJ2aWV3IFRpbWVQaWNrZXIgQ29tcG9uZW50XG5cdCAqIEBhdXRob3IgTkhOIGVudCBGRSBMYWIgPGRsX2phdmFzY3JpcHRAbmhuZW50LmNvbT4gPG1pbmt5dS55aUBuaG5lbnQuY29tPlxuXHQgKiBAZGVwZW5kZW5jeSBqcXVlcnktMS44LjMsIGNvZGUtc25pcHBldC0xLjAuMiwgc3BpbmJveC5qc1xuXHQgKi9cblx0XG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBTcGluYm94ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0dmFyIHV0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdHZhciB1dGlsID0gdHVpLnV0aWw7XG5cdHZhciB0aW1lUmVnRXhwID0gL1xccyooXFxkezEsMn0pXFxzKjpcXHMqKFxcZHsxLDJ9KVxccyooW2FwXVttXSk/KD86W1xcc1xcU10qKS9pO1xuXHR2YXIgdGltZVNlcGVyYXRvciA9IC9cXHMrfDovZztcblx0dmFyIHRpbWVQaWNrZXJUYWcgPSAnPHRhYmxlIGNsYXNzPVwidGltZXBpY2tlclwiPjx0ciBjbGFzcz1cInRpbWVwaWNrZXItcm93XCI+PC90cj48L3RhYmxlPic7XG5cdHZhciBjb2x1bW5UYWcgPSAnPHRkIGNsYXNzPVwidGltZXBpY2tlci1jb2x1bW5cIj48L3RkPic7XG5cdHZhciBzcGluQm94VGFnID0gJzx0ZCBjbGFzcz1cInRpbWVwaWNrZXItY29sdW1uIHRpbWVwaWNrZXItc3BpbmJveFwiPicgK1xuXHQgICAgICAgICAgICAgICAgJzxkaXY+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ0aW1lcGlja2VyLXNwaW5ib3gtaW5wdXRcIj48L2Rpdj48L3RkPic7XG5cdHZhciB1cEJ0blRhZyA9ICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInRpbWVwaWNrZXItYnRuIHRpbWVwaWNrZXItYnRuLXVwXCI+PGI+KzwvYj48L2J1dHRvbj4nO1xuXHR2YXIgZG93bkJ0blRhZyA9ICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInRpbWVwaWNrZXItYnRuIHRpbWVwaWNrZXItYnRuLWRvd25cIj48Yj4tPC9iPjwvYnV0dG9uPic7XG5cdHZhciBtZXJpZGllbVRhZyA9ICc8c2VsZWN0PjxvcHRpb24gdmFsdWU9XCJBTVwiPkFNPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIlBNXCI+UE08L29wdGlvbj48L3NlbGVjdD4nO1xuXHRcblx0LyoqXG5cdCAqIEBjb25zdHJ1Y3RvclxuXHQgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbl0gLSBvcHRpb24gZm9yIGluaXRpYWxpemF0aW9uXG5cdCAqXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9uLmRlZmF1bHRIb3VyID0gMF0gLSBpbml0aWFsIHNldHRpbmcgdmFsdWUgb2YgaG91clxuXHQgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5kZWZhdWx0TWludXRlID0gMF0gLSBpbml0aWFsIHNldHRpbmcgdmFsdWUgb2YgbWludXRlXG5cdCAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IFtvcHRpb24uaW5wdXRFbGVtZW50ID0gbnVsbF0gLSBvcHRpb25hbCBpbnB1dCBlbGVtZW50IHdpdGggdGltZXBpY2tlclxuXHQgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5ob3VyU3RlcCA9IDFdIC0gc3RlcCBvZiBob3VyIHNwaW5ib3guIGlmIHN0ZXAgPSAyLCBob3VyIHZhbHVlIDEgLT4gMyAtPiA1IC0+IC4uLlxuXHQgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5taW51dGVTdGVwID0gMV0gLSBzdGVwIG9mIG1pbnV0ZSBzcGluYm94LiBpZiBzdGVwID0gMiwgbWludXRlIHZhbHVlIDEgLT4gMyAtPiA1IC0+IC4uLlxuXHQgKiBAcGFyYW0ge0FycmF5fSBbb3B0aW9uLmhvdXJFeGNsdXNpb24gPSBudWxsXSAtIGhvdXIgdmFsdWUgdG8gYmUgZXhjbHVkZWQuXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaG91ciBbMSwzXSBpcyBleGNsdWRlZCwgaG91ciB2YWx1ZSAwIC0+IDIgLT4gNCAtPiA1IC0+IC4uLlxuXHQgKiBAcGFyYW0ge0FycmF5fSBbb3B0aW9uLm1pbnV0ZUV4Y2x1c2lvbiA9IG51bGxdIC0gbWludXRlIHZhbHVlIHRvIGJlIGV4Y2x1ZGVkLlxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbWludXRlIFsxLDNdIGlzIGV4Y2x1ZGVkLCBtaW51dGUgdmFsdWUgMCAtPiAyIC0+IDQgLT4gNSAtPiAuLi5cblx0ICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9uLnNob3dNZXJpZGlhbiA9IGZhbHNlXSAtIGlzIHRpbWUgZXhwcmVzc2lvbi1cImhoOm1tIEFNL1BNXCI/XG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uLnBvc2l0aW9uID0ge31dIC0gbGVmdCwgdG9wIHBvc2l0aW9uIG9mIHRpbWVwaWNrZXIgZWxlbWVudFxuXHQgKlxuXHQgKiBAdHV0b3JpYWwgc2FtcGxlM1xuXHQgKi9cblx0dmFyIFRpbWVQaWNrZXIgPSB1dGlsLmRlZmluZUNsYXNzKC8qKiBAbGVuZHMgVGltZVBpY2tlci5wcm90b3R5cGUgKi8ge1xuXHQgICAgaW5pdDogZnVuY3Rpb24ob3B0aW9uKSB7XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLiR0aW1lUGlja2VyRWxlbWVudCA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl8kaW5wdXRFbGVtZW50ID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuXyRtZXJpZGlhbkVsZW1lbnQgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBAdHlwZSB7U3BpbmJveH1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX2hvdXJTcGluYm94ID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHR5cGUge1NwaW5ib3h9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl9taW51dGVTcGluYm94ID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogdGltZSBwaWNrZXIgZWxlbWVudCBzaG93IHVwP1xuXHQgICAgICAgICAqIEB0eXBlIHtib29sZWFufVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5faXNTaG93biA9IGZhbHNlO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBAdHlwZSB7T2JqZWN0fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fb3B0aW9uID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHR5cGUge251bWJlcn1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX2hvdXIgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fbWludXRlID0gbnVsbDtcblx0XG5cdCAgICAgICAgdGhpcy5faW5pdGlhbGl6ZShvcHRpb24pO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEluaXRpYWxpemUgd2l0aCBvcHRpb25cblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb24gZm9yIHRpbWUgcGlja2VyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9uKSB7XG5cdCAgICAgICAgdGhpcy5fc2V0T3B0aW9uKG9wdGlvbik7XG5cdCAgICAgICAgdGhpcy5fbWFrZVNwaW5ib3hlcygpO1xuXHQgICAgICAgIHRoaXMuX21ha2VUaW1lUGlja2VyRWxlbWVudCgpO1xuXHQgICAgICAgIHRoaXMuX2Fzc2lnbkRlZmF1bHRFdmVudHMoKTtcblx0ICAgICAgICB0aGlzLl9zZXRUaW1lKHRoaXMuX29wdGlvbi5kZWZhdWx0SG91ciwgdGhpcy5fb3B0aW9uLmRlZmF1bHRNaW51dGUsIGZhbHNlKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgb3B0aW9uXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uIGZvciB0aW1lIHBpY2tlclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3NldE9wdGlvbjogZnVuY3Rpb24ob3B0aW9uKSB7XG5cdCAgICAgICAgdGhpcy5fb3B0aW9uID0ge1xuXHQgICAgICAgICAgICBkZWZhdWx0SG91cjogMCxcblx0ICAgICAgICAgICAgZGVmYXVsdE1pbnV0ZTogMCxcblx0ICAgICAgICAgICAgaW5wdXRFbGVtZW50OiBudWxsLFxuXHQgICAgICAgICAgICBob3VyU3RlcDogMSxcblx0ICAgICAgICAgICAgbWludXRlU3RlcDogMSxcblx0ICAgICAgICAgICAgaG91ckV4Y2x1c2lvbjogbnVsbCxcblx0ICAgICAgICAgICAgbWludXRlRXhjbHVzaW9uOiBudWxsLFxuXHQgICAgICAgICAgICBzaG93TWVyaWRpYW46IGZhbHNlLFxuXHQgICAgICAgICAgICBwb3NpdGlvbjoge31cblx0ICAgICAgICB9O1xuXHRcblx0ICAgICAgICB1dGlsLmV4dGVuZCh0aGlzLl9vcHRpb24sIG9wdGlvbik7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogbWFrZSBzcGluYm94ZXMgKGhvdXIgJiBtaW51dGUpXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfbWFrZVNwaW5ib3hlczogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIG9wdCA9IHRoaXMuX29wdGlvbjtcblx0ICAgICAgICB2YXIgZGVmYXVsdEhvdXIgPSBvcHQuZGVmYXVsdEhvdXI7XG5cdFxuXHQgICAgICAgIGlmIChvcHQuc2hvd01lcmlkaWFuKSB7XG5cdCAgICAgICAgICAgIGRlZmF1bHRIb3VyID0gdXRpbHMuZ2V0TWVyaWRpZW1Ib3VyKGRlZmF1bHRIb3VyKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMuX2hvdXJTcGluYm94ID0gbmV3IFNwaW5ib3goc3BpbkJveFRhZywge1xuXHQgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHRIb3VyLFxuXHQgICAgICAgICAgICBtaW46IChvcHQuc2hvd01lcmlkaWFuKSA/IDEgOiAwLFxuXHQgICAgICAgICAgICBtYXg6IChvcHQuc2hvd01lcmlkaWFuKSA/IDEyIDogMjMsXG5cdCAgICAgICAgICAgIHN0ZXA6IG9wdC5ob3VyU3RlcCxcblx0ICAgICAgICAgICAgdXBCdG5UYWc6IHVwQnRuVGFnLFxuXHQgICAgICAgICAgICBkb3duQnRuVGFnOiBkb3duQnRuVGFnLFxuXHQgICAgICAgICAgICBleGNsdXNpb246IG9wdC5ob3VyRXhjbHVzaW9uXG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHRoaXMuX21pbnV0ZVNwaW5ib3ggPSBuZXcgU3BpbmJveChzcGluQm94VGFnLCB7XG5cdCAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogb3B0LmRlZmF1bHRNaW51dGUsXG5cdCAgICAgICAgICAgIG1pbjogMCxcblx0ICAgICAgICAgICAgbWF4OiA1OSxcblx0ICAgICAgICAgICAgc3RlcDogb3B0Lm1pbnV0ZVN0ZXAsXG5cdCAgICAgICAgICAgIHVwQnRuVGFnOiB1cEJ0blRhZyxcblx0ICAgICAgICAgICAgZG93bkJ0blRhZzogZG93bkJ0blRhZyxcblx0ICAgICAgICAgICAgZXhjbHVzaW9uOiBvcHQubWludXRlRXhjbHVzaW9uXG5cdCAgICAgICAgfSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogbWFrZSB0aW1lcGlja2VyIGNvbnRhaW5lclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX21ha2VUaW1lUGlja2VyRWxlbWVudDogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIG9wdCA9IHRoaXMuX29wdGlvbjtcblx0ICAgICAgICB2YXIgJHRwID0gJCh0aW1lUGlja2VyVGFnKTtcblx0ICAgICAgICB2YXIgJHRwUm93ID0gJHRwLmZpbmQoJy50aW1lcGlja2VyLXJvdycpO1xuXHQgICAgICAgIHZhciAkY29sb24gPSAkKGNvbHVtblRhZykuYWRkQ2xhc3MoJ2NvbG9uJykuYXBwZW5kKCc6Jyk7XG5cdCAgICAgICAgdmFyICRtZXJpZGlhbjtcblx0XG5cdCAgICAgICAgJHRwUm93LmFwcGVuZCh0aGlzLl9ob3VyU3BpbmJveC5nZXRDb250YWluZXJFbGVtZW50KCksICRjb2xvbiwgdGhpcy5fbWludXRlU3BpbmJveC5nZXRDb250YWluZXJFbGVtZW50KCkpO1xuXHRcblx0ICAgICAgICBpZiAob3B0LnNob3dNZXJpZGlhbikge1xuXHQgICAgICAgICAgICAkbWVyaWRpYW4gPSAkKGNvbHVtblRhZylcblx0ICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnbWVyaWRpYW4nKVxuXHQgICAgICAgICAgICAgICAgLmFwcGVuZChtZXJpZGllbVRhZyk7XG5cdCAgICAgICAgICAgIHRoaXMuXyRtZXJpZGlhbkVsZW1lbnQgPSAkbWVyaWRpYW4uZmluZCgnc2VsZWN0JykuZXEoMCk7XG5cdCAgICAgICAgICAgICR0cFJvdy5hcHBlbmQoJG1lcmlkaWFuKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgICR0cC5oaWRlKCk7XG5cdCAgICAgICAgJCgnYm9keScpLmFwcGVuZCgkdHApO1xuXHQgICAgICAgIHRoaXMuJHRpbWVQaWNrZXJFbGVtZW50ID0gJHRwO1xuXHRcblx0ICAgICAgICBpZiAob3B0LmlucHV0RWxlbWVudCkge1xuXHQgICAgICAgICAgICAkdHAuY3NzKCdwb3NpdGlvbicsICdhYnNvbHV0ZScpO1xuXHQgICAgICAgICAgICB0aGlzLl8kaW5wdXRFbGVtZW50ID0gJChvcHQuaW5wdXRFbGVtZW50KTtcblx0ICAgICAgICAgICAgdGhpcy5fc2V0RGVmYXVsdFBvc2l0aW9uKHRoaXMuXyRpbnB1dEVsZW1lbnQpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBzZXQgcG9zaXRpb24gb2YgdGltZXBpY2tlciBjb250YWluZXJcblx0ICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkaW5wdXQganF1ZXJ5LW9iamVjdCAoZWxlbWVudClcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXREZWZhdWx0UG9zaXRpb246IGZ1bmN0aW9uKCRpbnB1dCkge1xuXHQgICAgICAgIHZhciBpbnB1dEVsID0gJGlucHV0WzBdO1xuXHQgICAgICAgIHZhciBwb3NpdGlvbiA9IHRoaXMuX29wdGlvbi5wb3NpdGlvbjtcblx0ICAgICAgICB2YXIgeCA9IHBvc2l0aW9uLng7XG5cdCAgICAgICAgdmFyIHkgPSBwb3NpdGlvbi55O1xuXHRcblx0ICAgICAgICBpZiAoIXV0aWwuaXNOdW1iZXIoeCkgfHwgIXV0aWwuaXNOdW1iZXIoeSkpIHtcblx0ICAgICAgICAgICAgeCA9IGlucHV0RWwub2Zmc2V0TGVmdDtcblx0ICAgICAgICAgICAgeSA9IGlucHV0RWwub2Zmc2V0VG9wICsgaW5wdXRFbC5vZmZzZXRIZWlnaHQgKyAzO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0aGlzLnNldFhZUG9zaXRpb24oeCwgeSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogYXNzaWduIGRlZmF1bHQgZXZlbnRzXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYXNzaWduRGVmYXVsdEV2ZW50czogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyICRpbnB1dCA9IHRoaXMuXyRpbnB1dEVsZW1lbnQ7XG5cdFxuXHQgICAgICAgIGlmICgkaW5wdXQpIHtcblx0ICAgICAgICAgICAgdGhpcy5fYXNzaWduRXZlbnRzVG9JbnB1dEVsZW1lbnQoKTtcblx0ICAgICAgICAgICAgdGhpcy5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgICAgICAkaW5wdXQudmFsKHRoaXMuZ2V0VGltZSgpKTtcblx0ICAgICAgICAgICAgfSwgdGhpcyk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLl9ob3VyU3BpbmJveC5vbignY2hhbmdlJywgdXRpbC5iaW5kKHRoaXMuX29uQ2hhbmdlU3BpbmJveCwgdGhpcykpO1xuXHQgICAgICAgIHRoaXMuX21pbnV0ZVNwaW5ib3gub24oJ2NoYW5nZScsIHV0aWwuYmluZCh0aGlzLl9vbkNoYW5nZVNwaW5ib3gsIHRoaXMpKTtcblx0XG5cdCAgICAgICAgdGhpcy4kdGltZVBpY2tlckVsZW1lbnQub24oJ2NoYW5nZScsICdzZWxlY3QnLCB1dGlsLmJpbmQodGhpcy5fb25DaGFuZ2VNZXJpZGllbSwgdGhpcykpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIGF0dGFjaCBldmVudCB0byBJbnB1dCBlbGVtZW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYXNzaWduRXZlbnRzVG9JbnB1dEVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgICB2YXIgJGlucHV0ID0gdGhpcy5fJGlucHV0RWxlbWVudDtcblx0XG5cdCAgICAgICAgJGlucHV0Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIHNlbGYub3BlbihldmVudCk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICRpbnB1dC5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGlmICghc2VsZi5zZXRUaW1lRnJvbUlucHV0RWxlbWVudCgpKSB7XG5cdCAgICAgICAgICAgICAgICAkaW5wdXQudmFsKHNlbGYuZ2V0VGltZSgpKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEN1c3RvbSBldmVudCBoYW5kbGVyXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIENoYW5nZSB0eXBlIG9uIHNwaW5ib3ggKHR5cGU6IHVwLCBkb3duLCBkZWZ1YWx0KVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX29uQ2hhbmdlU3BpbmJveDogZnVuY3Rpb24odHlwZSkge1xuXHQgICAgICAgIHZhciBob3VyID0gdGhpcy5faG91clNwaW5ib3guZ2V0VmFsdWUoKTtcblx0ICAgICAgICB2YXIgbWludXRlID0gdGhpcy5fbWludXRlU3BpbmJveC5nZXRWYWx1ZSgpO1xuXHRcblx0ICAgICAgICBpZiAodGhpcy5fb3B0aW9uLnNob3dNZXJpZGlhbikge1xuXHQgICAgICAgICAgICBpZiAoKHR5cGUgPT09ICd1cCcgJiYgaG91ciA9PT0gMTIpIHx8XG5cdCAgICAgICAgICAgICAgICAodHlwZSA9PT0gJ2Rvd24nICYmIGhvdXIgPT09IDExKSkge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5faXNQTSA9ICF0aGlzLl9pc1BNO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGhvdXIgPSB0aGlzLl9nZXRPcmlnaW5hbEhvdXIoaG91cik7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLl9zZXRUaW1lKGhvdXIsIG1pbnV0ZSwgZmFsc2UpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERPTSBldmVudCBoYW5kbGVyXG5cdCAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCAtIENoYW5nZSBldmVudCBvbiBtZXJpZGllbSBlbGVtZW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfb25DaGFuZ2VNZXJpZGllbTogZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICB2YXIgaXNQTSA9IChldmVudC50YXJnZXQudmFsdWUgPT09ICdQTScpO1xuXHQgICAgICAgIHZhciBjdXJyZW50SG91ciA9IHRoaXMuX2hvdXI7XG5cdCAgICAgICAgdmFyIGhvdXIgPSBpc1BNID8gKGN1cnJlbnRIb3VyICsgMTIpIDogKGN1cnJlbnRIb3VyICUgMTIpO1xuXHRcblx0ICAgICAgICB0aGlzLl9zZXRUaW1lKGhvdXIsIHRoaXMuX21pbnV0ZVNwaW5ib3guZ2V0VmFsdWUoKSwgZmFsc2UpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIGlzIGNsaWNrZWQgaW5zaWRlIG9mIGNvbnRhaW5lcj9cblx0ICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IGV2ZW50LW9iamVjdFxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2lzQ2xpY2tlZEluc2lkZTogZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICB2YXIgaXNDb250YWlucyA9ICQuY29udGFpbnModGhpcy4kdGltZVBpY2tlckVsZW1lbnRbMF0sIGV2ZW50LnRhcmdldCk7XG5cdCAgICAgICAgdmFyIGlzSW5wdXRFbGVtZW50ID0gKHRoaXMuXyRpbnB1dEVsZW1lbnQgJiZcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnRbMF0gPT09IGV2ZW50LnRhcmdldCk7XG5cdFxuXHQgICAgICAgIHJldHVybiBpc0NvbnRhaW5zIHx8IGlzSW5wdXRFbGVtZW50O1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIHRyYW5zZm9ybSB0aW1lIGludG8gZm9ybWF0dGVkIHN0cmluZ1xuXHQgICAgICogQHJldHVybnMge3N0cmluZ30gdGltZSBzdHJpbmdcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9mb3JtVG9UaW1lRm9ybWF0OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgaG91ciA9IHRoaXMuX2hvdXI7XG5cdCAgICAgICAgdmFyIG1pbnV0ZSA9IHRoaXMuX21pbnV0ZTtcblx0ICAgICAgICB2YXIgcG9zdGZpeCA9IHRoaXMuX2dldFBvc3RmaXgoKTtcblx0ICAgICAgICB2YXIgZm9ybWF0dGVkSG91ciwgZm9ybWF0dGVkTWludXRlO1xuXHRcblx0ICAgICAgICBpZiAodGhpcy5fb3B0aW9uLnNob3dNZXJpZGlhbikge1xuXHQgICAgICAgICAgICBob3VyID0gdXRpbHMuZ2V0TWVyaWRpZW1Ib3VyKGhvdXIpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZm9ybWF0dGVkSG91ciA9IChob3VyIDwgMTApID8gJzAnICsgaG91ciA6IGhvdXI7XG5cdCAgICAgICAgZm9ybWF0dGVkTWludXRlID0gKG1pbnV0ZSA8IDEwKSA/ICcwJyArIG1pbnV0ZSA6IG1pbnV0ZTtcblx0XG5cdCAgICAgICAgcmV0dXJuIGZvcm1hdHRlZEhvdXIgKyAnOicgKyBmb3JtYXR0ZWRNaW51dGUgKyBwb3N0Zml4O1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIHNldCB0aGUgYm9vbGVhbiB2YWx1ZSAnaXNQTScgd2hlbiBBTS9QTSBvcHRpb24gaXMgdHJ1ZS5cblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXRJc1BNOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aGlzLl9pc1BNID0gKHRoaXMuX2hvdXIgPiAxMSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogZ2V0IHBvc3RmaXggd2hlbiBBTS9QTSBvcHRpb24gaXMgdHJ1ZS5cblx0ICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHBvc3RmaXggKEFNL1BNKVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2dldFBvc3RmaXg6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBwb3N0Zml4ID0gJyc7XG5cdFxuXHQgICAgICAgIGlmICh0aGlzLl9vcHRpb24uc2hvd01lcmlkaWFuKSB7XG5cdCAgICAgICAgICAgIHBvc3RmaXggPSAodGhpcy5faXNQTSkgPyAnIFBNJyA6ICcgQU0nO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIHBvc3RmaXg7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogc2V0IHBvc2l0aW9uIG9mIGNvbnRhaW5lclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHggLSBpdCB3aWxsIGJlIG9mZnNldExlZnQgb2YgZWxlbWVudFxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHkgLSBpdCB3aWxsIGJlIG9mZnNldFRvcCBvZiBlbGVtZW50XG5cdCAgICAgKi9cblx0ICAgIHNldFhZUG9zaXRpb246IGZ1bmN0aW9uKHgsIHkpIHtcblx0ICAgICAgICBpZiAoIXV0aWwuaXNOdW1iZXIoeCkgfHwgIXV0aWwuaXNOdW1iZXIoeSkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdXRpbC5leHRlbmQodGhpcy5fb3B0aW9uLnBvc2l0aW9uLCB7XG5cdCAgICAgICAgICAgIHg6IHgsXG5cdCAgICAgICAgICAgIHk6IHlcblx0ICAgICAgICB9KTtcblx0ICAgICAgICB0aGlzLiR0aW1lUGlja2VyRWxlbWVudC5jc3Moe1xuXHQgICAgICAgICAgICBsZWZ0OiB4LFxuXHQgICAgICAgICAgICB0b3A6IHlcblx0ICAgICAgICB9KTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBzaG93IHRpbWUgcGlja2VyIGVsZW1lbnRcblx0ICAgICAqL1xuXHQgICAgc2hvdzogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdGhpcy4kdGltZVBpY2tlckVsZW1lbnQuc2hvdygpO1xuXHQgICAgICAgIHRoaXMuX2lzU2hvd24gPSB0cnVlO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIGhpZGUgdGltZSBwaWNrZXIgZWxlbWVudFxuXHQgICAgICovXG5cdCAgICBoaWRlOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aGlzLiR0aW1lUGlja2VyRWxlbWVudC5oaWRlKCk7XG5cdCAgICAgICAgdGhpcy5faXNTaG93biA9IGZhbHNlO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIGxpc3RlbmVyIHRvIHNob3cgY29udGFpbmVyXG5cdCAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBldmVudC1vYmplY3Rcblx0ICAgICAqL1xuXHQgICAgb3BlbjogZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICBpZiAodGhpcy5faXNTaG93bikge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCB1dGlsLmJpbmQodGhpcy5jbG9zZSwgdGhpcykpO1xuXHQgICAgICAgIHRoaXMuc2hvdygpO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBPcGVuIGV2ZW50IC0gVGltZVBpY2tlclxuXHQgICAgICAgICAqIEBldmVudCBUaW1lUGlja2VyI29wZW5cblx0ICAgICAgICAgKiBAcGFyYW0geyhqUXVlcnkuRXZlbnR8dW5kZWZpbmVkKX0gLSBDbGljayB0aGUgaW5wdXQgZWxlbWVudFxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuZmlyZSgnb3BlbicsIGV2ZW50KTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBsaXN0ZW5lciB0byBoaWRlIGNvbnRhaW5lclxuXHQgICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgZXZlbnQtb2JqZWN0XG5cdCAgICAgKi9cblx0ICAgIGNsb3NlOiBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgIGlmICghdGhpcy5faXNTaG93biB8fCB0aGlzLl9pc0NsaWNrZWRJbnNpZGUoZXZlbnQpKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgICQoZG9jdW1lbnQpLm9mZihldmVudCk7XG5cdCAgICAgICAgdGhpcy5oaWRlKCk7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEhpZGUgZXZlbnQgLSBUaW1lcGlja2VyXG5cdCAgICAgICAgICogQGV2ZW50IFRpbWVQaWNrZXIjY2xvc2Vcblx0ICAgICAgICAgKiBAcGFyYW0geyhqUXVlcnkuRXZlbnR8dW5kZWZpbmVkKX0gLSBDbGljayB0aGUgZG9jdW1lbnQgKG5vdCBUaW1lUGlja2VyKVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuZmlyZSgnY2xvc2UnLCBldmVudCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogc2V0IHZhbHVlcyBpbiBzcGluYm94ZXMgZnJvbSB0aW1lXG5cdCAgICAgKi9cblx0ICAgIHRvU3BpbmJveGVzOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgaG91ciA9IHRoaXMuX2hvdXI7XG5cdCAgICAgICAgdmFyIG1pbnV0ZSA9IHRoaXMuX21pbnV0ZTtcblx0XG5cdCAgICAgICAgaWYgKHRoaXMuX29wdGlvbi5zaG93TWVyaWRpYW4pIHtcblx0ICAgICAgICAgICAgaG91ciA9IHV0aWxzLmdldE1lcmlkaWVtSG91cihob3VyKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMuX2hvdXJTcGluYm94LnNldFZhbHVlKGhvdXIpO1xuXHQgICAgICAgIHRoaXMuX21pbnV0ZVNwaW5ib3guc2V0VmFsdWUobWludXRlKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgb3JpZ2luYWwgaG91ciBmcm9tIG1lcmlkaWVtIGhvdXJcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKiBAcGFyYW0ge2hvdXJ9IGhvdXIgLSBNZXJpZGllbSBob3VyXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBPcmlnaW5hbCBob3VyXG5cdCAgICAgKi9cblx0ICAgIF9nZXRPcmlnaW5hbEhvdXI6IGZ1bmN0aW9uKGhvdXIpIHtcblx0ICAgICAgICB2YXIgaXNQTSA9IHRoaXMuX2lzUE07XG5cdFxuXHQgICAgICAgIGlmIChpc1BNKSB7XG5cdCAgICAgICAgICAgIGhvdXIgPSAoaG91ciA8IDEyKSA/IChob3VyICsgMTIpIDogMTI7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaG91ciA9IChob3VyIDwgMTIpID8gKGhvdXIgJSAxMikgOiAwO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGhvdXI7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogc2V0IHRpbWUgZnJvbSBpbnB1dCBlbGVtZW50LlxuXHQgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxqUXVlcnl9IFtpbnB1dEVsZW1lbnRdIGpxdWVyeSBvYmplY3QgKGVsZW1lbnQpXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0IG9mIHNldCB0aW1lXG5cdCAgICAgKi9cblx0ICAgIHNldFRpbWVGcm9tSW5wdXRFbGVtZW50OiBmdW5jdGlvbihpbnB1dEVsZW1lbnQpIHtcblx0ICAgICAgICB2YXIgaW5wdXQgPSAkKGlucHV0RWxlbWVudClbMF0gfHwgdGhpcy5fJGlucHV0RWxlbWVudFswXTtcblx0XG5cdCAgICAgICAgcmV0dXJuICEhKGlucHV0ICYmIHRoaXMuc2V0VGltZUZyb21TdHJpbmcoaW5wdXQudmFsdWUpKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBzZXQgaG91clxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IGhvdXIgZm9yIHRpbWUgcGlja2VyXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0IG9mIHNldCB0aW1lXG5cdCAgICAgKi9cblx0ICAgIHNldEhvdXI6IGZ1bmN0aW9uKGhvdXIpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5fc2V0VGltZShob3VyLCB0aGlzLl9taW51dGUsIHRydWUpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIHNldCBtaW51dGVcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW51dGUgZm9yIHRpbWUgcGlja2VyXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0IG9mIHNldCB0aW1lXG5cdCAgICAgKi9cblx0ICAgIHNldE1pbnV0ZTogZnVuY3Rpb24obWludXRlKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuX3NldFRpbWUodGhpcy5faG91ciwgbWludXRlLCB0cnVlKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBzZXQgdGltZSBmb3IgZXh0ZW5hbCBjYWxsXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gaG91ciBmb3IgdGltZSBwaWNrZXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW51dGUgZm9yIHRpbWUgcGlja2VyXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0IG9mIHNldCB0aW1lXG5cdCAgICAgKi9cblx0ICAgIHNldFRpbWU6IGZ1bmN0aW9uKGhvdXIsIG1pbnV0ZSkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLl9zZXRUaW1lKGhvdXIsIG1pbnV0ZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogc2V0IHRpbWVcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBob3VyIGZvciB0aW1lIHBpY2tlclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IG1pbnV0ZSBmb3IgdGltZSBwaWNrZXJcblx0ICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNTZXRTcGluYm94IHdoZXRoZXIgc3BpbmJveCBzZXQgb3Igbm90XG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0IG9mIHNldCB0aW1lXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0VGltZTogZnVuY3Rpb24oaG91ciwgbWludXRlLCBpc1NldFNwaW5ib3gpIHtcblx0ICAgICAgICB2YXIgaXNOdW1iZXIgPSAodXRpbC5pc051bWJlcihob3VyKSAmJiB1dGlsLmlzTnVtYmVyKG1pbnV0ZSkpO1xuXHQgICAgICAgIHZhciBpc1ZhbGlkID0gKGhvdXIgPCAyNCAmJiBtaW51dGUgPCA2MCk7XG5cdCAgICAgICAgdmFyIHBvc3RmaXg7XG5cdFxuXHQgICAgICAgIGlmICghaXNOdW1iZXIgfHwgIWlzVmFsaWQpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5faG91ciA9IGhvdXI7XG5cdCAgICAgICAgdGhpcy5fbWludXRlID0gbWludXRlO1xuXHRcblx0ICAgICAgICB0aGlzLl9zZXRJc1BNKCk7XG5cdFxuXHQgICAgICAgIGlmIChpc1NldFNwaW5ib3gpIHtcblx0ICAgICAgICAgICAgdGhpcy50b1NwaW5ib3hlcygpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKHRoaXMuXyRtZXJpZGlhbkVsZW1lbnQpIHtcblx0ICAgICAgICAgICAgcG9zdGZpeCA9IHRoaXMuX2dldFBvc3RmaXgoKS5yZXBsYWNlKC9cXHMrLywgJycpO1xuXHQgICAgICAgICAgICB0aGlzLl8kbWVyaWRpYW5FbGVtZW50LnZhbChwb3N0Zml4KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIENoYW5nZSBldmVudCAtIFRpbWVQaWNrZXJcblx0ICAgICAgICAgKiBAZXZlbnQgVGltZVBpY2tlciNjaGFuZ2Vcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLmZpcmUoJ2NoYW5nZScsIGlzU2V0U3BpbmJveCk7XG5cdFxuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIHNldCB0aW1lIGZyb20gdGltZS1zdHJpbmdcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0aW1lU3RyaW5nIHRpbWUtc3RyaW5nXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0IG9mIHNldCB0aW1lXG5cdCAgICAgKiBAdG9kbyBSZWZhY3RvcjogZnVuY3Rpb24gY29tcGxleGl0eVxuXHQgICAgICovXG5cdCAgICBzZXRUaW1lRnJvbVN0cmluZzogZnVuY3Rpb24odGltZVN0cmluZykge1xuXHQgICAgICAgIHZhciB0aW1lLCBob3VyLCBtaW51dGUsIHBvc3RmaXgsIGlzUE07XG5cdFxuXHQgICAgICAgIGlmICh0aW1lUmVnRXhwLnRlc3QodGltZVN0cmluZykpIHtcblx0ICAgICAgICAgICAgdGltZSA9IHRpbWVTdHJpbmcuc3BsaXQodGltZVNlcGVyYXRvcik7XG5cdCAgICAgICAgICAgIGhvdXIgPSBOdW1iZXIodGltZVswXSk7XG5cdCAgICAgICAgICAgIG1pbnV0ZSA9IE51bWJlcih0aW1lWzFdKTtcblx0XG5cdCAgICAgICAgICAgIGlmIChob3VyIDwgMjQgJiYgdGhpcy5fb3B0aW9uLnNob3dNZXJpZGlhbikge1xuXHQgICAgICAgICAgICAgICAgcG9zdGZpeCA9IHRpbWVbMl0udG9VcHBlckNhc2UoKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAocG9zdGZpeCA9PT0gJ1BNJykge1xuXHQgICAgICAgICAgICAgICAgICAgIGlzUE0gPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwb3N0Zml4ID09PSAnQU0nKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaXNQTSA9IChob3VyID4gMTIpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICBpc1BNID0gdGhpcy5faXNQTTtcblx0ICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoaXNQTSAmJiBob3VyIDwgMTIpIHtcblx0ICAgICAgICAgICAgICAgICAgICBob3VyICs9IDEyO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghaXNQTSAmJiBob3VyID09PSAxMikge1xuXHQgICAgICAgICAgICAgICAgICAgIGhvdXIgPSAwO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gdGhpcy5fc2V0VGltZShob3VyLCBtaW51dGUsIHRydWUpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIHNldCBzdGVwIG9mIGhvdXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwIGZvciB0aW1lIHBpY2tlclxuXHQgICAgICovXG5cdCAgICBzZXRIb3VyU3RlcDogZnVuY3Rpb24oc3RlcCkge1xuXHQgICAgICAgIHRoaXMuX2hvdXJTcGluYm94LnNldFN0ZXAoc3RlcCk7XG5cdCAgICAgICAgdGhpcy5fb3B0aW9uLmhvdXJTdGVwID0gdGhpcy5faG91clNwaW5ib3guZ2V0U3RlcCgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIHNldCBzdGVwIG9mIG1pbnV0ZVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAgZm9yIHRpbWUgcGlja2VyXG5cdCAgICAgKi9cblx0ICAgIHNldE1pbnV0ZVN0ZXA6IGZ1bmN0aW9uKHN0ZXApIHtcblx0ICAgICAgICB0aGlzLl9taW51dGVTcGluYm94LnNldFN0ZXAoc3RlcCk7XG5cdCAgICAgICAgdGhpcy5fb3B0aW9uLm1pbnV0ZVN0ZXAgPSB0aGlzLl9taW51dGVTcGluYm94LmdldFN0ZXAoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBhZGQgYSBzcGVjaWZpYyBob3VyIHRvIGV4Y2x1ZGVcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBob3VyIGZvciBleGNsdXNpb25cblx0ICAgICAqL1xuXHQgICAgYWRkSG91ckV4Y2x1c2lvbjogZnVuY3Rpb24oaG91cikge1xuXHQgICAgICAgIHRoaXMuX2hvdXJTcGluYm94LmFkZEV4Y2x1c2lvbihob3VyKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBhZGQgYSBzcGVjaWZpYyBtaW51dGUgdG8gZXhjbHVkZVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IG1pbnV0ZSBmb3IgZXhjbHVzaW9uXG5cdCAgICAgKi9cblx0ICAgIGFkZE1pbnV0ZUV4Y2x1c2lvbjogZnVuY3Rpb24obWludXRlKSB7XG5cdCAgICAgICAgdGhpcy5fbWludXRlU3BpbmJveC5hZGRFeGNsdXNpb24obWludXRlKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBnZXQgc3RlcCBvZiBob3VyXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBob3VyIHVwL2Rvd24gc3RlcFxuXHQgICAgICovXG5cdCAgICBnZXRIb3VyU3RlcDogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbi5ob3VyU3RlcDtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBnZXQgc3RlcCBvZiBtaW51dGVcblx0ICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IG1pbnV0ZSB1cC9kb3duIHN0ZXBcblx0ICAgICAqL1xuXHQgICAgZ2V0TWludXRlU3RlcDogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbi5taW51dGVTdGVwO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIHJlbW92ZSBob3VyIGZyb20gZXhjbHVzaW9uIGxpc3Rcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBob3VyIHRoYXQgeW91IHdhbnQgdG8gcmVtb3ZlXG5cdCAgICAgKi9cblx0ICAgIHJlbW92ZUhvdXJFeGNsdXNpb246IGZ1bmN0aW9uKGhvdXIpIHtcblx0ICAgICAgICB0aGlzLl9ob3VyU3BpbmJveC5yZW1vdmVFeGNsdXNpb24oaG91cik7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogcmVtb3ZlIG1pbnV0ZSBmcm9tIGV4Y2x1c2lvbiBsaXN0XG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gbWludXRlIHRoYXQgeW91IHdhbnQgdG8gcmVtb3ZlXG5cdCAgICAgKi9cblx0ICAgIHJlbW92ZU1pbnV0ZUV4Y2x1c2lvbjogZnVuY3Rpb24obWludXRlKSB7XG5cdCAgICAgICAgdGhpcy5fbWludXRlU3BpbmJveC5yZW1vdmVFeGNsdXNpb24obWludXRlKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBnZXQgaG91clxuXHQgICAgICogQHJldHVybnMge251bWJlcn0gaG91clxuXHQgICAgICovXG5cdCAgICBnZXRIb3VyOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5faG91cjtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBnZXQgbWludXRlXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBtaW51dGVcblx0ICAgICAqL1xuXHQgICAgZ2V0TWludXRlOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5fbWludXRlO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIGdldCB0aW1lXG5cdCAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSAnaGg6bW0gKEFNL1BNKSdcblx0ICAgICAqL1xuXHQgICAgZ2V0VGltZTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1Ub1RpbWVGb3JtYXQoKTtcblx0ICAgIH1cblx0fSk7XG5cdHR1aS51dGlsLkN1c3RvbUV2ZW50cy5taXhpbihUaW1lUGlja2VyKTtcblx0XG5cdG1vZHVsZS5leHBvcnRzID0gVGltZVBpY2tlcjtcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gdHVpLWNvbXBvbmVudC1kYXRlLXBpY2tlci5taW4uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJkaXN0XCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMDM0MTEwZTk3MjhmNDU2MGFhYTAiLCIndXNlIHN0cmljdCc7XG5cbnZhciBEYXRlUGlja2VyID0gcmVxdWlyZSgnLi9kYXRlcGlja2VyJyk7XG52YXIgVGltZVBpY2tlciA9IHJlcXVpcmUoJy4vdGltZXBpY2tlcicpO1xudmFyIFNwaW5ib3ggPSByZXF1aXJlKCcuL3NwaW5ib3gnKTtcblxudHVpLnV0aWwuZGVmaW5lTmFtZXNwYWNlKCd0dWkuY29tcG9uZW50Jywge1xuICAgIERhdGVQaWNrZXI6IERhdGVQaWNrZXIsXG4gICAgVGltZVBpY2tlcjogVGltZVBpY2tlcixcbiAgICBTcGluYm94OiBTcGluYm94XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogQ3JlYXRlZCBieSBuaG5lbnQgb24gMTUuIDQuIDI4Li5cbiAqIEBmaWxlb3ZlcnZpZXcgU3BpbmJveCBDb21wb25lbnRcbiAqIEBhdXRob3IgTkhOIGVudCBGRSBkZXYgTGFiIDxkbF9qYXZhc2NyaXB0QG5obmVudC5jb20+XG4gKiBAZGVwZW5kZW5jeSBqcXVlcnktMS44LjMsIGNvZGUtc25pcHBldC0xLjAuMlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWwgPSB0dWkudXRpbDtcbnZhciBpbkFycmF5ID0gdXRpbC5pbkFycmF5O1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtTdHJpbmd8SFRNTEVsZW1lbnR9IGNvbnRhaW5lciAtIGNvbnRhaW5lciBvZiBzcGluYm94XG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbl0gLSBvcHRpb24gZm9yIGluaXRpYWxpemF0aW9uXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24uZGVmYXVsdFZhbHVlID0gMF0gLSBpbml0aWFsIHNldHRpbmcgdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9uLnN0ZXAgPSAxXSAtIGlmIHN0ZXAgPSAyLCB2YWx1ZSA6IDAgLT4gMiAtPiA0IC0+IC4uLlxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24ubWF4ID0gOTAwNzE5OTI1NDc0MDk5MV0gLSBtYXggdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9uLm1pbiA9IC05MDA3MTk5MjU0NzQwOTkxXSAtIG1pbiB2YWx1ZVxuICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb24udXBCdG5UYWcgPSBidXR0b24gSFRNTF0gLSB1cCBidXR0b24gaHRtbCBzdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLmRvd25CdG5UYWcgPSBidXR0b24gSFRNTF0gLSBkb3duIGJ1dHRvbiBodG1sIHN0cmluZ1xuICogQHBhcmFtIHtBcnJheX0gIFtvcHRpb24uZXhjbHVzaW9uID0gW11dIC0gdmFsdWUgdG8gYmUgZXhjbHVkZWQuIGlmIHRoaXMgaXMgWzEsM10sIDAgLT4gMiAtPiA0IC0+IDUgLT4uLi4uXG4gKlxuICogQHR1dG9yaWFsIHNhbXBsZTRcbiAqL1xudmFyIFNwaW5ib3ggPSB1dGlsLmRlZmluZUNsYXNzKC8qKiBAbGVuZHMgU3BpbmJveC5wcm90b3R5cGUgKi8ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGNvbnRhaW5lciwgb3B0aW9uKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fJGNvbnRhaW5lckVsZW1lbnQgPSAkKGNvbnRhaW5lcik7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl8kaW5wdXRFbGVtZW50ID0gdGhpcy5fJGNvbnRhaW5lckVsZW1lbnQuZmluZCgnaW5wdXRbdHlwZT1cInRleHRcIl0nKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3ZhbHVlID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge09iamVjdH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX29wdGlvbiA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl8kdXBCdXR0b24gPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fJGRvd25CdXR0b24gPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fY2hhbmdlVHlwZSA9ICdkZWZhdWx0JztcblxuICAgICAgICB0aGlzLl9pbml0aWFsaXplKG9wdGlvbik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgd2l0aCBvcHRpb25cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uIC0gT3B0aW9uIGZvciBJbml0aWFsaXphdGlvblxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2luaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbikge1xuICAgICAgICB0aGlzLl9zZXRPcHRpb24ob3B0aW9uKTtcbiAgICAgICAgdGhpcy5fYXNzaWduSFRNTEVsZW1lbnRzKCk7XG4gICAgICAgIHRoaXMuX2Fzc2lnbkRlZmF1bHRFdmVudHMoKTtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLl9vcHRpb24uZGVmYXVsdFZhbHVlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IGEgb3B0aW9uIHRvIGluc3RhbmNlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbiAtIE9wdGlvbiB0aGF0IHlvdSB3YW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0T3B0aW9uOiBmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgdGhpcy5fb3B0aW9uID0ge1xuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAwLFxuICAgICAgICAgICAgc3RlcDogMSxcbiAgICAgICAgICAgIG1heDogTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgfHwgOTAwNzE5OTI1NDc0MDk5MSxcbiAgICAgICAgICAgIG1pbjogTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIgfHwgLTkwMDcxOTkyNTQ3NDA5OTEsXG4gICAgICAgICAgICB1cEJ0blRhZzogJzxidXR0b24gdHlwZT1cImJ1dHRvblwiPjxiPis8L2I+PC9idXR0b24+JyxcbiAgICAgICAgICAgIGRvd25CdG5UYWc6ICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIj48Yj4tPC9iPjwvYnV0dG9uPidcbiAgICAgICAgfTtcbiAgICAgICAgdXRpbC5leHRlbmQodGhpcy5fb3B0aW9uLCBvcHRpb24pO1xuXG4gICAgICAgIGlmICghdXRpbC5pc0FycmF5KHRoaXMuX29wdGlvbi5leGNsdXNpb24pKSB7XG4gICAgICAgICAgICB0aGlzLl9vcHRpb24uZXhjbHVzaW9uID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuX2lzVmFsaWRPcHRpb24oKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTcGluYm94IG9wdGlvbiBpcyBpbnZhaWxkJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogaXMgYSB2YWxpZCBvcHRpb24/XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2lzVmFsaWRPcHRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb3B0ID0gdGhpcy5fb3B0aW9uO1xuXG4gICAgICAgIHJldHVybiAodGhpcy5faXNWYWxpZFZhbHVlKG9wdC5kZWZhdWx0VmFsdWUpICYmIHRoaXMuX2lzVmFsaWRTdGVwKG9wdC5zdGVwKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGlzIGEgdmFsaWQgdmFsdWU/XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIGZvciBzcGluYm94XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2lzVmFsaWRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFyIG9wdCxcbiAgICAgICAgICAgIGlzQmV0d2VlbixcbiAgICAgICAgICAgIGlzTm90SW5BcnJheTtcblxuICAgICAgICBpZiAoIXV0aWwuaXNOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBvcHQgPSB0aGlzLl9vcHRpb247XG4gICAgICAgIGlzQmV0d2VlbiA9IHZhbHVlIDw9IG9wdC5tYXggJiYgdmFsdWUgPj0gb3B0Lm1pbjtcbiAgICAgICAgaXNOb3RJbkFycmF5ID0gKGluQXJyYXkodmFsdWUsIG9wdC5leGNsdXNpb24pID09PSAtMSk7XG5cbiAgICAgICAgcmV0dXJuIChpc0JldHdlZW4gJiYgaXNOb3RJbkFycmF5KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogaXMgYSB2YWxpZCBzdGVwP1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwIGZvciBzcGluYm94IHVwL2Rvd25cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaXNWYWxpZFN0ZXA6IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdmFyIG1heFN0ZXAgPSAodGhpcy5fb3B0aW9uLm1heCAtIHRoaXMuX29wdGlvbi5taW4pO1xuXG4gICAgICAgIHJldHVybiAodXRpbC5pc051bWJlcihzdGVwKSAmJiBzdGVwIDwgbWF4U3RlcCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFzc2lnbiBlbGVtZW50cyB0byBpbnNpZGUgb2YgY29udGFpbmVyLlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2Fzc2lnbkhUTUxFbGVtZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3NldElucHV0U2l6ZUFuZE1heExlbmd0aCgpO1xuICAgICAgICB0aGlzLl9tYWtlQnV0dG9uKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIE1ha2UgdXAvZG93biBidXR0b25cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9tYWtlQnV0dG9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyICRpbnB1dCA9IHRoaXMuXyRpbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAkdXBCdG4gPSB0aGlzLl8kdXBCdXR0b24gPSAkKHRoaXMuX29wdGlvbi51cEJ0blRhZyksXG4gICAgICAgICAgICAkZG93bkJ0biA9IHRoaXMuXyRkb3duQnV0dG9uID0gJCh0aGlzLl9vcHRpb24uZG93bkJ0blRhZyk7XG5cbiAgICAgICAgJHVwQnRuLmluc2VydEJlZm9yZSgkaW5wdXQpO1xuICAgICAgICAkdXBCdG4ud3JhcCgnPGRpdj48L2Rpdj4nKTtcbiAgICAgICAgJGRvd25CdG4uaW5zZXJ0QWZ0ZXIoJGlucHV0KTtcbiAgICAgICAgJGRvd25CdG4ud3JhcCgnPGRpdj48L2Rpdj4nKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IHNpemUvbWF4bGVuZ3RoIGF0dHJpYnV0ZXMgb2YgaW5wdXQgZWxlbWVudC5cbiAgICAgKiBEZWZhdWx0IHZhbHVlIGlzIGEgZGlnaXRzIG9mIGEgbG9uZ2VyIHZhbHVlIG9mIG9wdGlvbi5taW4gb3Igb3B0aW9uLm1heFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldElucHV0U2l6ZUFuZE1heExlbmd0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciAkaW5wdXQgPSB0aGlzLl8kaW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgbWluVmFsdWVMZW5ndGggPSBTdHJpbmcodGhpcy5fb3B0aW9uLm1pbikubGVuZ3RoLFxuICAgICAgICAgICAgbWF4VmFsdWVMZW5ndGggPSBTdHJpbmcodGhpcy5fb3B0aW9uLm1heCkubGVuZ3RoLFxuICAgICAgICAgICAgbWF4bGVuZ3RoID0gTWF0aC5tYXgobWluVmFsdWVMZW5ndGgsIG1heFZhbHVlTGVuZ3RoKTtcblxuICAgICAgICBpZiAoISRpbnB1dC5hdHRyKCdzaXplJykpIHtcbiAgICAgICAgICAgICRpbnB1dC5hdHRyKCdzaXplJywgbWF4bGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISRpbnB1dC5hdHRyKCdtYXhsZW5ndGgnKSkge1xuICAgICAgICAgICAgJGlucHV0LmF0dHIoJ21heGxlbmd0aCcsIG1heGxlbmd0aCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQXNzaWduIGRlZmF1bHQgZXZlbnRzIHRvIHVwL2Rvd24gYnV0dG9uXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYXNzaWduRGVmYXVsdEV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvbkNsaWNrID0gdXRpbC5iaW5kKHRoaXMuX29uQ2xpY2tCdXR0b24sIHRoaXMpLFxuICAgICAgICAgICAgb25LZXlEb3duID0gdXRpbC5iaW5kKHRoaXMuX29uS2V5RG93bklucHV0RWxlbWVudCwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5fJHVwQnV0dG9uLm9uKCdjbGljaycsIHtpc0Rvd246IGZhbHNlfSwgb25DbGljayk7XG4gICAgICAgIHRoaXMuXyRkb3duQnV0dG9uLm9uKCdjbGljaycsIHtpc0Rvd246IHRydWV9LCBvbkNsaWNrKTtcbiAgICAgICAgdGhpcy5fJGlucHV0RWxlbWVudC5vbigna2V5ZG93bicsIG9uS2V5RG93bik7XG4gICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnQub24oJ2NoYW5nZScsIHV0aWwuYmluZCh0aGlzLl9vbkNoYW5nZUlucHV0LCB0aGlzKSk7XG4gICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnQub24oJ2ZvY3VzJywgdXRpbC5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fY2hhbmdlVHlwZSA9ICdkZWZhdWx0JztcbiAgICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXQgaW5wdXQgdmFsdWUgd2hlbiB1c2VyIGNsaWNrIGEgYnV0dG9uLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNEb3duIC0gSWYgYSB1c2VyIGNsaWNrZWQgYSBkb3duLWJ1dHR0b24sIHRoaXMgdmFsdWUgaXMgdHJ1ZS5cbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgIEVsc2UgaWYgYSB1c2VyIGNsaWNrZWQgYSB1cC1idXR0b24sIHRoaXMgdmFsdWUgaXMgZmFsc2UuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0TmV4dFZhbHVlOiBmdW5jdGlvbihpc0Rvd24pIHtcbiAgICAgICAgdmFyIG9wdCA9IHRoaXMuX29wdGlvbixcbiAgICAgICAgICAgIHN0ZXAgPSBvcHQuc3RlcCxcbiAgICAgICAgICAgIG1pbiA9IG9wdC5taW4sXG4gICAgICAgICAgICBtYXggPSBvcHQubWF4LFxuICAgICAgICAgICAgZXhjbHVzaW9uID0gb3B0LmV4Y2x1c2lvbixcbiAgICAgICAgICAgIG5leHRWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTtcblxuICAgICAgICBpZiAoaXNEb3duKSB7XG4gICAgICAgICAgICBzdGVwID0gLXN0ZXA7XG4gICAgICAgIH1cblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICBuZXh0VmFsdWUgKz0gc3RlcDtcbiAgICAgICAgICAgIGlmIChuZXh0VmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICBuZXh0VmFsdWUgPSBtaW47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5leHRWYWx1ZSA8IG1pbikge1xuICAgICAgICAgICAgICAgIG5leHRWYWx1ZSA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSB3aGlsZSAoaW5BcnJheShuZXh0VmFsdWUsIGV4Y2x1c2lvbikgPiAtMSk7XG5cbiAgICAgICAgdGhpcy5fY2hhbmdlVHlwZSA9IGlzRG93biA/ICdkb3duJyA6ICd1cCc7XG5cbiAgICAgICAgdGhpcy5zZXRWYWx1ZShuZXh0VmFsdWUpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBET00oVXAvRG93biBidXR0b24pIENsaWNrIEV2ZW50IGhhbmRsZXJcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBldmVudC1vYmplY3RcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9vbkNsaWNrQnV0dG9uOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICB0aGlzLl9zZXROZXh0VmFsdWUoZXZlbnQuZGF0YS5pc0Rvd24pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBET00oSW5wdXQgZWxlbWVudCkgS2V5ZG93biBFdmVudCBoYW5kbGVyXG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgZXZlbnQtb2JqZWN0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25LZXlEb3duSW5wdXRFbGVtZW50OiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICB2YXIga2V5Q29kZSA9IGV2ZW50LndoaWNoIHx8IGV2ZW50LmtleUNvZGU7XG4gICAgICAgIHZhciBpc0Rvd247XG5cbiAgICAgICAgc3dpdGNoIChrZXlDb2RlKSB7XG4gICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgIGlzRG93biA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICBpc0Rvd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2V0TmV4dFZhbHVlKGlzRG93bik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERPTShJbnB1dCBlbGVtZW50KSBDaGFuZ2UgRXZlbnQgaGFuZGxlclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uQ2hhbmdlSW5wdXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSBOdW1iZXIodGhpcy5fJGlucHV0RWxlbWVudC52YWwoKSksXG4gICAgICAgICAgICBpc0NoYW5nZSA9IHRoaXMuX2lzVmFsaWRWYWx1ZShuZXdWYWx1ZSkgJiYgdGhpcy5fdmFsdWUgIT09IG5ld1ZhbHVlLFxuICAgICAgICAgICAgbmV4dFZhbHVlID0gKGlzQ2hhbmdlKSA/IG5ld1ZhbHVlIDogdGhpcy5fdmFsdWU7XG5cbiAgICAgICAgdGhpcy5fdmFsdWUgPSBuZXh0VmFsdWU7XG4gICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnQudmFsKG5leHRWYWx1ZSk7XG5cbiAgICAgICAgdGhpcy5maXJlKCdjaGFuZ2UnLCB0aGlzLl9jaGFuZ2VUeXBlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2V0IHN0ZXAgb2Ygc3BpbmJveFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwIGZvciBzcGluYm94XG4gICAgICovXG4gICAgc2V0U3RlcDogZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICBpZiAoIXRoaXMuX2lzVmFsaWRTdGVwKHN0ZXApKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fb3B0aW9uLnN0ZXAgPSBzdGVwO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBnZXQgc3RlcCBvZiBzcGluYm94XG4gICAgICogQHJldHVybnMge251bWJlcn0gc3RlcFxuICAgICAqL1xuICAgIGdldFN0ZXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9uLnN0ZXA7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIGlucHV0IHZhbHVlLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IERhdGEgaW4gaW5wdXQtYm94XG4gICAgICovXG4gICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBhIHZhbHVlIHRvIGlucHV0LWJveC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWUgLSBWYWx1ZSB0aGF0IHlvdSB3YW50XG4gICAgICovXG4gICAgc2V0VmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnQudmFsKHZhbHVlKS5jaGFuZ2UoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgb3B0aW9uIG9mIGluc3RhbmNlLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IE9wdGlvbiBvZiBpbnN0YW5jZVxuICAgICAqL1xuICAgIGdldE9wdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcHRpb247XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFkZCB2YWx1ZSB0aGF0IHdpbGwgYmUgZXhjbHVkZWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIC0gVmFsdWUgdGhhdCB3aWxsIGJlIGV4Y2x1ZGVkLlxuICAgICAqL1xuICAgIGFkZEV4Y2x1c2lvbjogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFyIGV4Y2x1c2lvbiA9IHRoaXMuX29wdGlvbi5leGNsdXNpb247XG5cbiAgICAgICAgaWYgKGluQXJyYXkodmFsdWUsIGV4Y2x1c2lvbikgPiAtMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGV4Y2x1c2lvbi5wdXNoKHZhbHVlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgdmFsdWUgd2hpY2ggd2FzIGV4Y2x1ZGVkLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIFZhbHVlIHRoYXQgd2lsbCBiZSByZW1vdmVkIGZyb20gYSBleGNsdXNpb24gbGlzdCBvZiBpbnN0YW5jZVxuICAgICAqL1xuICAgIHJlbW92ZUV4Y2x1c2lvbjogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFyIGV4Y2x1c2lvbiA9IHRoaXMuX29wdGlvbi5leGNsdXNpb24sXG4gICAgICAgICAgICBpbmRleCA9IGluQXJyYXkodmFsdWUsIGV4Y2x1c2lvbik7XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGV4Y2x1c2lvbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBnZXQgY29udGFpbmVyIGVsZW1lbnRcbiAgICAgKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcbiAgICAgKi9cbiAgICBnZXRDb250YWluZXJFbGVtZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuXyRjb250YWluZXJFbGVtZW50WzBdO1xuICAgIH1cbn0pO1xuXG50dWkudXRpbC5DdXN0b21FdmVudHMubWl4aW4oU3BpbmJveCk7XG5cbm1vZHVsZS5leHBvcnRzID0gU3BpbmJveDtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL3NwaW5ib3guanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IFV0aWxzIGZvciBjYWxlbmRhciBjb21wb25lbnRcbiAqIEBhdXRob3IgTkhOIE5ldC4gRkUgZGV2IExhYi4gPGRsX2phdmFzY3JpcHRAbmhuZW50LmNvbT5cbiAqIEBkZXBlbmRlbmN5IHR1aS1jb2RlLXNuaXBwZXQgXjEuMC4yXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIFV0aWxzIG9mIGNhbGVuZGFyXG4gKiBAbmFtZXNwYWNlIGRhdGVVdGlsXG4gKiBAaWdub3JlXG4gKi9cbnZhciB1dGlscyA9IHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gZGF0ZSBoYXNoIGJ5IHBhcmFtZXRlci5cbiAgICAgKiAgaWYgdGhlcmUgYXJlIDMgcGFyYW1ldGVyLCB0aGUgcGFyYW1ldGVyIGlzIGNvcmduaXplZCBEYXRlIG9iamVjdFxuICAgICAqICBpZiB0aGVyZSBhcmUgbm8gcGFyYW1ldGVyLCByZXR1cm4gdG9kYXkncyBoYXNoIGRhdGVcbiAgICAgKiBAcGFyYW0ge0RhdGV8bnVtYmVyfSBbeWVhcl0gQSBkYXRlIGluc3RhbmNlIG9yIHllYXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW21vbnRoXSBBIG1vbnRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtkYXRlXSBBIGRhdGVcbiAgICAgKiBAcmV0dXJucyB7e3llYXI6ICosIG1vbnRoOiAqLCBkYXRlOiAqfX1cbiAgICAgKi9cbiAgICBnZXREYXRlSGFzaDogZnVuY3Rpb24oeWVhciwgbW9udGgsIGRhdGUpIHtcbiAgICAgICAgdmFyIG5EYXRlO1xuXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMykge1xuICAgICAgICAgICAgbkRhdGUgPSBhcmd1bWVudHNbMF0gfHwgbmV3IERhdGUoKTtcblxuICAgICAgICAgICAgeWVhciA9IG5EYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICBtb250aCA9IG5EYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgICAgICAgICAgZGF0ZSA9IG5EYXRlLmdldERhdGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB5ZWFyOiB5ZWFyLFxuICAgICAgICAgICAgbW9udGg6IG1vbnRoLFxuICAgICAgICAgICAgZGF0ZTogZGF0ZVxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdG9kYXkgdGhhdCBzYXZlZCBvbiBjb21wb25lbnQgb3IgY3JlYXRlIG5ldyBkYXRlLlxuICAgICAqIEByZXR1cm5zIHt7eWVhcjogKiwgbW9udGg6ICosIGRhdGU6ICp9fVxuICAgICAqL1xuICAgIGdldFRvZGF5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHV0aWxzLmdldERhdGVIYXNoKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB1bml4IHRpbWUgZnJvbSBkYXRlIGhhc2hcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0ZSBBIGRhdGUgaGFzaFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlLnllYXIgQSB5ZWFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUubW9udGggQSBtb250aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlLmRhdGUgQSBkYXRlXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHV0aWxzLmdldFRpbWUoe3llYXI6MjAxMCwgbW9udGg6NSwgZGF0ZToxMn0pOyAvLyAxMjczNTkwMDAwMDAwXG4gICAgICovXG4gICAgZ2V0VGltZTogZnVuY3Rpb24oZGF0ZSkge1xuICAgICAgICByZXR1cm4gdXRpbHMuZ2V0RGF0ZU9iamVjdChkYXRlKS5nZXRUaW1lKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB3aGljaCBkYXkgaXMgZmlyc3QgYnkgcGFyYW1ldGVycyB0aGF0IGluY2x1ZGUgeWVhciBhbmQgbW9udGggaW5mb3JtYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSB5ZWFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMH42KVxuICAgICAqL1xuICAgIGdldEZpcnN0RGF5OiBmdW5jdGlvbih5ZWFyLCBtb250aCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCAxKS5nZXREYXkoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0IHdoaWNoIGRheSBpcyBsYXN0IGJ5IHBhcmFtZXRlcnMgdGhhdCBpbmNsdWRlIHllYXIgYW5kIG1vbnRoIGluZm9ybWF0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG4gICAgICogQHJldHVybnMge251bWJlcn0gKDB+NilcbiAgICAgKi9cbiAgICBnZXRMYXN0RGF5OiBmdW5jdGlvbih5ZWFyLCBtb250aCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGgsIDApLmdldERheSgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgbGFzdCBkYXRlIGJ5IHBhcmFtZXRlcnMgdGhhdCBpbmNsdWRlIHllYXIgYW5kIG1vbnRoIGluZm9ybWF0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG4gICAgICogQHJldHVybnMge251bWJlcn0gKDF+MzEpXG4gICAgICovXG4gICAgZ2V0TGFzdERheUluTW9udGg6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkuZ2V0RGF0ZSgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGF0ZSBpbnN0YW5jZS5cbiAgICAgKiBAcGFyYW0ge2RhdGVIYXNofSBkYXRlSGFzaCBBIGRhdGUgaGFzaFxuICAgICAqIEByZXR1cm5zIHtEYXRlfSBEYXRlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgZGF0ZVV0aWwuZ2V0RGF0ZU9iamVjdCh7eWVhcjoyMDEwLCBtb250aDo1LCBkYXRlOjEyfSk7XG4gICAgICogIGRhdGVVdGlsLmdldERhdGVPYmplY3QoMjAxMCwgNSwgMTIpOyAvL3llYXIsbW9udGgsZGF0ZVxuICAgICAqL1xuICAgIGdldERhdGVPYmplY3Q6IGZ1bmN0aW9uKGRhdGVIYXNoKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0gLSAxLCBhcmd1bWVudHNbMl0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGVIYXNoLnllYXIsIGRhdGVIYXNoLm1vbnRoIC0gMSwgZGF0ZUhhc2guZGF0ZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCByZWxhdGVkIGRhdGUgaGFzaCB3aXRoIHBhcmFtZXRlcnMgdGhhdCBpbmNsdWRlIGRhdGUgaW5mb3JtYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSByZWxhdGVkIHZhbHVlIGZvciB5ZWFyKHlvdSBjYW4gdXNlICsvLSlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbW9udGggQSByZWxhdGVkIHZhbHVlIGZvciBtb250aCAoeW91IGNhbiB1c2UgKy8tKVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlIEEgcmVsYXRlZCB2YWx1ZSBmb3IgZGF5ICh5b3UgY2FuIHVzZSArLy0pXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGVPYmogc3RhbmRhcmQgZGF0ZSBoYXNoXG4gICAgICogQHJldHVybnMge09iamVjdH0gZGF0ZU9ialxuICAgICAqIEBleGFtcGxlXG4gICAgICogIGRhdGVVdGlsLmdldFJlbGF0aXZlRGF0ZSgxLCAwLCAwLCB7eWVhcjoyMDAwLCBtb250aDoxLCBkYXRlOjF9KTsgLy8ge3llYXI6MjAwMSwgbW9udGg6MSwgZGF0ZToxfVxuICAgICAqICBkYXRlVXRpbC5nZXRSZWxhdGl2ZURhdGUoMCwgMCwgLTEsIHt5ZWFyOjIwMTAsIG1vbnRoOjEsIGRhdGU6MX0pOyAvLyB7eWVhcjoyMDA5LCBtb250aDoxMiwgZGF0ZTozMX1cbiAgICAgKi9cbiAgICBnZXRSZWxhdGl2ZURhdGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlLCBkYXRlT2JqKSB7XG4gICAgICAgIHZhciBuWWVhciA9IChkYXRlT2JqLnllYXIgKyB5ZWFyKSxcbiAgICAgICAgICAgIG5Nb250aCA9IChkYXRlT2JqLm1vbnRoICsgbW9udGggLSAxKSxcbiAgICAgICAgICAgIG5EYXRlID0gKGRhdGVPYmouZGF0ZSArIGRhdGUpLFxuICAgICAgICAgICAgbkRhdGVPYmogPSBuZXcgRGF0ZShuWWVhciwgbk1vbnRoLCBuRGF0ZSk7XG5cbiAgICAgICAgcmV0dXJuIHV0aWxzLmdldERhdGVIYXNoKG5EYXRlT2JqKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQmluYXJ5IHNlYXJjaFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGZpZWxkIC0gU2VhcmNoIGZpZWxkXG4gICAgICogQHBhcmFtIHtBcnJheX0gdmFsdWUgLSBTZWFyY2ggdGFyZ2V0XG4gICAgICogQHJldHVybnMge3tmb3VuZDogYm9vbGVhbiwgaW5kZXg6IG51bWJlcn19IFJlc3VsdFxuICAgICAqL1xuICAgIHNlYXJjaDogZnVuY3Rpb24oZmllbGQsIHZhbHVlKSB7XG4gICAgICAgIHZhciBmb3VuZCA9IGZhbHNlLFxuICAgICAgICAgICAgbG93ID0gMCxcbiAgICAgICAgICAgIGhpZ2ggPSBmaWVsZC5sZW5ndGggLSAxLFxuICAgICAgICAgICAgZW5kLCBpbmRleCwgZmllbGRWYWx1ZTtcblxuICAgICAgICB3aGlsZSAoIWZvdW5kICYmICFlbmQpIHtcbiAgICAgICAgICAgIGluZGV4ID0gTWF0aC5mbG9vcigobG93ICsgaGlnaCkgLyAyKTtcbiAgICAgICAgICAgIGZpZWxkVmFsdWUgPSBmaWVsZFtpbmRleF07XG5cbiAgICAgICAgICAgIGlmIChmaWVsZFZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmllbGRWYWx1ZSA8IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbG93ID0gaW5kZXggKyAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoaWdoID0gaW5kZXggLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZW5kID0gKGxvdyA+IGhpZ2gpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZvdW5kOiBmb3VuZCxcbiAgICAgICAgICAgIGluZGV4OiAoZm91bmQgfHwgZmllbGRWYWx1ZSA+IHZhbHVlKSA/IGluZGV4IDogaW5kZXggKyAxXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBtZXJpZGllbSBob3VyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhvdXIgLSBPcmlnaW5hbCBob3VyXG4gICAgICogQHJldHVybnMge251bWJlcn0gQ29udmVydGVkIG1lcmlkaWVtIGhvdXJcbiAgICAgKi9cbiAgICBnZXRNZXJpZGllbUhvdXI6IGZ1bmN0aW9uKGhvdXIpIHtcbiAgICAgICAgaG91ciAlPSAxMjtcblxuICAgICAgICBpZiAoaG91ciA9PT0gMCkge1xuICAgICAgICAgICAgaG91ciA9IDEyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGhvdXI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIHR3byBkYXRlSGFzaCBvYmplY3RzIGFyZSBlcXVhbFxuICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGEgLSBkYXRlSGFzaFxuICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGIgLSBkYXRlSGFzaFxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIGlzRXF1YWxEYXRlSGFzaDogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICByZXR1cm4gYS55ZWFyID09PSBiLnllYXJcbiAgICAgICAgICAgICYmIGEubW9udGggPT09IGIubW9udGhcbiAgICAgICAgICAgICYmIGEuZGF0ZSA9PT0gYi5kYXRlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIG51bWJlciBvciBkZWZhdWx0XG4gICAgICogQHBhcmFtIHsqfSBhbnkgLSBBbnkgdmFsdWVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZGVmYXVsdE51bWJlciAtIERlZmF1bHQgbnVtYmVyXG4gICAgICogQHRocm93cyBXaWxsIHRocm93IGFuIGVycm9yIGlmIHRoZSBkZWZhdWx0TnVtYmVyIGlzIGludmFsaWQuXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXRTYWZlTnVtYmVyOiBmdW5jdGlvbihhbnksIGRlZmF1bHROdW1iZXIpIHtcbiAgICAgICAgaWYgKGlzTmFOKGRlZmF1bHROdW1iZXIpIHx8ICF0dWkudXRpbC5pc051bWJlcihkZWZhdWx0TnVtYmVyKSkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ1RoZSBkZWZhdWx0TnVtYmVyIG11c3QgYmUgYSB2YWxpZCBudW1iZXIuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTmFOKGFueSkpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0TnVtYmVyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIE51bWJlcihhbnkpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gdXRpbHM7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy91dGlscy5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIEBmaWxlb3ZlcnZpZXcgVGhpcyBjb21wb25lbnQgcHJvdmlkZXMgYSBjYWxlbmRhciBmb3IgcGlja2luZyBhIGRhdGUgJiB0aW1lLlxuICogQGF1dGhvciBOSE4gZW50IEZFIGRldiBMYWIgPGRsX2phdmFzY3JpcHRAbmhuZW50LmNvbT5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgZGF0ZVV0aWwgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG5cbnZhciB1dGlsID0gdHVpLnV0aWw7XG52YXIgZXh0ZW5kID0gdXRpbC5leHRlbmQ7XG52YXIgYmluZCA9IHV0aWwuYmluZDtcbnZhciBmb3JFYWNoID0gdXRpbC5mb3JFYWNoO1xudmFyIGlzTnVtYmVyID0gdXRpbC5pc051bWJlcjtcbnZhciBjb21wYXJlSlNPTiA9IHV0aWwuY29tcGFyZUpTT047XG52YXIgaXNHcmVhdGVyVGhhbk9yRXF1YWxUbyA9IGZ1bmN0aW9uKGEsIGIsIGNvbXBhcmluZ0xldmVsKSB7XG4gICAgY29tcGFyaW5nTGV2ZWwgPSBjb21wYXJpbmdMZXZlbCB8fCAxO1xuXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoKGEgLyBjb21wYXJpbmdMZXZlbCkpID49IE1hdGguZmxvb3IoKGIgLyBjb21wYXJpbmdMZXZlbCkpO1xufTtcblxudmFyIGluQXJyYXkgPSB1dGlsLmluQXJyYXk7XG52YXIgZm9ybWF0UmVnRXhwID0gL3l5eXl8eXl8bW18bXxkZHxkL2dpO1xudmFyIG1hcEZvckNvbnZlcnRpbmcgPSB7XG4gICAgeXl5eToge1xuICAgICAgICBleHByZXNzaW9uOiAnKFxcXFxkezR9fFxcXFxkezJ9KScsXG4gICAgICAgIHR5cGU6ICd5ZWFyJ1xuICAgIH0sXG4gICAgeXk6IHtcbiAgICAgICAgZXhwcmVzc2lvbjogJyhcXFxcZHs0fXxcXFxcZHsyfSknLFxuICAgICAgICB0eXBlOiAneWVhcidcbiAgICB9LFxuICAgIHk6IHtcbiAgICAgICAgZXhwcmVzc2lvbjogJyhcXFxcZHs0fXxcXFxcZHsyfSknLFxuICAgICAgICB0eXBlOiAneWVhcidcbiAgICB9LFxuICAgIG1tOiB7XG4gICAgICAgIGV4cHJlc3Npb246ICcoMVswMTJdfDBbMS05XXxbMS05XVxcXFxiKScsXG4gICAgICAgIHR5cGU6ICdtb250aCdcbiAgICB9LFxuICAgIG06IHtcbiAgICAgICAgZXhwcmVzc2lvbjogJygxWzAxMl18MFsxLTldfFsxLTldXFxcXGIpJyxcbiAgICAgICAgdHlwZTogJ21vbnRoJ1xuICAgIH0sXG4gICAgZGQ6IHtcbiAgICAgICAgZXhwcmVzc2lvbjogJyhbMTJdXFxcXGR7MX18M1swMV18MFsxLTldfFsxLTldXFxcXGIpJyxcbiAgICAgICAgdHlwZTogJ2RhdGUnXG4gICAgfSxcbiAgICBkOiB7XG4gICAgICAgIGV4cHJlc3Npb246ICcoWzEyXVxcXFxkezF9fDNbMDFdfDBbMS05XXxbMS05XVxcXFxiKScsXG4gICAgICAgIHR5cGU6ICdkYXRlJ1xuICAgIH1cbn07XG52YXIgREFURV9MQVlFUiA9ICdkYXRlJztcbnZhciBNT05USF9MQVlFUiA9ICdtb250aCc7XG52YXIgWUVBUl9MQVlFUiA9ICd5ZWFyJztcbnZhciBNSU5fWUVBUiA9IDE5MDA7XG52YXIgTUFYX1lFQVIgPSAyOTk5O1xudmFyIFdSQVBQRVJfVEFHID0gJzxkaXYgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTtcIj48L2Rpdj4nO1xudmFyIE1JTl9FREdFID0gTnVtYmVyKG5ldyBEYXRlKDApKTtcbnZhciBNQVhfRURHRSA9IE51bWJlcihuZXcgRGF0ZSgyOTk5LCAxMSwgMzEpKTtcbnZhciBZRUFSX1RPX01TID0gMzE1MzYwMDAwMDA7XG52YXIgTU9OVEhfVE9fTVMgPSAyNjI4MDAwMDAwO1xudmFyIFJFTEFUSVZFX01PTlRIX1ZBTFVFX0tFWSA9ICdyZWxhdGl2ZU1vbnRoVmFsdWUnO1xuXG52YXIgbGF5ZXJzID0gW0RBVEVfTEFZRVIsIE1PTlRIX0xBWUVSLCBZRUFSX0xBWUVSXTtcbnZhciBwb3NpdGlvbkZyb21Cb3VuZGluZ0tleU1hcHBlciA9IHtcbiAgICBsZWZ0OiAnbGVmdCcsXG4gICAgdG9wOiAnYm90dG9tJ1xufTtcbnZhciBkYXRlS2V5cyA9IFsnZGQnLCAnZCddO1xudmFyIG1vbnRoS2V5cyA9IFsnbW0nLCAnbSddO1xudmFyIHllYXJLZXlzID0gWyd5eXl5JywgJ3l5JywgJ3knXTtcblxuLyoqXG4gKiBBIG51bWJlciwgb3IgYSBzdHJpbmcgY29udGFpbmluZyBhIG51bWJlci5cbiAqIEB0eXBlZGVmIHtPYmplY3R9IGRhdGVIYXNoXG4gKiBAcHJvcGVydHkge251bWJlcn0geWVhciAtIDE5NzB+Mjk5OVxuICogQHByb3BlcnR5IHtudW1iZXJ9IG1vbnRoIC0gMX4xMlxuICogQHByb3BlcnR5IHtudW1iZXJ9IGRhdGUgLSAxfjMxXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7RnVuY3Rpb259IENhbGVuZGFyXG4gKiBAc2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vbmhuZW50L3R1aS5jb21wb25lbnQuY2FsZW5kYXJ9XG4gKi9cblxuLyoqXG4gKiBDcmVhdGUgRGF0ZVBpY2tlcjxicj5cbiAqIFlvdSBjYW4gZ2V0IGEgZGF0ZSBmcm9tICdnZXRZZWFyJywgJ2dldE1vbnRoJywgJ2dldERheUluTW9udGgnLCAnZ2V0RGF0ZUhhc2gnXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb24gLSBPcHRpb25zXG4gKiAgICAgIEBwYXJhbSB7SFRNTEVsZW1lbnR8c3RyaW5nfGpRdWVyeX0gb3B0aW9uLmVsZW1lbnQgLSBJbnB1dCBlbGVtZW50KG9yIHNlbGVjdG9yKSBvZiBEYXRlUGlja2VyXG4gKiAgICAgIEBwYXJhbSB7ZGF0ZUhhc2h8J2JsYW5rJ30gW29wdGlvbi5kYXRlID0gdG9kYXldIC0gSW5pdGlhbCBkYXRlIG9iamVjdC4gSWYgbm8gd2FudCBpbml0aWFsIGRhdGV0aW1lLCB0eXBlIFwiYmxhbmtcIlxuICogICAgICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbi5kYXRlRm9ybWF0ID0gJ3l5eXktbW0tZGQnXSAtIERhdGUgc3RyaW5nIGZvcm1hdFxuICogICAgICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbi5kZWZhdWx0Q2VudHVyeSA9IDIwXSAtIERlZmF1bHQgY2VudHVyeSBmb3IgJ3l5JyBmb3JtYXQuXG4gKiAgICAgIEBwYXJhbSB7SFRNTEVsZW1lbnR8c3RyaW5nfGpRdWVyeX0gW29wdGlvbi5wYXJlbnRFbGVtZW50XSAtIFRoZSB3cmFwcGVyIGVsZW1lbnQgd2lsbCBiZSBpbnNlcnRlZCBpbnRvXG4gKiAgICAgICAgICAgdGhpcyBlbGVtZW50LiAoc2luY2UgMS4zLjApXG4gKiAgICAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLnNlbGVjdGFibGVDbGFzc05hbWUgPSAnc2VsZWN0YWJsZSddIC0gRm9yIHNlbGVjdGFibGUgZGF0ZSBlbGVtZW50c1xuICogICAgICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbi5zZWxlY3RlZENsYXNzTmFtZSA9ICdzZWxlY3RlZCddIC0gRm9yIHNlbGVjdGVkIGRhdGUgZWxlbWVudFxuICogICAgICBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb24uZW5hYmxlU2V0RGF0ZUJ5RW50ZXJLZXkgPSB0cnVlXSAtIFNldCBkYXRlIHdoZW4gdGhlICdFbnRlcicga2V5IHByZXNzZWQgKHNpbmNlIDEuMy4wKVxuICogICAgICBAcGFyYW0ge0FycmF5LjxBcnJheS48ZGF0ZUhhc2g+Pn0gW29wdGlvbnMuc2VsZWN0YWJsZVJhbmdlc10gLSBTZWxlY3RhYmxlIGRhdGUgcmFuZ2VzLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VlIHRoaXMgZXhhbXBsZSBcIntAdHV0b3JpYWwgc2FtcGxlNX1cIlxuICogICAgICBAcGFyYW0ge09iamVjdH0gW29wdGlvbi5wb3NdIC0gY2FsZW5kYXIgcG9zaXRpb24gc3R5bGUgdmFsdWVcbiAqICAgICAgICAgIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9uLnBvcy5sZWZ0XSAtIHBvc2l0aW9uIGxlZnQgb2YgY2FsZW5kYXJcbiAqICAgICAgICAgIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9uLnBvcy50b3BdIC0gcG9zaXRpb24gdG9wIG9mIGNhbGVuZGFyXG4gKiAgICAgICAgICBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5wb3MuekluZGV4XSAtIHotaW5kZXggb2YgY2FsZW5kYXJcbiAqICAgICAgQHBhcmFtIHtPYmplY3R9IFtvcHRpb24ub3BlbmVycyA9IFtlbGVtZW50XV0gLSBvcGVuZXIgYnV0dG9uIGxpc3QgKGV4YW1wbGUgLSBpY29uLCBidXR0b24sIGV0Yy4pXG4gKiAgICAgIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbi5zaG93QWx3YXlzID0gZmFsc2VdIC0gd2hldGhlciB0aGUgZGF0ZXBpY2tlciBzaG93cyB0aGUgY2FsZW5kYXIgYWx3YXlzXG4gKiAgICAgIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbi51c2VUb3VjaEV2ZW50ID0gdHJ1ZV0gLSB3aGV0aGVyIHRoZSBkYXRlcGlja2VyIHVzZXMgdG91Y2ggZXZlbnRzXG4gKiAgICAgIEBwYXJhbSB7VGltZVBpY2tlcn0gW29wdGlvbi50aW1lUGlja2VyXSAtIFRpbWVQaWNrZXIgaW5zdGFuY2VcbiAqIEBwYXJhbSB7Q2FsZW5kYXJ9IGNhbGVuZGFyIC0gQ2FsZW5kYXIgaW5zdGFuY2VcbiAqIEBleGFtcGxlXG4gKiAgIHZhciBjYWxlbmRhciA9IG5ldyB0dWkuY29tcG9uZW50LkNhbGVuZGFyKHtcbiAqICAgICAgIGVsZW1lbnQ6ICcjbGF5ZXInLFxuICogICAgICAgdGl0bGVGb3JtYXQ6ICd5eXl564WEIG3sm5QnLFxuICogICAgICAgdG9kYXlGb3JtYXQ6ICd5eXl564WEIG1t7JuUIGRk7J28IChEKSdcbiAqICAgfSk7XG4gKlxuICogICB2YXIgdGltZVBpY2tlciA9IG5ldyB0dWkuY29tcG9uZW50LlRpbWVQaWNrZXIoe1xuICogICAgICAgc2hvd01lcmlkaWFuOiB0cnVlLFxuICogICAgICAgZGVmYXVsdEhvdXI6IDEzLFxuICogICAgICAgZGVmYXVsdE1pbnV0ZTogMjRcbiAqICAgfSk7XG4gKlxuICogICB2YXIgcmFuZ2UxID0gW1xuICogICAgICAgICAge3llYXI6IDIwMTUsIG1vbnRoOjEsIGRhdGU6IDF9LFxuICogICAgICAgICAge3llYXI6IDIwMTUsIG1vbnRoOjIsIGRhdGU6IDF9XG4gKiAgICAgIF0sXG4gKiAgICAgIHJhbmdlMiA9IFtcbiAqICAgICAgICAgIHt5ZWFyOiAyMDE1LCBtb250aDozLCBkYXRlOiAxfSxcbiAqICAgICAgICAgIHt5ZWFyOiAyMDE1LCBtb250aDo0LCBkYXRlOiAxfVxuICogICAgICBdLFxuICogICAgICByYW5nZTMgPSBbXG4gKiAgICAgICAgICB7eWVhcjogMjAxNSwgbW9udGg6NiwgZGF0ZTogMX0sXG4gKiAgICAgICAgICB7eWVhcjogMjAxNSwgbW9udGg6NywgZGF0ZTogMX1cbiAqICAgICAgXTtcbiAqXG4gKiAgIHZhciBwaWNrZXIxID0gbmV3IHR1aS5jb21wb25lbnQuRGF0ZVBpY2tlcih7XG4gKiAgICAgICBlbGVtZW50OiAnI3BpY2tlcicsXG4gKiAgICAgICBkYXRlRm9ybWF0OiAneXl5eeuFhCBtbeyblCBkZOydvCAtICcsXG4gKiAgICAgICAvL2RhdGVGb3JtYXQ6ICd5eXl564WEIG1t7JuUJyxcbiAqICAgICAgIC8vZGF0ZUZvcm1hdDogJ3l5eXnrhYQnLFxuICogICAgICAgZGF0ZToge3llYXI6IDIwMTUsIG1vbnRoOiAxLCBkYXRlOiAxfSwgLy8gb3Igc3RyaW5nIGxpdGVyYWwgJ2JsYW5rJyB3aXRob3V0IGRlZmF1bHQgZGF0ZSBhc3NpZ25cbiAqICAgICAgIHNlbGVjdGFibGVSYW5nZXM6IFtyYW5nZTEsIHJhbmdlMiwgcmFuZ2UzXSxcbiAqICAgICAgIG9wZW5lcnM6IFsnI29wZW5lciddLFxuICogICAgICAgdGltZVBpY2tlcjogdGltZVBpY2tlclxuICogICB9LCBjYWxlbmRhcik7XG4gKlxuICogICAvLyBDbG9zZSBjYWxlbmRhciB3aGVuIHNlbGVjdCBhIGRhdGVcbiAqICAgJCgnI2xheWVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAqICAgICAgIHZhciAkZWwgPSAkKGV2ZW50LnRhcmdldCk7XG4gKlxuICogICAgICAgaWYgKCRlbC5oYXNDbGFzcygnc2VsZWN0YWJsZScpKSB7XG4gKiAgICAgICAgICAgcGlja2VyMS5jbG9zZSgpO1xuICogICAgICAgfVxuICogICB9KTtcbiAqXG4gKiBAdHV0b3JpYWwgc2FtcGxlMVxuICogQHR1dG9yaWFsIHNhbXBsZTJcbiAqIEB0dXRvcmlhbCBzYW1wbGU1XG4gKiBAdHV0b3JpYWwgc2FtcGxlNlxuICovXG52YXIgRGF0ZVBpY2tlciA9IHV0aWwuZGVmaW5lQ2xhc3MoLyoqIEBsZW5kcyBEYXRlUGlja2VyLnByb3RvdHlwZSAqL3tcbiAgICBpbml0OiBmdW5jdGlvbihvcHRpb24sIGNhbGVuZGFyKSB7XG4gICAgICAgIC8vIHNldCBkZWZhdWx0c1xuICAgICAgICBvcHRpb24gPSBleHRlbmQoe1xuICAgICAgICAgICAgZGF0ZUZvcm1hdDogJ3l5eXktbW0tZGQgJyxcbiAgICAgICAgICAgIGRlZmF1bHRDZW50dXJ5OiAnMjAnLFxuICAgICAgICAgICAgZGlzYWJsZWRDbGFzc05hbWU6ICdkaXNhYmxlZCcsXG4gICAgICAgICAgICBzZWxlY3RhYmxlQ2xhc3NOYW1lOiAnc2VsZWN0YWJsZScsXG4gICAgICAgICAgICBzZWxlY3RlZENsYXNzTmFtZTogJ3NlbGVjdGVkJyxcbiAgICAgICAgICAgIHNlbGVjdGFibGVSYW5nZXM6IFtdLFxuICAgICAgICAgICAgZW5hYmxlU2V0RGF0ZUJ5RW50ZXJLZXk6IHRydWUsXG4gICAgICAgICAgICBzaG93QWx3YXlzOiBmYWxzZSxcbiAgICAgICAgICAgIHVzZVRvdWNoRXZlbnQ6IHRydWVcbiAgICAgICAgfSwgb3B0aW9uKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsZW5kYXIgaW5zdGFuY2VcbiAgICAgICAgICogQHR5cGUge0NhbGVuZGFyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fY2FsZW5kYXIgPSBjYWxlbmRhcjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRWxlbWVudCBmb3IgZGlzcGxheWluZyBhIGRhdGUgdmFsdWVcbiAgICAgICAgICogQHR5cGUge0hUTUxFbGVtZW50fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fJGVsZW1lbnQgPSAkKG9wdGlvbi5lbGVtZW50KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRWxlbWVudCB3cmFwcGluZyBjYWxlbmRhclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl8kd3JhcHBlckVsZW1lbnQgPSAkKFdSQVBQRVJfVEFHKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRm9ybWF0IG9mIGRhdGUgc3RyaW5nXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9kYXRlRm9ybWF0ID0gb3B0aW9uLmRhdGVGb3JtIHx8IG9wdGlvbi5kYXRlRm9ybWF0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZWdFeHAgaW5zdGFuY2UgZm9yIGZvcm1hdCBvZiBkYXRlIHN0cmluZ1xuICAgICAgICAgKiBAdHlwZSB7UmVnRXhwfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcmVnRXhwID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQXJyYXkgc2F2aW5nIGEgb3JkZXIgb2YgZm9ybWF0XG4gICAgICAgICAqIEB0eXBlIHtBcnJheX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHNlZSB7RGF0ZVBpY2tlci5wcm90b3R5cGUuc2V0RGF0ZUZvcm19XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIElmIHRoZSBmb3JtYXQgaXMgYSAnbW0tZGQsIHl5eXknXG4gICAgICAgICAqIC8vIGB0aGlzLl9mb3JtT3JkZXJgIGlzIFsnbW9udGgnLCAnZGF0ZScsICd5ZWFyJ11cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2Zvcm1PcmRlciA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPYmplY3QgaGF2aW5nIGRhdGUgdmFsdWVzXG4gICAgICAgICAqIEB0eXBlIHtkYXRlSGFzaH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2RhdGUgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIHZhbHVlIGlzIHByZXBlbmRlZCBhdXRvbWF0aWNhbGx5IHdoZW4geWVhci1mb3JtYXQgaXMgJ3l5J1xuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiAvL1xuICAgICAgICAgKiAvLyBJZiB0aGlzIHZhbHVlIGlzICcyMCcsIHRoZSBmb3JtYXQgaXMgJ3l5LW1tLWRkJyBhbmQgdGhlIGRhdGUgc3RyaW5nIGlzICcxNS0wNC0xMicsXG4gICAgICAgICAqIC8vIHRoZSBkYXRlIHZhbHVlIG9iamVjdCBpc1xuICAgICAgICAgKiAvLyAge1xuICAgICAgICAgKiAvLyAgICAgIHllYXI6IDIwMTUsXG4gICAgICAgICAqIC8vICAgICAgbW9udGg6IDQsXG4gICAgICAgICAqIC8vICAgICAgZGF0ZTogMTJcbiAgICAgICAgICogLy8gIH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2RlZmF1bHRDZW50dXJ5ID0gb3B0aW9uLmRlZmF1bHRDZW50dXJ5O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDbGFzcyBuYW1lIGZvciBzZWxlY3RhYmxlIGRhdGUgZWxlbWVudHNcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3NlbGVjdGFibGVDbGFzc05hbWUgPSBvcHRpb24uc2VsZWN0YWJsZUNsYXNzTmFtZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2xhc3MgbmFtZSBmb3Igc2VsZWN0ZWQgZGF0ZSBlbGVtZW50XG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9zZWxlY3RlZENsYXNzTmFtZSA9IG9wdGlvbi5zZWxlY3RlZENsYXNzTmFtZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBzZXQgZGF0ZSBmcm9tIHRoZSBpbnB1dCB2YWx1ZSB3aGVuIHRoZSAnRW50ZXInIGtleSBwcmVzc2VkXG4gICAgICAgICAqIEB0eXBlIHtCb29sZWFufVxuICAgICAgICAgKiBAc2luY2UgMS4zLjBcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2VuYWJsZVNldERhdGVCeUVudGVyS2V5ID0gb3B0aW9uLmVuYWJsZVNldERhdGVCeUVudGVyS2V5O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJdCBpcyBzdGFydCB0aW1lc3RhbXBzIGZyb20gdGhpcy5fcmFuZ2VzXG4gICAgICAgICAqIEB0eXBlIHtBcnJheS48bnVtYmVyPn1cbiAgICAgICAgICogQHNpbmNlIDEuMi4wXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9zdGFydFRpbWVzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEl0IGlzIGVuZCB0aW1lc3RhbXBzIGZyb20gdGhpcy5fcmFuZ2VzXG4gICAgICAgICAqIEB0eXBlIHtBcnJheS48bnVtYmVyPn1cbiAgICAgICAgICogQHNpbmNlIDEuMi4wXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9lbmRUaW1lcyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZWxlY3RhYmxlIGRhdGUgcmFuZ2VzXG4gICAgICAgICAqIEB0eXBlIHtBcnJheS48QXJyYXkuPGRhdGVIYXNoPj59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBzaW5jZSAxLjIuMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcmFuZ2VzID0gb3B0aW9uLnNlbGVjdGFibGVSYW5nZXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRpbWVQaWNrZXIgaW5zdGFuY2VcbiAgICAgICAgICogQHR5cGUge1RpbWVQaWNrZXJ9XG4gICAgICAgICAqIEBzaW5jZSAxLjEuMFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGltZVBpY2tlciA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHBvc2l0aW9uIC0gbGVmdCAmIHRvcCAmIHpJbmRleFxuICAgICAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAc2luY2UgMS4xLjFcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3BvcyA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIG9wZW5lcnMgLSBvcGVuZXIgbGlzdFxuICAgICAgICAgKiBAdHlwZSB7QXJyYXl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBzaW5jZSAxLjEuMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fb3BlbmVycyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIYW5kbGVycyBiaW5kaW5nIGNvbnRleHRcbiAgICAgICAgICogQHR5cGUge09iamVjdH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3Byb3h5SGFuZGxlcnMgPSB7fTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5kZXggb2Ygc2hvd24gbGF5ZXJcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3Nob3duTGF5ZXJJZHggPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdGF0ZSBvZiBwaWNrZXIgZW5hYmxlXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAc2luY2UgMS40LjBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2VuYWJsZWRTdGF0ZSA9IHRydWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENsYXNzIG5hbWUgZm9yIGRpc2FibGVkIGRhdGUgZWxlbWVudFxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAc2luY2UgMS40LjBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2Rpc2FibGVkQ2xhc3NOYW1lID0gb3B0aW9uLmRpc2FibGVkQ2xhc3NOYW1lO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIHRoZSBkYXRlcGlja2VyIHNob3dzIGFsd2F5c1xuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgICAgICogQHNpbmNlIDEuMi4wXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIGRhdGVwaWNrZXIuc2hvd0Fsd2F5cyA9IHRydWU7XG4gICAgICAgICAqIGRhdGVwaWNrZXIub3BlbigpO1xuICAgICAgICAgKiAvLyBUaGUgZGF0ZXBpY2tlciB3aWxsIGJlIG5vdCBjbG9zZWQgaWYgeW91IGNsaWNrIHRoZSBvdXRzaWRlIG9mIHRoZSBkYXRlcGlja2VyXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNob3dBbHdheXMgPSBvcHRpb24uc2hvd0Fsd2F5cztcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB0aGUgZGF0ZXBpY2tlciB1c2UgdG91Y2ggZXZlbnQuXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAgICAgKiBAc2luY2UgMS4yLjBcbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogZGF0ZXBpY2tlci51c2VUb3VjaEV2ZW50ID0gZmFsc2U7XG4gICAgICAgICAqIC8vIFRoZSBkYXRlcGlja2VyIHdpbGwgYmUgdXNlIG9ubHkgJ2NsaWNrJywgJ21vdXNlZG93bicgZXZlbnRzXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVzZVRvdWNoRXZlbnQgPSAhIShcbiAgICAgICAgICAgICgoJ2NyZWF0ZVRvdWNoJyBpbiBkb2N1bWVudCkgfHwgKCdvbnRvdWNoc3RhcnQnIGluIGRvY3VtZW50KSkgJiZcbiAgICAgICAgICAgIG9wdGlvbi51c2VUb3VjaEV2ZW50XG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZURhdGVQaWNrZXIob3B0aW9uKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBtZXRob2RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uIC0gdXNlciBvcHRpb25cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9pbml0aWFsaXplRGF0ZVBpY2tlcjogZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgICAgIHRoaXMuX3JhbmdlcyA9IHRoaXMuX2ZpbHRlclZhbGlkUmFuZ2VzKHRoaXMuX3Jhbmdlcyk7XG5cbiAgICAgICAgdGhpcy5fZGV0YWNoQ2FsZW5kYXJFdmVudCgpO1xuICAgICAgICB0aGlzLl9zZXRTZWxlY3RhYmxlUmFuZ2VzKCk7XG4gICAgICAgIHRoaXMuX3NldFdyYXBwZXJFbGVtZW50KG9wdGlvbi5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fc2V0RGVmYXVsdERhdGUob3B0aW9uLmRhdGUpO1xuICAgICAgICB0aGlzLl9zZXREZWZhdWx0UG9zaXRpb24ob3B0aW9uLnBvcyk7XG4gICAgICAgIHRoaXMuX3NldFByb3h5SGFuZGxlcnMoKTtcbiAgICAgICAgdGhpcy5fc2V0T3BlbmVycyhvcHRpb24ub3BlbmVycyk7XG4gICAgICAgIHRoaXMuX2JpbmRLZXlkb3duRXZlbnQodGhpcy5fJGVsZW1lbnQpO1xuICAgICAgICB0aGlzLl9zZXRUaW1lUGlja2VyKG9wdGlvbi50aW1lUGlja2VyKTtcbiAgICAgICAgdGhpcy5zZXREYXRlRm9ybSgpO1xuXG4gICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5oaWRlKCk7XG4gICAgICAgIHRoaXMuX2NhbGVuZGFyLiRlbGVtZW50LnNob3coKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogTG9va3MgdGhyb3VnaCBlYWNoIHZhbHVlIGluIHRoZSByYW5nZXMsIHJldHVybmluZyBhbiBhcnJheSBvZiBvbmx5IHZhbGlkIHJhbmdlcy5cbiAgICAgKiBAcGFyYW0ge0FycmF5LjxBcnJheS48ZGF0ZUhhc2g+Pn0gcmFuZ2VzIC0gcmFuZ2VzXG4gICAgICogQHJldHVybnMge0FycmF5LjxBcnJheS48ZGF0ZUhhc2g+Pn0gZmlsdGVyZWQgcmFuZ2VzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZmlsdGVyVmFsaWRSYW5nZXM6IGZ1bmN0aW9uKHJhbmdlcykge1xuICAgICAgICB2YXIgc3RhcnRIYXNoLCBlbmRIYXNoO1xuXG4gICAgICAgIHJldHVybiB1dGlsLmZpbHRlcihyYW5nZXMsIGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICAgICAgICBzdGFydEhhc2ggPSByYW5nZVswXTtcbiAgICAgICAgICAgIGVuZEhhc2ggPSByYW5nZVsxXTtcbiAgICAgICAgICAgIHRoaXMuX3NldEhhc2hJblJhbmdlKHN0YXJ0SGFzaCwgZW5kSGFzaCk7XG5cbiAgICAgICAgICAgIHJldHVybiAodGhpcy5faXNWYWxpZERhdGVIYXNoKHN0YXJ0SGFzaCkgJiYgdGhpcy5faXNWYWxpZERhdGVIYXNoKGVuZEhhc2gpKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERldGFjaCBldmVudCBvbiBjYWxlbmRhclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2RldGFjaENhbGVuZGFyRXZlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9jYWxlbmRhci5kZXRhY2hFdmVudFRvQm9keSgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXQgd3JhcHBlciBlbGVtZW50KD0gY29udGFpbmVyKVxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBbcGFyZW50RWxlbWVudF0gLSBwYXJlbnQgZWxlbWVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldFdyYXBwZXJFbGVtZW50OiBmdW5jdGlvbihwYXJlbnRFbGVtZW50KSB7XG4gICAgICAgIHZhciAkd3JhcHBlckVsZW1lbnQgPSB0aGlzLl8kd3JhcHBlckVsZW1lbnQ7XG4gICAgICAgIHZhciAkcGFyZW50RWxlbWVudCA9ICQocGFyZW50RWxlbWVudCk7XG5cbiAgICAgICAgJHdyYXBwZXJFbGVtZW50LmFwcGVuZCh0aGlzLl9jYWxlbmRhci4kZWxlbWVudCk7XG5cbiAgICAgICAgaWYgKCRwYXJlbnRFbGVtZW50WzBdKSB7XG4gICAgICAgICAgICAkd3JhcHBlckVsZW1lbnQuYXBwZW5kVG8oJHBhcmVudEVsZW1lbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuXyRlbGVtZW50WzBdKSB7XG4gICAgICAgICAgICAkd3JhcHBlckVsZW1lbnQuaW5zZXJ0QWZ0ZXIodGhpcy5fJGVsZW1lbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHdyYXBwZXJFbGVtZW50LmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBkZWZhdWx0IGRhdGVcbiAgICAgKiBAcGFyYW0ge2RhdGVIYXNofHN0cmluZ30gb3BEYXRlIC0gdXNlciBzZXR0aW5nOiBkYXRlXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAdG9kbyBSZWZhY3RvcjogSW50ZWdyYXRlIHdpdGggXCJzZXREYXRlXCIgbWV0aG9kLlxuICAgICAqL1xuICAgIF9zZXREZWZhdWx0RGF0ZTogZnVuY3Rpb24ob3BEYXRlKSB7XG4gICAgICAgIGlmICgvXmJsYW5rJC9pLnRlc3Qob3BEYXRlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFvcERhdGUpIHtcbiAgICAgICAgICAgIG9wRGF0ZSA9IGRhdGVVdGlsLmdldFRvZGF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvcERhdGUgPSB7XG4gICAgICAgICAgICAgICAgeWVhcjogZGF0ZVV0aWwuZ2V0U2FmZU51bWJlcihvcERhdGUueWVhciwgTUlOX1lFQVIpLFxuICAgICAgICAgICAgICAgIG1vbnRoOiBkYXRlVXRpbC5nZXRTYWZlTnVtYmVyKG9wRGF0ZS5tb250aCwgMSksXG4gICAgICAgICAgICAgICAgZGF0ZTogZGF0ZVV0aWwuZ2V0U2FmZU51bWJlcihvcERhdGUuZGF0ZSwgMSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9zZXRTaG93bkxheWVySW5kZXhCeUZvcm0oKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzU2VsZWN0YWJsZShvcERhdGUsIHRoaXMuX2dldEN1cnJlbnRMYXllcigpKSkge1xuICAgICAgICAgICAgdGhpcy5fZGF0ZSA9IG9wRGF0ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTYXZlIGRlZmF1bHQgc3R5bGUtcG9zaXRpb24gb2YgY2FsZW5kYXJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3BQb3MgW29wdGlvbi5wb3NdIC0gdXNlciBzZXR0aW5nOiBwb3NpdGlvbihsZWZ0LCB0b3AsIHpJbmRleClcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXREZWZhdWx0UG9zaXRpb246IGZ1bmN0aW9uKG9wUG9zKSB7XG4gICAgICAgIHZhciBwb3MgPSB0aGlzLl9wb3MgPSBvcFBvcyB8fCB7fTtcbiAgICAgICAgdmFyIGJvdW5kID0gdGhpcy5fZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgaWYgKCFpc051bWJlcihwb3MuekluZGV4KSkge1xuICAgICAgICAgICAgcG9zLnpJbmRleCA9IDk5OTk7XG4gICAgICAgIH1cblxuICAgICAgICB1dGlsLmZvckVhY2gocG9zaXRpb25Gcm9tQm91bmRpbmdLZXlNYXBwZXIsIGZ1bmN0aW9uKGJvdW5kaW5nS2V5LCBwb3NLZXkpIHtcbiAgICAgICAgICAgIGlmICghaXNOdW1iZXIocG9zW3Bvc0tleV0pKSB7XG4gICAgICAgICAgICAgICAgcG9zW3Bvc0tleV0gPSBib3VuZFtib3VuZGluZ0tleV0gfHwgMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBzdGFydC9lbmQgZWRnZSBmcm9tIHNlbGVjdGFibGUtcmFuZ2VzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0U2VsZWN0YWJsZVJhbmdlczogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0VGltZXMgPSBbXTtcbiAgICAgICAgdGhpcy5fZW5kVGltZXMgPSBbXTtcblxuICAgICAgICBmb3JFYWNoKHRoaXMuX3JhbmdlcywgZnVuY3Rpb24ocmFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVRpbWVSYW5nZSh7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IGRhdGVVdGlsLmdldFRpbWUocmFuZ2VbMF0pLFxuICAgICAgICAgICAgICAgIGVuZDogZGF0ZVV0aWwuZ2V0VGltZShyYW5nZVsxXSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRpbWUgcmFuZ2UgKHN0YXJ0VGltZXMsIGVuZFRpbWVzKVxuICAgICAqIEBwYXJhbSB7e3N0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyfX0gbmV3VGltZVJhbmdlIC0gVGltZSByYW5nZSBmb3IgdXBkYXRlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdXBkYXRlVGltZVJhbmdlOiBmdW5jdGlvbihuZXdUaW1lUmFuZ2UpIHtcbiAgICAgICAgdmFyIGluZGV4LCBleGlzdGluZ1RpbWVSYW5nZSwgbWVyZ2VkVGltZVJhbmdlO1xuXG4gICAgICAgIGluZGV4ID0gdGhpcy5fc2VhcmNoU3RhcnRUaW1lKG5ld1RpbWVSYW5nZS5zdGFydCkuaW5kZXg7XG4gICAgICAgIGV4aXN0aW5nVGltZVJhbmdlID0ge1xuICAgICAgICAgICAgc3RhcnQ6IHRoaXMuX3N0YXJ0VGltZXNbaW5kZXhdLFxuICAgICAgICAgICAgZW5kOiB0aGlzLl9lbmRUaW1lc1tpbmRleF1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodGhpcy5faXNPdmVybGFwcGVkVGltZVJhbmdlKGV4aXN0aW5nVGltZVJhbmdlLCBuZXdUaW1lUmFuZ2UpKSB7XG4gICAgICAgICAgICBtZXJnZWRUaW1lUmFuZ2UgPSB0aGlzLl9tZXJnZVRpbWVSYW5nZXMoZXhpc3RpbmdUaW1lUmFuZ2UsIG5ld1RpbWVSYW5nZSk7XG4gICAgICAgICAgICB0aGlzLl9zdGFydFRpbWVzLnNwbGljZShpbmRleCwgMSwgbWVyZ2VkVGltZVJhbmdlLnN0YXJ0KTtcbiAgICAgICAgICAgIHRoaXMuX2VuZFRpbWVzLnNwbGljZShpbmRleCwgMSwgbWVyZ2VkVGltZVJhbmdlLmVuZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdGFydFRpbWVzLnNwbGljZShpbmRleCwgMCwgbmV3VGltZVJhbmdlLnN0YXJ0KTtcbiAgICAgICAgICAgIHRoaXMuX2VuZFRpbWVzLnNwbGljZShpbmRleCwgMCwgbmV3VGltZVJhbmdlLmVuZCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgcmFuZ2VzIGFyZSBvdmVybGFwcGVkXG4gICAgICogQHBhcmFtIHt7c3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXJ9fSBleGlzdGluZ1RpbWVSYW5nZSAtIEV4aXN0aW5nIHRpbWUgcmFuZ2VcbiAgICAgKiBAcGFyYW0ge3tzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcn19IG5ld1RpbWVSYW5nZSAtIE5ldyB0aW1lIHJhbmdlXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHJhbmdlcyBhcmUgb3ZlcmxhcHBlZFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2lzT3ZlcmxhcHBlZFRpbWVSYW5nZTogZnVuY3Rpb24oZXhpc3RpbmdUaW1lUmFuZ2UsIG5ld1RpbWVSYW5nZSkge1xuICAgICAgICB2YXIgZXhpc3RpbmdTdGFydCA9IGV4aXN0aW5nVGltZVJhbmdlLnN0YXJ0LFxuICAgICAgICAgICAgZXhpc3RpbmdFbmQgPSBleGlzdGluZ1RpbWVSYW5nZS5lbmQsXG4gICAgICAgICAgICBuZXdTdGFydCA9IG5ld1RpbWVSYW5nZS5zdGFydCxcbiAgICAgICAgICAgIG5ld0VuZCA9IG5ld1RpbWVSYW5nZS5lbmQsXG4gICAgICAgICAgICBpc1RydXRoeSA9IGV4aXN0aW5nU3RhcnQgJiYgZXhpc3RpbmdFbmQgJiYgbmV3U3RhcnQgJiYgbmV3RW5kLFxuICAgICAgICAgICAgaXNPdmVybGFwcGVkID0gIShcbiAgICAgICAgICAgICAgICAobmV3U3RhcnQgPCBleGlzdGluZ1N0YXJ0ICYmIG5ld0VuZCA8IGV4aXN0aW5nU3RhcnQpIHx8XG4gICAgICAgICAgICAgICAgKG5ld1N0YXJ0ID4gZXhpc3RpbmdFbmQgJiYgbmV3RW5kID4gZXhpc3RpbmdFbmQpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBpc1RydXRoeSAmJiBpc092ZXJsYXBwZWQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIE1lcmdlIHRoZSBvdmVybGFwcGVkIHRpbWUgcmFuZ2VzXG4gICAgICogQHBhcmFtIHt7c3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXJ9fSBleGlzdGluZ1RpbWVSYW5nZSAtIEV4aXN0aW5nIHRpbWUgcmFuZ2VcbiAgICAgKiBAcGFyYW0ge3tzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcn19IG5ld1RpbWVSYW5nZSAtIE5ldyB0aW1lIHJhbmdlXG4gICAgICogQHJldHVybnMge3tzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcn19IE1lcmdlZCB0aW1lIHJhbmdlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfbWVyZ2VUaW1lUmFuZ2VzOiBmdW5jdGlvbihleGlzdGluZ1RpbWVSYW5nZSwgbmV3VGltZVJhbmdlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDogTWF0aC5taW4oZXhpc3RpbmdUaW1lUmFuZ2Uuc3RhcnQsIG5ld1RpbWVSYW5nZS5zdGFydCksXG4gICAgICAgICAgICBlbmQ6IE1hdGgubWF4KGV4aXN0aW5nVGltZVJhbmdlLmVuZCwgbmV3VGltZVJhbmdlLmVuZClcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2VhcmNoIHRpbWVzdGFtcCBpbiBzdGFydFRpbWVzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWVzdGFtcCAtIHRpbWVzdGFtcFxuICAgICAqIEByZXR1cm5zIHt7Zm91bmQ6IGJvb2xlYW4sIGluZGV4OiBudW1iZXJ9fSByZXN1bHRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZWFyY2hTdGFydFRpbWU6IGZ1bmN0aW9uKHRpbWVzdGFtcCkge1xuICAgICAgICByZXR1cm4gZGF0ZVV0aWwuc2VhcmNoKHRoaXMuX3N0YXJ0VGltZXMsIHRpbWVzdGFtcCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNlYXJjaCB0aW1lc3RhbXAgaW4gZW5kVGltZXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lc3RhbXAgLSB0aW1lc3RhbXBcbiAgICAgKiBAcmV0dXJucyB7e2ZvdW5kOiBib29sZWFuLCBpbmRleDogbnVtYmVyfX0gcmVzdWx0XG4gICAgICovXG4gICAgX3NlYXJjaEVuZFRpbWU6IGZ1bmN0aW9uKHRpbWVzdGFtcCkge1xuICAgICAgICByZXR1cm4gZGF0ZVV0aWwuc2VhcmNoKHRoaXMuX2VuZFRpbWVzLCB0aW1lc3RhbXApO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTdG9yZSBvcGVuZXIgZWxlbWVudCBsaXN0XG4gICAgICogQHBhcmFtIHtBcnJheX0gb3BPcGVuZXJzIFtvcHRpb24ub3BlbmVyc10gLSBvcGVuZXIgZWxlbWVudCBsaXN0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0T3BlbmVyczogZnVuY3Rpb24ob3BPcGVuZXJzKSB7XG4gICAgICAgIHRoaXMuYWRkT3BlbmVyKHRoaXMuXyRlbGVtZW50KTtcbiAgICAgICAgZm9yRWFjaChvcE9wZW5lcnMsIGZ1bmN0aW9uKG9wZW5lcikge1xuICAgICAgICAgICAgdGhpcy5hZGRPcGVuZXIob3BlbmVyKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBUaW1lUGlja2VyIGluc3RhbmNlXG4gICAgICogQHBhcmFtIHtUaW1lUGlja2VyfSBbb3BUaW1lUGlja2VyXSAtIFRpbWVQaWNrZXIgaW5zdGFuY2VcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXRUaW1lUGlja2VyOiBmdW5jdGlvbihvcFRpbWVQaWNrZXIpIHtcbiAgICAgICAgaWYgKCFvcFRpbWVQaWNrZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3RpbWVQaWNrZXIgPSBvcFRpbWVQaWNrZXI7XG4gICAgICAgIHRoaXMuX2JpbmRDdXN0b21FdmVudFdpdGhUaW1lUGlja2VyKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEJpbmQgY3VzdG9tIGV2ZW50IHdpdGggVGltZVBpY2tlclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2JpbmRDdXN0b21FdmVudFdpdGhUaW1lUGlja2VyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9uQ2hhbmdlVGltZVBpY2tlciA9IGJpbmQodGhpcy5zZXREYXRlLCB0aGlzKTtcblxuICAgICAgICB0aGlzLm9uKCdvcGVuJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLl90aW1lUGlja2VyLnNldFRpbWVGcm9tSW5wdXRFbGVtZW50KHRoaXMuXyRlbGVtZW50KTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVQaWNrZXIub24oJ2NoYW5nZScsIG9uQ2hhbmdlVGltZVBpY2tlcik7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICB0aGlzLm9uKCdjbG9zZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fdGltZVBpY2tlci5vZmYoJ2NoYW5nZScsIG9uQ2hhbmdlVGltZVBpY2tlcik7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDaGVjayB2YWxpZGF0aW9uIG9mIGEgeWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIC0geWVhclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIHdoZXRoZXIgdGhlIHllYXIgaXMgdmFsaWQgb3Igbm90XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaXNWYWxpZFllYXI6IGZ1bmN0aW9uKHllYXIpIHtcbiAgICAgICAgcmV0dXJuIGlzTnVtYmVyKHllYXIpICYmIHllYXIgPj0gTUlOX1lFQVIgJiYgeWVhciA8PSBNQVhfWUVBUjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgdmFsaWRhdGlvbiBvZiBhIG1vbnRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIC0gbW9udGhcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB3aGV0aGVyIHRoZSBtb250aCBpcyB2YWxpZCBvciBub3RcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9pc1ZhbGlkTW9udGg6IGZ1bmN0aW9uKG1vbnRoKSB7XG4gICAgICAgIHJldHVybiBpc051bWJlcihtb250aCkgJiYgbW9udGggPiAwICYmIG1vbnRoIDwgMTM7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIGRheS1pbi1tb250aCBpcyB2YWxpZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIC0geWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCAtIG1vbnRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUgLSBkYXRlXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaXNWYWxpZERheUluTW9udGg6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlKSB7XG4gICAgICAgIHJldHVybiBpc051bWJlcihkYXRlKSAmJiAoZGF0ZSA+IDApICYmIChkYXRlIDw9IGRhdGVVdGlsLmdldExhc3REYXlJbk1vbnRoKHllYXIsIG1vbnRoKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIHZhbHVlcyBpbiBhIGRhdGVIYXNoIGFyZSB2YWxpZFxuICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IGRhdGVIYXNoIC0gZGF0ZUhhc2hcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9pc1ZhbGlkRGF0ZUhhc2g6IGZ1bmN0aW9uKGRhdGVIYXNoKSB7XG4gICAgICAgIHZhciB5ZWFyLCBtb250aCwgZGF0ZTtcblxuICAgICAgICBpZiAoIWRhdGVIYXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB5ZWFyID0gZGF0ZUhhc2gueWVhciB8fCB0aGlzLl9kYXRlLnllYXI7XG4gICAgICAgIG1vbnRoID0gZGF0ZUhhc2gubW9udGggfHwgdGhpcy5fZGF0ZS5tb250aDtcbiAgICAgICAgZGF0ZSA9IGRhdGVIYXNoLmRhdGUgfHwgdGhpcy5fZGF0ZS5kYXRlO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9pc1ZhbGlkWWVhcih5ZWFyKSAmJiB0aGlzLl9pc1ZhbGlkTW9udGgobW9udGgpICYmIHRoaXMuX2lzVmFsaWREYXlJbk1vbnRoKHllYXIsIG1vbnRoLCBkYXRlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgYW4gZWxlbWVudCBpcyBhbiBvcGVuZXIuXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IGVsZW1lbnRcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBvcGVuZXIgdHJ1ZS9mYWxzZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2lzT3BlbmVyOiBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICB2YXIgb3BlbmVycyA9IHRoaXMuX29wZW5lcnM7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIGxlbiA9IG9wZW5lcnMubGVuZ3RoO1xuXG4gICAgICAgIGZvciAoOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IG9wZW5lcnNbaV0gfHwgJC5jb250YWlucyhvcGVuZXJzW2ldLCB0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBzdHlsZS1wb3NpdGlvbiBvZiBjYWxlbmRhclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2FycmFuZ2VMYXllcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IHRoaXMuXyR3cmFwcGVyRWxlbWVudFswXS5zdHlsZSxcbiAgICAgICAgICAgIHBvcyA9IHRoaXMuX3BvcztcblxuICAgICAgICBzdHlsZS5sZWZ0ID0gcG9zLmxlZnQgKyAncHgnO1xuICAgICAgICBzdHlsZS50b3AgPSBwb3MudG9wICsgJ3B4JztcbiAgICAgICAgc3R5bGUuekluZGV4ID0gcG9zLnpJbmRleDtcbiAgICAgICAgdGhpcy5fJHdyYXBwZXJFbGVtZW50LmFwcGVuZCh0aGlzLl9jYWxlbmRhci4kZWxlbWVudCk7XG4gICAgICAgIGlmICh0aGlzLl90aW1lUGlja2VyKSB7XG4gICAgICAgICAgICB0aGlzLl8kd3JhcHBlckVsZW1lbnQuYXBwZW5kKHRoaXMuX3RpbWVQaWNrZXIuJHRpbWVQaWNrZXJFbGVtZW50KTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVQaWNrZXIuc2hvdygpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBib3VuZGluZ0NsaWVudFJlY3Qgb2YgYW4gZWxlbWVudFxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBbZWxlbWVudF0gLSBlbGVtZW50XG4gICAgICogQHJldHVybnMge09iamVjdH0gLSBhbiBvYmplY3QgaGF2aW5nIGxlZnQsIHRvcCwgYm90dG9tLCByaWdodCBvZiBlbGVtZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZ2V0Qm91bmRpbmdDbGllbnRSZWN0OiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgIHZhciBlbCA9ICQoZWxlbWVudClbMF0gfHwgdGhpcy5fJGVsZW1lbnRbMF0sXG4gICAgICAgICAgICBib3VuZCxcbiAgICAgICAgICAgIGNlaWw7XG5cbiAgICAgICAgaWYgKCFlbCkge1xuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgYm91bmQgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY2VpbCA9IE1hdGguY2VpbDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGVmdDogY2VpbChib3VuZC5sZWZ0KSxcbiAgICAgICAgICAgIHRvcDogY2VpbChib3VuZC50b3ApLFxuICAgICAgICAgICAgYm90dG9tOiBjZWlsKGJvdW5kLmJvdHRvbSksXG4gICAgICAgICAgICByaWdodDogY2VpbChib3VuZC5yaWdodClcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IGRhdGUgZnJvbSBzdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyIC0gZGF0ZSBzdHJpbmdcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXREYXRlRnJvbVN0cmluZzogZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgIHZhciBkYXRlID0gdGhpcy5fZXh0cmFjdERhdGUoc3RyKTtcblxuICAgICAgICBkYXRlID0gZXh0ZW5kKHt9LCB0aGlzLl9kYXRlLCBkYXRlKTtcblxuICAgICAgICBpZiAoZGF0ZSAmJiB0aGlzLl9pc1NlbGVjdGFibGUoZGF0ZSkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lUGlja2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZVBpY2tlci5zZXRUaW1lRnJvbUlucHV0RWxlbWVudCh0aGlzLl8kZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNldERhdGUoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoLCBkYXRlLmRhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXREYXRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGZvcm1lZCBkYXRlLXN0cmluZyBmcm9tIGRhdGUgb2JqZWN0XG4gICAgICogQHJldHVybnMge3N0cmluZ30gLSBmb3JtZWQgZGF0ZS1zdHJpbmdcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9tYWtlRGF0ZVN0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB5ZWFyID0gdGhpcy5fZGF0ZS55ZWFyLFxuICAgICAgICAgICAgbW9udGggPSB0aGlzLl9kYXRlLm1vbnRoLFxuICAgICAgICAgICAgZGF0ZSA9IHRoaXMuX2RhdGUuZGF0ZSxcbiAgICAgICAgICAgIGZvcm1hdCA9IHRoaXMuX2RhdGVGb3JtYXQsXG4gICAgICAgICAgICByZXBsYWNlTWFwLFxuICAgICAgICAgICAgZGF0ZVN0cmluZztcblxuICAgICAgICBtb250aCA9IG1vbnRoIDwgMTAgPyAoJzAnICsgbW9udGgpIDogbW9udGg7XG4gICAgICAgIGRhdGUgPSBkYXRlIDwgMTAgPyAoJzAnICsgZGF0ZSkgOiBkYXRlO1xuXG4gICAgICAgIHJlcGxhY2VNYXAgPSB7XG4gICAgICAgICAgICB5eXl5OiB5ZWFyLFxuICAgICAgICAgICAgeXk6IFN0cmluZyh5ZWFyKS5zdWJzdHIoMiwgMiksXG4gICAgICAgICAgICBtbTogbW9udGgsXG4gICAgICAgICAgICBtOiBOdW1iZXIobW9udGgpLFxuICAgICAgICAgICAgZGQ6IGRhdGUsXG4gICAgICAgICAgICBkOiBOdW1iZXIoZGF0ZSlcbiAgICAgICAgfTtcblxuICAgICAgICBkYXRlU3RyaW5nID0gZm9ybWF0LnJlcGxhY2UoZm9ybWF0UmVnRXhwLCBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHJldHVybiByZXBsYWNlTWFwW2tleS50b0xvd2VyQ2FzZSgpXSB8fCAnJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGRhdGVTdHJpbmc7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgZGF0ZS1vYmplY3QgZnJvbSBpbnB1dCBzdHJpbmcgd2l0aCBjb21wYXJpbmcgZGF0ZS1mb3JtYXQ8YnI+XG4gICAgICogSWYgY2FuIG5vdCBleHRyYWN0LCByZXR1cm4gZmFsc2VcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIC0gaW5wdXQgc3RyaW5nKHRleHQpXG4gICAgICogQHJldHVybnMge2RhdGVIYXNofGZhbHNlfSAtIGV4dHJhY3RlZCBkYXRlIG9iamVjdCBvciBmYWxzZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2V4dHJhY3REYXRlOiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgdmFyIGZvcm1PcmRlciA9IHRoaXMuX2Zvcm1PcmRlcixcbiAgICAgICAgICAgIHJlc3VsdERhdGUgPSB7fSxcbiAgICAgICAgICAgIHJlZ0V4cCA9IHRoaXMuX3JlZ0V4cDtcblxuICAgICAgICByZWdFeHAubGFzdEluZGV4ID0gMDtcbiAgICAgICAgaWYgKHJlZ0V4cC50ZXN0KHN0cikpIHtcbiAgICAgICAgICAgIGlmIChmb3JtT3JkZXJbMF0pIHtcbiAgICAgICAgICAgICAgICByZXN1bHREYXRlW2Zvcm1PcmRlclswXV0gPSBOdW1iZXIoUmVnRXhwLiQxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZvcm1PcmRlclsxXSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdERhdGVbZm9ybU9yZGVyWzFdXSA9IE51bWJlcihSZWdFeHAuJDIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm9ybU9yZGVyWzJdKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0RGF0ZVtmb3JtT3JkZXJbMl1dID0gTnVtYmVyKFJlZ0V4cC4kMyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoU3RyaW5nKHJlc3VsdERhdGUueWVhcikubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICByZXN1bHREYXRlLnllYXIgPSBOdW1iZXIodGhpcy5fZGVmYXVsdENlbnR1cnkgKyByZXN1bHREYXRlLnllYXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdERhdGU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgYSBkYXRlSGFzaCBpcyBzZWxlY3RhYmxlXG4gICAgICogQHBhcmFtIHtkYXRlSGFzaH0gZGF0ZUhhc2ggLSBkYXRlSGFzaFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbGF5ZXJUeXBlID0gREFURV9MQVlFUl0gLSBZRUFSX0xBWUVSIHwgTU9OVEhfTEFZRVIgfCBkZWZhdWx0XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciBhIGRhdGVIYXNoIGlzIHNlbGVjdGFibGVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9pc1NlbGVjdGFibGU6IGZ1bmN0aW9uKGRhdGVIYXNoLCBsYXllclR5cGUpIHtcbiAgICAgICAgdmFyIHN0YXJ0VGltZXMgPSB0aGlzLl9zdGFydFRpbWVzO1xuICAgICAgICB2YXIgc3RhcnRUaW1lLCBzZWFyY2hSZXN1bHQsIHRpbWVzdGFtcCwgY29tcGFyaW5nTGV2ZWw7XG5cbiAgICAgICAgZGF0ZUhhc2ggPSBleHRlbmQoe30sIGRhdGVIYXNoKTtcbiAgICAgICAgc3dpdGNoIChsYXllclR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgWUVBUl9MQVlFUjpcbiAgICAgICAgICAgICAgICBkYXRlSGFzaC5tb250aCA9IDE7XG4gICAgICAgICAgICAgICAgZGF0ZUhhc2guZGF0ZSA9IDE7XG4gICAgICAgICAgICAgICAgY29tcGFyaW5nTGV2ZWwgPSBZRUFSX1RPX01TO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBNT05USF9MQVlFUjpcbiAgICAgICAgICAgICAgICBkYXRlSGFzaC5kYXRlID0gMTtcbiAgICAgICAgICAgICAgICBjb21wYXJpbmdMZXZlbCA9IE1PTlRIX1RPX01TO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5faXNWYWxpZERhdGVIYXNoKGRhdGVIYXNoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3RhcnRUaW1lcy5sZW5ndGgpIHsgLy8gTm8gcmFuZ2VzLiBBbGwgZGF0ZXMgYXJlIHNlbGVjdGFibGUuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRpbWVzdGFtcCA9IGRhdGVVdGlsLmdldFRpbWUoZGF0ZUhhc2gpO1xuICAgICAgICBzZWFyY2hSZXN1bHQgPSB0aGlzLl9zZWFyY2hFbmRUaW1lKHRpbWVzdGFtcCk7XG4gICAgICAgIHN0YXJ0VGltZSA9IHN0YXJ0VGltZXNbc2VhcmNoUmVzdWx0LmluZGV4XTtcblxuICAgICAgICByZXR1cm4gc2VhcmNoUmVzdWx0LmZvdW5kIHx8IGlzR3JlYXRlclRoYW5PckVxdWFsVG8odGltZXN0YW1wLCBzdGFydFRpbWUsIGNvbXBhcmluZ0xldmVsKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IHNlbGVjdGFibGUtY2xhc3MtbmFtZSB0byBzZWxlY3RhYmxlIGRhdGUgZWxlbWVudC5cbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1lbnQgLSBkYXRlIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge2RhdGVIYXNofSBkYXRlSGFzaCAtIGRhdGUgb2JqZWN0XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGxheWVyVHlwZSAtIFlFQVJfTEFZRVIgfCBNT05USF9MQVlFUiB8IERBVEVfTEFZRVJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXRTZWxlY3RhYmxlQ2xhc3NOYW1lOiBmdW5jdGlvbigkZWxlbWVudCwgZGF0ZUhhc2gsIGxheWVyVHlwZSkge1xuICAgICAgICBpZiAodGhpcy5faXNTZWxlY3RhYmxlKGRhdGVIYXNoLCBsYXllclR5cGUpKSB7XG4gICAgICAgICAgICAkZWxlbWVudC5hZGRDbGFzcyh0aGlzLl9zZWxlY3RhYmxlQ2xhc3NOYW1lKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXQgc2VsZWN0ZWQtY2xhc3MtbmFtZSB0byBzZWxlY3RlZCBkYXRlIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fGpRdWVyeX0gZWxlbWVudCAtIGRhdGUgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7e3llYXI6IG51bWJlciwgbW9udGg6IG51bWJlciwgZGF0ZTogbnVtYmVyfX0gZGF0ZUhhc2ggLSBkYXRlIG9iamVjdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYXllclR5cGUgLSBZRUFSX0xBWUVSIHwgTU9OVEhfTEFZRVIgfCBEQVRFX0xBWUVSXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0U2VsZWN0ZWRDbGFzc05hbWU6IGZ1bmN0aW9uKGVsZW1lbnQsIGRhdGVIYXNoLCBsYXllclR5cGUpIHtcbiAgICAgICAgdmFyIGN1ckRhdGVIYXNoID0gdGhpcy5fZGF0ZTtcbiAgICAgICAgdmFyIGlzU2VsZWN0ZWQ7XG5cbiAgICAgICAgc3dpdGNoIChsYXllclR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgTU9OVEhfTEFZRVI6XG4gICAgICAgICAgICAgICAgZGF0ZUhhc2guZGF0ZSA9IGN1ckRhdGVIYXNoLmRhdGU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFlFQVJfTEFZRVI6XG4gICAgICAgICAgICAgICAgZGF0ZUhhc2guZGF0ZSA9IGN1ckRhdGVIYXNoLmRhdGU7XG4gICAgICAgICAgICAgICAgZGF0ZUhhc2gubW9udGggPSBjdXJEYXRlSGFzaC5tb250aDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpc1NlbGVjdGVkID0gZGF0ZVV0aWwuaXNFcXVhbERhdGVIYXNoKGN1ckRhdGVIYXNoLCBkYXRlSGFzaCk7XG4gICAgICAgIGlmIChpc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICAkKGVsZW1lbnQpLmFkZENsYXNzKHRoaXMuX3NlbGVjdGVkQ2xhc3NOYW1lKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXQgdmFsdWUgYSBkYXRlLXN0cmluZyBvZiBjdXJyZW50IHRoaXMgaW5zdGFuY2UgdG8gaW5wdXQgZWxlbWVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldFZhbHVlVG9JbnB1dEVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGF0ZVN0cmluZywgdGltZVN0cmluZztcblxuICAgICAgICBpZiAoIXRoaXMuX2RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGRhdGVTdHJpbmcgPSB0aGlzLl9tYWtlRGF0ZVN0cmluZygpO1xuICAgICAgICB0aW1lU3RyaW5nID0gJyc7XG5cbiAgICAgICAgaWYgKHRoaXMuX3RpbWVQaWNrZXIpIHtcbiAgICAgICAgICAgIHRpbWVTdHJpbmcgPSB0aGlzLl90aW1lUGlja2VyLmdldFRpbWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuXyRlbGVtZW50LnZhbChkYXRlU3RyaW5nICsgdGltZVN0cmluZyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldChvciBtYWtlKSBSZWdFeHAgaW5zdGFuY2UgZnJvbSB0aGUgZGF0ZS1mb3JtYXQgb2YgdGhpcyBpbnN0YW5jZS5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXRSZWdFeHA6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcmVnRXhwU3RyID0gJ14nO1xuICAgICAgICB2YXIgZm9ybU9yZGVyID0gdGhpcy5fZm9ybU9yZGVyO1xuXG4gICAgICAgIHZhciBtYXRjaGVkS2V5cyA9IHRoaXMuX2RhdGVGb3JtYXQubWF0Y2goZm9ybWF0UmVnRXhwKTtcbiAgICAgICAgdXRpbC5mb3JFYWNoKG1hdGNoZWRLZXlzLCBmdW5jdGlvbihrZXksIGluZGV4KSB7XG4gICAgICAgICAgICBrZXkgPSBrZXkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHJlZ0V4cFN0ciArPSAobWFwRm9yQ29udmVydGluZ1trZXldLmV4cHJlc3Npb24gKyAnW1xcXFxEXFxcXHNdKicpO1xuICAgICAgICAgICAgZm9ybU9yZGVyW2luZGV4XSA9IG1hcEZvckNvbnZlcnRpbmdba2V5XS50eXBlO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9yZWdFeHAgPSBuZXcgUmVnRXhwKHJlZ0V4cFN0ciwgJ2dpJyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBldmVudCBoYW5kbGVycyB0byBiaW5kIGNvbnRleHQgYW5kIHRoZW4gc3RvcmUuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0UHJveHlIYW5kbGVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwcm94aWVzID0gdGhpcy5fcHJveHlIYW5kbGVycztcblxuICAgICAgICAvLyBFdmVudCBoYW5kbGVycyBmb3IgZWxlbWVudFxuICAgICAgICBwcm94aWVzLm9uTW91c2Vkb3duRG9jdW1lbnQgPSBiaW5kKHRoaXMuX29uTW91c2Vkb3duRG9jdW1lbnQsIHRoaXMpO1xuICAgICAgICBwcm94aWVzLm9uS2V5ZG93bkVsZW1lbnQgPSBiaW5kKHRoaXMuX29uS2V5ZG93bkVsZW1lbnQsIHRoaXMpO1xuICAgICAgICBwcm94aWVzLm9uQ2xpY2tDYWxlbmRhciA9IGJpbmQodGhpcy5fb25DbGlja0NhbGVuZGFyLCB0aGlzKTtcbiAgICAgICAgcHJveGllcy5vbkNsaWNrT3BlbmVyID0gYmluZCh0aGlzLl9vbkNsaWNrT3BlbmVyLCB0aGlzKTtcblxuICAgICAgICAvLyBFdmVudCBoYW5kbGVycyBmb3IgY3VzdG9tIGV2ZW50IG9mIGNhbGVuZGFyXG4gICAgICAgIHByb3hpZXMub25CZWZvcmVEcmF3Q2FsZW5kYXIgPSBiaW5kKHRoaXMuX29uQmVmb3JlRHJhd0NhbGVuZGFyLCB0aGlzKTtcbiAgICAgICAgcHJveGllcy5vbkRyYXdDYWxlbmRhciA9IGJpbmQodGhpcy5fb25EcmF3Q2FsZW5kYXIsIHRoaXMpO1xuICAgICAgICBwcm94aWVzLm9uQWZ0ZXJEcmF3Q2FsZW5kYXIgPSBiaW5kKHRoaXMuX29uQWZ0ZXJEcmF3Q2FsZW5kYXIsIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBFdmVudCBoYW5kbGVyIGZvciBtb3VzZWRvd24gb2YgZG9jdW1lbnQ8YnI+XG4gICAgICogLSBXaGVuIGNsaWNrIHRoZSBvdXQgb2YgbGF5ZXIsIGNsb3NlIHRoZSBsYXllclxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IC0gZXZlbnQgb2JqZWN0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25Nb3VzZWRvd25Eb2N1bWVudDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgdmFyIGlzQ29udGFpbnMgPSAkLmNvbnRhaW5zKHRoaXMuXyR3cmFwcGVyRWxlbWVudFswXSwgZXZlbnQudGFyZ2V0KTtcblxuICAgICAgICBpZiAoKCFpc0NvbnRhaW5zICYmICF0aGlzLl9pc09wZW5lcihldmVudC50YXJnZXQpKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIGVudGVyLWtleSBkb3duIG9mIGlucHV0IGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBbZXZlbnRdIC0gZXZlbnQgb2JqZWN0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25LZXlkb3duRWxlbWVudDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKCFldmVudCB8fCBldmVudC5rZXlDb2RlICE9PSAxMykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NldERhdGVGcm9tU3RyaW5nKHRoaXMuXyRlbGVtZW50LnZhbCgpKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRXZlbnQgaGFuZGxlciBmb3IgY2xpY2sgb2YgY2FsZW5kYXI8YnI+XG4gICAgICogLSBVcGRhdGUgZGF0ZSBmb3JtIGV2ZW50LXRhcmdldFxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IC0gZXZlbnQgb2JqZWN0XG4gICAgICogQHRvZG8gcmVmYWN0b3IgLSBjb21wbGV4aXR5XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25DbGlja0NhbGVuZGFyOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICB2YXIgY2xhc3NOYW1lID0gdGFyZ2V0LmNsYXNzTmFtZTtcbiAgICAgICAgdmFyIHZhbHVlID0gKHRhcmdldC5pbm5lclRleHQgfHwgdGFyZ2V0LnRleHRDb250ZW50IHx8IHRhcmdldC5ub2RlVmFsdWUpO1xuICAgICAgICB2YXIgc2hvd25MYXllcklkeCA9IHRoaXMuX2NhbGVuZGFyLnNob3duTGF5ZXJJZHg7XG4gICAgICAgIHZhciBzaG93bkRhdGUgPSB0aGlzLl9jYWxlbmRhci5nZXREYXRlKCk7XG4gICAgICAgIHZhciBzdGFydExheWVySWR4ID0gdGhpcy5fc2hvd25MYXllcklkeDtcbiAgICAgICAgdmFyIGRhdGVIYXNoLCByZWxhdGl2ZU1vbnRoO1xuXG4gICAgICAgIGlmIChjbGFzc05hbWUuaW5kZXhPZigncHJldi1tb250aCcpID4gLTEpIHtcbiAgICAgICAgICAgIHJlbGF0aXZlTW9udGggPSAtMTtcbiAgICAgICAgfSBlbHNlIGlmIChjbGFzc05hbWUuaW5kZXhPZignbmV4dC1tb250aCcpID4gLTEpIHtcbiAgICAgICAgICAgIHJlbGF0aXZlTW9udGggPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVsYXRpdmVNb250aCA9ICQodGFyZ2V0KS5kYXRhKFJFTEFUSVZFX01PTlRIX1ZBTFVFX0tFWSkgfHwgMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHNob3duRGF0ZS5kYXRlID0gKCFzaG93bkxheWVySWR4KSA/IE51bWJlcih2YWx1ZSkgOiAxO1xuICAgICAgICBkYXRlSGFzaCA9IGRhdGVVdGlsLmdldFJlbGF0aXZlRGF0ZSgwLCByZWxhdGl2ZU1vbnRoLCAwLCBzaG93bkRhdGUpO1xuXG4gICAgICAgIGlmIChzdGFydExheWVySWR4ID09PSBzaG93bkxheWVySWR4KSB7XG4gICAgICAgICAgICB0aGlzLnNldERhdGUoZGF0ZUhhc2gueWVhciwgZGF0ZUhhc2gubW9udGgsIGRhdGVIYXNoLmRhdGUpO1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFBpY2sgZXZlbnRcbiAgICAgICAgICAgICAqIEBldmVudCBEYXRlUGlja2VyI3BpY2tcbiAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgKiBkYXRlcGlja2VyLm9uKCdwaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgKiAgICAgIHJldHVybiBmYWxzZTsgLy8gQ2FuY2VsIHRvIGNsb3NlIGxheWVyXG4gICAgICAgICAgICAgKiAgICAgIC8vIHJldHVybiB0cnVlOyAvLyBMYXllciBpcyBjbG9zZWRcbiAgICAgICAgICAgICAqIH0pO1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoIXRoaXMuaW52b2tlKCdwaWNrJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5zaG93QWx3YXlzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgeyAvLyBtb3ZlIHByZXZpb3VzIGxheWVyXG4gICAgICAgICAgICB0aGlzLl9jYWxlbmRhci5kcmF3KGRhdGVIYXNoLnllYXIsIGRhdGVIYXNoLm1vbnRoLCBmYWxzZSwgc2hvd25MYXllcklkeCAtIDEpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIGNsaWNrIG9mIG9wZW5lci1lbGVtZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25DbGlja09wZW5lcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpc09wZW5lZCA9IHRoaXMuaXNPcGVuZWQoKTtcblxuICAgICAgICBpZiAoaXNPcGVuZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yICdiZWZvcmVEcmF3Jy1jdXN0b20gZXZlbnQgb2YgY2FsZW5kYXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBzZWUge3R1aS5jb21wb25lbnQuQ2FsZW5kYXIuZHJhd31cbiAgICAgKi9cbiAgICBfb25CZWZvcmVEcmF3Q2FsZW5kYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl91bmJpbmRPbkNsaWNrQ2FsZW5kYXIoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRXZlbnQgaGFuZGxlciBmb3IgJ2RyYXcnLWN1c3RvbSBldmVudCBvZiBjYWxlbmRhclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudERhdGEgLSBjdXN0b20gZXZlbnQgZGF0YVxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHNlZSB7dHVpLmNvbXBvbmVudC5DYWxlbmRhci5kcmF3fVxuICAgICAqIEB0b2RvIFRoZSBldmVudERhdGEgb2YgY2FsZW5kYXItJ2RyYXcnIHNob3VsZCBoYXZlIGEgcHJvcGVydHkgaW5kaWNhdGluZyB3aGF0IGlzIGEgYmVpbmcgZHJhd24gbGF5ZXIuXG4gICAgICovXG4gICAgX29uRHJhd0NhbGVuZGFyOiBmdW5jdGlvbihldmVudERhdGEpIHtcbiAgICAgICAgdmFyICRkYXRlQ29udGFpbmVyID0gZXZlbnREYXRhLiRkYXRlQ29udGFpbmVyO1xuICAgICAgICB2YXIgY2xhc3NOYW1lcyA9ICRkYXRlQ29udGFpbmVyLmF0dHIoJ2NsYXNzJyk7XG4gICAgICAgIHZhciBkYXRlSGFzaCA9IHtcbiAgICAgICAgICAgIHllYXI6IGV2ZW50RGF0YS55ZWFyLFxuICAgICAgICAgICAgbW9udGg6IGV2ZW50RGF0YS5tb250aCB8fCAxLFxuICAgICAgICAgICAgZGF0ZTogZXZlbnREYXRhLmRhdGUgfHwgMVxuICAgICAgICB9O1xuICAgICAgICB2YXIgbGF5ZXJUeXBlO1xuXG4gICAgICAgIC8vICdkYXRlJyBhbmQgJ21vbnRoJyBjbGFzc05hbWVzIGNhbiBiZSBkdXBsaWNhdGVkIChleC0nY2FsZW5kYXItZGF0ZS5jYWxlbmRhci1wcmV2LW1vbnRoJykuXG4gICAgICAgIC8vIElmIHRoZSBhYm92ZSAndG9kbycgaXMgcmVzb2x2ZWQsIHRoaXMgY29uZGl0aW9uYWwgc3RhdGVtZW50cyBhcmUgdW5uZWNlc3NhcnkuXG4gICAgICAgIGlmIChjbGFzc05hbWVzLmluZGV4T2YoREFURV9MQVlFUikgPiAtMSkge1xuICAgICAgICAgICAgbGF5ZXJUeXBlID0gREFURV9MQVlFUjtcbiAgICAgICAgfSBlbHNlIGlmIChjbGFzc05hbWVzLmluZGV4T2YoTU9OVEhfTEFZRVIpID4gLTEpIHtcbiAgICAgICAgICAgIGxheWVyVHlwZSA9IE1PTlRIX0xBWUVSO1xuICAgICAgICB9IGVsc2UgaWYgKGNsYXNzTmFtZXMuaW5kZXhPZihZRUFSX0xBWUVSKSA+IC0xKSB7XG4gICAgICAgICAgICBsYXllclR5cGUgPSBZRUFSX0xBWUVSO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2V0U2VsZWN0YWJsZUNsYXNzTmFtZSgkZGF0ZUNvbnRhaW5lciwgZGF0ZUhhc2gsIGxheWVyVHlwZSk7XG4gICAgICAgIGlmICh0aGlzLl9kYXRlKSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRTZWxlY3RlZENsYXNzTmFtZSgkZGF0ZUNvbnRhaW5lciwgZGF0ZUhhc2gsIGxheWVyVHlwZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRXZlbnQgaGFuZGxlciBmb3IgJ2FmdGVyRHJhdyctY3VzdG9tIGV2ZW50IG9mIGNhbGVuZGFyXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAc2VlIHt0dWkuY29tcG9uZW50LkNhbGVuZGFyLmRyYXd9XG4gICAgICovXG4gICAgX29uQWZ0ZXJEcmF3Q2FsZW5kYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9zaG93T25seVZhbGlkQnV0dG9ucygpO1xuICAgICAgICB0aGlzLl9iaW5kT25DbGlja0NhbGVuZGFyKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNob3cgb25seSB2YWxpZCBidXR0b25zIGluIGNhbGVuZGFyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2hvd09ubHlWYWxpZEJ1dHRvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJGhlYWRlciA9IHRoaXMuX2NhbGVuZGFyLiRoZWFkZXI7XG4gICAgICAgIHZhciAkcHJldkJ0biA9ICRoZWFkZXIuZmluZCgnW2NsYXNzKj1cImJ0bi1wcmV2XCJdJykuaGlkZSgpO1xuICAgICAgICB2YXIgJG5leHRCdG4gPSAkaGVhZGVyLmZpbmQoJ1tjbGFzcyo9XCJidG4tbmV4dFwiXScpLmhpZGUoKTtcbiAgICAgICAgdmFyIGRpZmZUaW1lID0gdGhpcy5fZ2V0RGlmZlRpbWUoKTtcblxuICAgICAgICBpZiAoZGlmZlRpbWUuc3RhcnQgPiAwKSB7XG4gICAgICAgICAgICAkcHJldkJ0bi5zaG93KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlmZlRpbWUuZW5kID4gMCkge1xuICAgICAgICAgICAgJG5leHRCdG4uc2hvdygpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEJpbmQga2V5ZG93biBldmVudCBoYW5kbGVyIHRvIHRoZSB0YXJnZXQgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkdGFyZ2V0RWwgLSB0YXJnZXQgZWxlbWVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2JpbmRLZXlkb3duRXZlbnQ6IGZ1bmN0aW9uKCR0YXJnZXRFbCkge1xuICAgICAgICBpZiAodGhpcy5fZW5hYmxlU2V0RGF0ZUJ5RW50ZXJLZXkpIHtcbiAgICAgICAgICAgICR0YXJnZXRFbC5vbigna2V5ZG93bicsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25LZXlkb3duRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVW5iaW5kIGtleWRvd24gZXZlbnQgaGFuZGxlciBmcm9tIHRoZSB0YXJnZXQgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkdGFyZ2V0RWwgLSB0YXJnZXQgZWxlbWVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3VuYmluZEtleWRvd25FdmVudDogZnVuY3Rpb24oJHRhcmdldEVsKSB7XG4gICAgICAgIGlmICh0aGlzLl9lbmFibGVTZXREYXRlQnlFbnRlcktleSkge1xuICAgICAgICAgICAgJHRhcmdldEVsLm9mZigna2V5ZG93bicsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25LZXlkb3duRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQmluZCBhIChtb3VzZWRvd258dG91Y2hzdGFydCkgZXZlbnQgb2YgZG9jdW1lbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9iaW5kT25Nb3VzZWRvd25Eb2N1bWVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBldmVudFR5cGUgPSAodGhpcy51c2VUb3VjaEV2ZW50KSA/ICd0b3VjaHN0YXJ0JyA6ICdtb3VzZWRvd24nO1xuICAgICAgICAkKGRvY3VtZW50KS5vbihldmVudFR5cGUsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25Nb3VzZWRvd25Eb2N1bWVudCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFVuYmluZCBtb3VzZWRvd24sdG91Y2hzdGFydCBldmVudHMgb2YgZG9jdW1lbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF91bmJpbmRPbk1vdXNlZG93bkRvY3VtZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgJChkb2N1bWVudCkub2ZmKCdtb3VzZWRvd24gdG91Y2hzdGFydCcsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25Nb3VzZWRvd25Eb2N1bWVudCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEJpbmQgY2xpY2sgZXZlbnQgb2YgY2FsZW5kYXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9iaW5kT25DbGlja0NhbGVuZGFyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLl9wcm94eUhhbmRsZXJzLm9uQ2xpY2tDYWxlbmRhcixcbiAgICAgICAgICAgIGV2ZW50VHlwZSA9ICh0aGlzLnVzZVRvdWNoRXZlbnQpID8gJ3RvdWNoZW5kJyA6ICdjbGljayc7XG4gICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5maW5kKCcuJyArIHRoaXMuX3NlbGVjdGFibGVDbGFzc05hbWUpLm9uKGV2ZW50VHlwZSwgaGFuZGxlcik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFVuYmluZCBjbGljayBldmVudCBvZiBjYWxlbmRhclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3VuYmluZE9uQ2xpY2tDYWxlbmRhcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fcHJveHlIYW5kbGVycy5vbkNsaWNrQ2FsZW5kYXI7XG4gICAgICAgIHRoaXMuXyR3cmFwcGVyRWxlbWVudC5maW5kKCcuJyArIHRoaXMuX3NlbGVjdGFibGVDbGFzc05hbWUpLm9mZignY2xpY2sgdG91Y2hlbmQnLCBoYW5kbGVyKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQmluZCBjdXN0b20gZXZlbnQgb2YgY2FsZW5kYXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9iaW5kQ2FsZW5kYXJDdXN0b21FdmVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwcm94eUhhbmRsZXJzID0gdGhpcy5fcHJveHlIYW5kbGVycyxcbiAgICAgICAgICAgIG9uQmVmb3JlRHJhdyA9IHByb3h5SGFuZGxlcnMub25CZWZvcmVEcmF3Q2FsZW5kYXIsXG4gICAgICAgICAgICBvbkRyYXcgPSBwcm94eUhhbmRsZXJzLm9uRHJhd0NhbGVuZGFyLFxuICAgICAgICAgICAgb25BZnRlckRyYXcgPSBwcm94eUhhbmRsZXJzLm9uQWZ0ZXJEcmF3Q2FsZW5kYXI7XG5cbiAgICAgICAgdGhpcy5fY2FsZW5kYXIub24oe1xuICAgICAgICAgICAgJ2JlZm9yZURyYXcnOiBvbkJlZm9yZURyYXcsXG4gICAgICAgICAgICAnZHJhdyc6IG9uRHJhdyxcbiAgICAgICAgICAgICdhZnRlckRyYXcnOiBvbkFmdGVyRHJhd1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVW5iaW5kIGN1c3RvbSBldmVudCBvZiBjYWxlbmRhclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3VuYmluZENhbGVuZGFyQ3VzdG9tRXZlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcHJveHlIYW5kbGVycyA9IHRoaXMuX3Byb3h5SGFuZGxlcnMsXG4gICAgICAgICAgICBvbkJlZm9yZURyYXcgPSBwcm94eUhhbmRsZXJzLm9uQmVmb3JlRHJhd0NhbGVuZGFyLFxuICAgICAgICAgICAgb25EcmF3ID0gcHJveHlIYW5kbGVycy5vbkRyYXdDYWxlbmRhcixcbiAgICAgICAgICAgIG9uQWZ0ZXJEcmF3ID0gcHJveHlIYW5kbGVycy5vbkFmdGVyRHJhd0NhbGVuZGFyO1xuXG4gICAgICAgIHRoaXMuX2NhbGVuZGFyLm9mZih7XG4gICAgICAgICAgICAnYmVmb3JlRHJhdyc6IG9uQmVmb3JlRHJhdyxcbiAgICAgICAgICAgICdkcmF3Jzogb25EcmF3LFxuICAgICAgICAgICAgJ2FmdGVyRHJhdyc6IG9uQWZ0ZXJEcmF3XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBCaW5kIGNsaWNrIGV2ZW50IG9mIG9wZW5lclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBlbGVtZW50IC0gT3BlbmVyIGVsZW1lbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9iaW5kT25DbGlja09wZW5lcjogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICB2YXIgZXZlbnRUeXBlID0gKHRoaXMudXNlVG91Y2hFdmVudCkgPyAndG91Y2hlbmQnIDogJ2NsaWNrJztcbiAgICAgICAgJChlbGVtZW50KS5vbihldmVudFR5cGUsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25DbGlja09wZW5lcik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFVuYmluZCBjbGljayBldmVudCBvZiBvcGVuZXJcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gZWxlbWVudCAtIE9wZW5lciBlbGVtZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdW5iaW5kT25DbGlja09wZW5lcjogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICB2YXIgZXZlbnRUeXBlID0gKHRoaXMudXNlVG91Y2hFdmVudCkgPyAndG91Y2hlbmQnIDogJ2NsaWNrJztcbiAgICAgICAgJChlbGVtZW50KS5vbihldmVudFR5cGUsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25DbGlja09wZW5lcik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IGxheWVyIHR5cGVcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2dldEN1cnJlbnRMYXllcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBsYXllcnNbdGhpcy5fc2hvd25MYXllcklkeF07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIGxheWVyLXR5cGUgc2hvdWxkIGJlIHNob3duLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gbGF5ZXIgdHlwZSAoWUVBUl9MQVlFUiwgTU9OVEhfTEFZRVIsIERBVEVfTEFZRVIpXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2hvdWxkU2hvd0xheWVyOiBmdW5jdGlvbih0eXBlKSB7XG4gICAgICAgIHZhciBtYXRjaGVkTGF5ZXJzID0gdGhpcy5fZGF0ZUZvcm1hdC5tYXRjaChmb3JtYXRSZWdFeHApO1xuICAgICAgICB2YXIgZnVuY3RvciA9IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZWRMYXllcnMuaW5kZXhPZih2YWwpID4gLTE7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBjYW5kaWRhdGVzO1xuXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBEQVRFX0xBWUVSOlxuICAgICAgICAgICAgICAgIGNhbmRpZGF0ZXMgPSBkYXRlS2V5cztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTU9OVEhfTEFZRVI6XG4gICAgICAgICAgICAgICAgY2FuZGlkYXRlcyA9IG1vbnRoS2V5cztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgWUVBUl9MQVlFUjpcbiAgICAgICAgICAgICAgICBjYW5kaWRhdGVzID0geWVhcktleXM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAhIXV0aWwuZmlsdGVyKGNhbmRpZGF0ZXMsIGZ1bmN0b3IpLmxlbmd0aDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IHNob3duIGxheWVyIGJ5IGZvcm1hdFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldFNob3duTGF5ZXJJbmRleEJ5Rm9ybTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBsYXllcklkeCA9IDA7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Nob3VsZFNob3dMYXllcihZRUFSX0xBWUVSKSkge1xuICAgICAgICAgICAgbGF5ZXJJZHggPSBsYXllcnMuaW5kZXhPZihZRUFSX0xBWUVSKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc2hvdWxkU2hvd0xheWVyKE1PTlRIX0xBWUVSKSkge1xuICAgICAgICAgICAgbGF5ZXJJZHggPSBsYXllcnMuaW5kZXhPZihNT05USF9MQVlFUik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3Nob3VsZFNob3dMYXllcihEQVRFX0xBWUVSKSkge1xuICAgICAgICAgICAgbGF5ZXJJZHggPSBsYXllcnMuaW5kZXhPZihEQVRFX0xBWUVSKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3Nob3duTGF5ZXJJZHggPSBsYXllcklkeDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IGhhc2ggZGF0ZSBpbiByYW5nZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdGFydEhhc2ggLSBTdGFydCBkYXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGVuZEhhc2ggLSBFbmQgZGF0ZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldEhhc2hJblJhbmdlOiBmdW5jdGlvbihzdGFydEhhc2gsIGVuZEhhc2gpIHtcbiAgICAgICAgc3RhcnRIYXNoLm1vbnRoID0gc3RhcnRIYXNoLm1vbnRoIHx8IDE7XG4gICAgICAgIGVuZEhhc2gubW9udGggPSBlbmRIYXNoLm1vbnRoIHx8IDEyO1xuXG4gICAgICAgIHN0YXJ0SGFzaC5kYXRlID0gc3RhcnRIYXNoLmRhdGUgfHwgMTtcbiAgICAgICAgZW5kSGFzaC5kYXRlID0gZW5kSGFzaC5kYXRlIHx8IGRhdGVVdGlsLmdldExhc3REYXlJbk1vbnRoKGVuZEhhc2gueWVhciwgZW5kSGFzaC5tb250aCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBkaWZmZXJlbmNlIHN0YXJ0IHRvIGVuZCB0aW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBUaW1lIGRpZmZlcmVuY2UgdmFsdWVcbiAgICAgKi9cbiAgICBfZ2V0RGlmZlRpbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2hvd25MYXllcklkeCA9IHRoaXMuX2NhbGVuZGFyLnNob3duTGF5ZXJJZHg7XG4gICAgICAgIHZhciBzaG93bkRhdGVIYXNoID0gdGhpcy5fY2FsZW5kYXIuZ2V0RGF0ZSgpO1xuICAgICAgICB2YXIgc2hvd25EYXRlID0gbmV3IERhdGUoc2hvd25EYXRlSGFzaC55ZWFyLCBzaG93bkRhdGVIYXNoLm1vbnRoIC0gMSk7XG4gICAgICAgIHZhciBzdGFydERhdGUgPSBuZXcgRGF0ZSh0aGlzLl9zdGFydFRpbWVzWzBdIHx8IE1JTl9FREdFKS5zZXREYXRlKDEpO1xuICAgICAgICB2YXIgZW5kRGF0ZSA9IG5ldyBEYXRlKHRoaXMuX2VuZFRpbWVzLnNsaWNlKC0xKVswXSB8fCBNQVhfRURHRSkuc2V0RGF0ZSgxKTtcbiAgICAgICAgdmFyIHllYXJSYW5nZSwgc2hvd25TdGFydERhdGUsIHNob3duRW5kRGF0ZSwgc3RhcnREaWZmZXJlbmNlLCBlbmREaWZmZXJlbmNlO1xuXG4gICAgICAgIGlmIChzaG93bkxheWVySWR4ID09PSAwKSB7XG4gICAgICAgICAgICBzdGFydERpZmZlcmVuY2UgPSBzaG93bkRhdGUgLSBzdGFydERhdGU7XG4gICAgICAgICAgICBlbmREaWZmZXJlbmNlID0gZW5kRGF0ZSAtIHNob3duRGF0ZTtcbiAgICAgICAgfSBlbHNlIGlmIChzaG93bkxheWVySWR4ID09PSAxKSB7XG4gICAgICAgICAgICBzaG93blN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHNob3duRGF0ZSkuc2V0TW9udGgoMCk7XG4gICAgICAgICAgICBzaG93bkVuZERhdGUgPSBuZXcgRGF0ZShzaG93bkRhdGUpLnNldE1vbnRoKDExKTtcblxuICAgICAgICAgICAgc3RhcnREaWZmZXJlbmNlID0gc2hvd25TdGFydERhdGUgLSBzdGFydERhdGU7XG4gICAgICAgICAgICBlbmREaWZmZXJlbmNlID0gZW5kRGF0ZSAtIHNob3duRW5kRGF0ZTtcbiAgICAgICAgfSBlbHNlIGlmIChzaG93bkxheWVySWR4ID09PSAyKSB7XG4gICAgICAgICAgICB5ZWFyUmFuZ2UgPSB0aGlzLl9jYWxlbmRhci5fZ2V0SW5mb09mWWVhclJhbmdlKHNob3duRGF0ZUhhc2gueWVhcik7XG4gICAgICAgICAgICBzaG93blN0YXJ0RGF0ZSA9IE51bWJlcihuZXcgRGF0ZSh5ZWFyUmFuZ2Uuc3RhcnRZZWFyLCAwKSk7XG4gICAgICAgICAgICBzaG93bkVuZERhdGUgPSBOdW1iZXIobmV3IERhdGUoeWVhclJhbmdlLmVuZFllYXIsIDApKTtcblxuICAgICAgICAgICAgc3RhcnREYXRlID0gbmV3IERhdGUoc3RhcnREYXRlKS5zZXRNb250aCgwKTtcbiAgICAgICAgICAgIGVuZERhdGUgPSBuZXcgRGF0ZShlbmREYXRlKS5zZXRNb250aCgwKTtcblxuICAgICAgICAgICAgc3RhcnREaWZmZXJlbmNlID0gc2hvd25TdGFydERhdGUgLSBzdGFydERhdGU7XG4gICAgICAgICAgICBlbmREaWZmZXJlbmNlID0gZW5kRGF0ZSAtIHNob3duRW5kRGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDogc3RhcnREaWZmZXJlbmNlLFxuICAgICAgICAgICAgZW5kOiBlbmREaWZmZXJlbmNlXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFkZCBhIHJhbmdlXG4gICAgICogQHBhcmFtIHtkYXRlSGFzaH0gc3RhcnRIYXNoIC0gU3RhcnQgZGF0ZUhhc2hcbiAgICAgKiBAcGFyYW0ge2RhdGVIYXNofSBlbmRIYXNoIC0gRW5kIGRhdGVIYXNoXG4gICAgICogQHNpbmNlIDEuMi4wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgc3RhcnQgPSB7eWVhcjogMjAxNSwgbW9udGg6IDIsIGRhdGU6IDN9LFxuICAgICAqICAgICBlbmQgPSB7eWVhcjogMjAxNSwgbW9udGg6IDMsIGRhdGU6IDZ9O1xuICAgICAqXG4gICAgICogZGF0ZXBpY2tlci5hZGRSYW5nZShzdGFydCwgZW5kKTtcbiAgICAgKi9cbiAgICBhZGRSYW5nZTogZnVuY3Rpb24oc3RhcnRIYXNoLCBlbmRIYXNoKSB7XG4gICAgICAgIHN0YXJ0SGFzaCA9IGV4dGVuZCh7fSwgc3RhcnRIYXNoKTtcbiAgICAgICAgZW5kSGFzaCA9IGV4dGVuZCh7fSwgZW5kSGFzaCk7XG5cbiAgICAgICAgdGhpcy5fc2V0SGFzaEluUmFuZ2Uoc3RhcnRIYXNoLCBlbmRIYXNoKTtcblxuICAgICAgICBpZiAodGhpcy5faXNWYWxpZERhdGVIYXNoKHN0YXJ0SGFzaCkgJiYgdGhpcy5faXNWYWxpZERhdGVIYXNoKGVuZEhhc2gpKSB7XG4gICAgICAgICAgICB0aGlzLl9yYW5nZXMucHVzaChbc3RhcnRIYXNoLCBlbmRIYXNoXSk7XG4gICAgICAgICAgICB0aGlzLl9zZXRTZWxlY3RhYmxlUmFuZ2VzKCk7XG4gICAgICAgICAgICB0aGlzLl9jYWxlbmRhci5kcmF3KDAsIDAsIGZhbHNlLCB0aGlzLl9zaG93bkxheWVySWR4KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSByYW5nZVxuICAgICAqIEBwYXJhbSB7ZGF0ZUhhc2h9IHN0YXJ0SGFzaCAtIFN0YXJ0IGRhdGVIYXNoXG4gICAgICogQHBhcmFtIHtkYXRlSGFzaH0gZW5kSGFzaCAtIEVuZCBkYXRlSGFzaFxuICAgICAqIEBzaW5jZSAxLjIuMFxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIHN0YXJ0ID0ge3llYXI6IDIwMTUsIG1vbnRoOiAyLCBkYXRlOiAzfSxcbiAgICAgKiAgICAgZW5kID0ge3llYXI6IDIwMTUsIG1vbnRoOiAzLCBkYXRlOiA2fTtcbiAgICAgKlxuICAgICAqIGRhdGVwaWNrZXIuYWRkUmFuZ2Uoc3RhcnQsIGVuZCk7XG4gICAgICogZGF0ZXBpY2tlci5yZW1vdmVSYW5nZShzdGFydCwgZW5kKTtcbiAgICAgKi9cbiAgICByZW1vdmVSYW5nZTogZnVuY3Rpb24oc3RhcnRIYXNoLCBlbmRIYXNoKSB7XG4gICAgICAgIHZhciByYW5nZXMgPSB0aGlzLl9yYW5nZXM7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIGxlbiA9IHJhbmdlcy5sZW5ndGg7XG4gICAgICAgIHZhciB0YXJnZXQ7XG5cbiAgICAgICAgc3RhcnRIYXNoID0gZXh0ZW5kKHt9LCBzdGFydEhhc2gpO1xuICAgICAgICBlbmRIYXNoID0gZXh0ZW5kKHt9LCBlbmRIYXNoKTtcblxuICAgICAgICB0aGlzLl9zZXRIYXNoSW5SYW5nZShzdGFydEhhc2gsIGVuZEhhc2gpO1xuXG4gICAgICAgIHRhcmdldCA9IFtzdGFydEhhc2gsIGVuZEhhc2hdO1xuXG4gICAgICAgIGZvciAoOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGlmIChjb21wYXJlSlNPTih0YXJnZXQsIHJhbmdlc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByYW5nZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2V0U2VsZWN0YWJsZVJhbmdlcygpO1xuICAgICAgICB0aGlzLl9jYWxlbmRhci5kcmF3KDAsIDAsIGZhbHNlLCB0aGlzLl9zaG93bkxheWVySWR4KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IHNlbGVjdGFibGUgcmFuZ2VzXG4gICAgICogQHBhcmFtIHtBcnJheS48QXJyYXkuPGRhdGVIYXNoPj59IHJhbmdlcyAtIFRoZSBzYW1lIHdpdGggdGhlIHNlbGVjdGFibGVSYW5nZXMgb3B0aW9uIHZhbHVlc1xuICAgICAqIEBzaW5jZSAxLjMuMFxuICAgICAqL1xuICAgIHNldFJhbmdlczogZnVuY3Rpb24ocmFuZ2VzKSB7XG4gICAgICAgIHRoaXMuX3JhbmdlcyA9IHRoaXMuX2ZpbHRlclZhbGlkUmFuZ2VzKHJhbmdlcyk7XG4gICAgICAgIHRoaXMuX3NldFNlbGVjdGFibGVSYW5nZXMoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IHBvc2l0aW9uLWxlZnQsIHRvcCBvZiBjYWxlbmRhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gcG9zaXRpb24tbGVmdFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gcG9zaXRpb24tdG9wXG4gICAgICogQHNpbmNlIDEuMS4xXG4gICAgICovXG4gICAgc2V0WFk6IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgICAgdmFyIHBvcyA9IHRoaXMuX3BvcztcblxuICAgICAgICBwb3MubGVmdCA9IGlzTnVtYmVyKHgpID8geCA6IHBvcy5sZWZ0O1xuICAgICAgICBwb3MudG9wID0gaXNOdW1iZXIoeSkgPyB5IDogcG9zLnRvcDtcbiAgICAgICAgdGhpcy5fYXJyYW5nZUxheWVyKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCB6LWluZGV4IG9mIGNhbGVuZGFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHpJbmRleCAtIHotaW5kZXggdmFsdWVcbiAgICAgKiBAc2luY2UgMS4xLjFcbiAgICAgKi9cbiAgICBzZXRaSW5kZXg6IGZ1bmN0aW9uKHpJbmRleCkge1xuICAgICAgICBpZiAoIWlzTnVtYmVyKHpJbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3Bvcy56SW5kZXggPSB6SW5kZXg7XG4gICAgICAgIHRoaXMuX2FycmFuZ2VMYXllcigpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBhZGQgb3BlbmVyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxqUXVlcnl8c3RyaW5nfSBvcGVuZXIgLSBlbGVtZW50IG9yIHNlbGVjdG9yXG4gICAgICovXG4gICAgYWRkT3BlbmVyOiBmdW5jdGlvbihvcGVuZXIpIHtcbiAgICAgICAgdmFyIGV2ZW50VHlwZSA9ICh0aGlzLnVzZVRvdWNoRXZlbnQpID8gJ3RvdWNoZW5kJyA6ICdjbGljaycsXG4gICAgICAgICAgICAkb3BlbmVyID0gJChvcGVuZXIpO1xuXG4gICAgICAgIG9wZW5lciA9ICRvcGVuZXJbMF07XG4gICAgICAgIGlmIChvcGVuZXIgJiYgaW5BcnJheShvcGVuZXIsIHRoaXMuX29wZW5lcnMpIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fb3BlbmVycy5wdXNoKG9wZW5lcik7XG4gICAgICAgICAgICAkb3BlbmVyLm9uKGV2ZW50VHlwZSwgdGhpcy5fcHJveHlIYW5kbGVycy5vbkNsaWNrT3BlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiByZW1vdmUgb3BlbmVyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxqUXVlcnl8c3RyaW5nfSBvcGVuZXIgLSBlbGVtZW50IG9yIHNlbGVjdG9yXG4gICAgICovXG4gICAgcmVtb3ZlT3BlbmVyOiBmdW5jdGlvbihvcGVuZXIpIHtcbiAgICAgICAgdmFyICRvcGVuZXIgPSAkKG9wZW5lciksXG4gICAgICAgICAgICBpbmRleCA9IGluQXJyYXkoJG9wZW5lclswXSwgdGhpcy5fb3BlbmVycyk7XG5cbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICRvcGVuZXIub2ZmKCdjbGljayB0b3VjaGVuZCcsIHRoaXMuX3Byb3h5SGFuZGxlcnMub25DbGlja09wZW5lcik7XG4gICAgICAgICAgICB0aGlzLl9vcGVuZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogT3BlbiBjYWxlbmRhciB3aXRoIGFycmFuZ2luZyBwb3NpdGlvblxuICAgICAqIEBleGFtcGxlXG4gICAgICogZGF0ZXBpY2tlci5vcGVuKCk7XG4gICAgICovXG4gICAgb3BlbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkYXRlO1xuXG4gICAgICAgIGlmICh0aGlzLmlzT3BlbmVkKCkgfHwgIXRoaXMuX2VuYWJsZWRTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZGF0ZSA9IHRoaXMuX2RhdGUgfHwgZGF0ZVV0aWwuZ2V0VG9kYXkoKTtcblxuICAgICAgICB0aGlzLl9hcnJhbmdlTGF5ZXIoKTtcbiAgICAgICAgdGhpcy5fYmluZENhbGVuZGFyQ3VzdG9tRXZlbnQoKTtcbiAgICAgICAgdGhpcy5fY2FsZW5kYXIuZHJhdyhkYXRlLnllYXIsIGRhdGUubW9udGgsIGZhbHNlLCB0aGlzLl9zaG93bkxheWVySWR4KTtcbiAgICAgICAgdGhpcy5fJHdyYXBwZXJFbGVtZW50LnNob3coKTtcbiAgICAgICAgaWYgKCF0aGlzLnNob3dBbHdheXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2JpbmRPbk1vdXNlZG93bkRvY3VtZW50KCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGV2ZW50IERhdGVQaWNrZXIjb3BlblxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBkYXRlUGlja2VyLm9uKCdvcGVuJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAqICAgICBhbGVydCgnb3BlbicpO1xuICAgICAgICAgKiB9KTtcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlyZSgnb3BlbicpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDbG9zZSBjYWxlbmRhciB3aXRoIHVuYmluZGluZyBzb21lIGV2ZW50c1xuICAgICAqIEBleG1hcGxlXG4gICAgICogZGF0ZXBpY2tlci5jbG9zZSgpO1xuICAgICAqL1xuICAgIGNsb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzT3BlbmVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl91bmJpbmRDYWxlbmRhckN1c3RvbUV2ZW50KCk7XG4gICAgICAgIHRoaXMuX3VuYmluZE9uTW91c2Vkb3duRG9jdW1lbnQoKTtcbiAgICAgICAgdGhpcy5fJHdyYXBwZXJFbGVtZW50LmhpZGUoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2xvc2UgZXZlbnQgLSBEYXRlUGlja2VyXG4gICAgICAgICAqIEBldmVudCBEYXRlUGlja2VyI2Nsb3NlXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIGRhdGVQaWNrZXIub24oJ2Nsb3NlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAqICAgICBhbGVydCgnY2xvc2UnKTtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpcmUoJ2Nsb3NlJyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBkYXRlLW9iamVjdCBvZiBjdXJyZW50IERhdGVQaWNrZXIgaW5zdGFuY2UuXG4gICAgICogQHJldHVybnMgez9kYXRlSGFzaH0gLSBkYXRlSGFzaCBoYXZpbmcgeWVhciwgbW9udGggYW5kIGRheS1pbi1tb250aFxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gMjAxNS0wNC0xM1xuICAgICAqIGRhdGVwaWNrZXIuZ2V0RGF0ZUhhc2goKTsgLy8ge3llYXI6IDIwMTUsIG1vbnRoOiA0LCBkYXRlOiAxM31cbiAgICAgKi9cbiAgICBnZXREYXRlSGFzaDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkYXRlSGFzaCwgZGVwdGhJZHg7XG5cbiAgICAgICAgaWYgKCF0aGlzLl9kYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGRhdGVIYXNoID0ge307XG4gICAgICAgIGRlcHRoSWR4ID0gdGhpcy5fc2hvd25MYXllcklkeDtcblxuICAgICAgICBleHRlbmQoZGF0ZUhhc2gsIHRoaXMuX2RhdGUpO1xuXG4gICAgICAgIGlmIChkZXB0aElkeCA+IDEpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRlSGFzaC5tb250aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkZXB0aElkeCA+IDApIHtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRlSGFzaC5kYXRlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRhdGVIYXNoO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4geWVhclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IC0geWVhclxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gMjAxNS0wNC0xM1xuICAgICAqIGRhdGVwaWNrZXIuZ2V0WWVhcigpOyAvLyAyMDE1XG4gICAgICovXG4gICAgZ2V0WWVhcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRlLnllYXI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybiBtb250aFxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IC0gbW9udGhcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIDIwMTUtMDQtMTNcbiAgICAgKiBkYXRlcGlja2VyLmdldE1vbnRoKCk7IC8vIDRcbiAgICAgKi9cbiAgICBnZXRNb250aDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRlLm1vbnRoO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gZGF5LWluLW1vbnRoXG4gICAgICogQHJldHVybnMge251bWJlcn0gLSBkYXktaW4tbW9udGhcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIDIwMTUtMDQtMTNcbiAgICAgKiBkYXRlcGlja2VyLmdldERheUluTW9udGgoKTsgLy8gMTNcbiAgICAgKi9cbiAgICBnZXREYXlJbk1vbnRoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGUuZGF0ZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IGRhdGUgZnJvbSB2YWx1ZXMoeWVhciwgbW9udGgsIGRhdGUpIGFuZCB0aGVuIGZpcmUgJ3VwZGF0ZScgY3VzdG9tIGV2ZW50XG4gICAgICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBbeWVhcl0gLSB5ZWFyXG4gICAgICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBbbW9udGhdIC0gbW9udGhcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IFtkYXRlXSAtIGRheSBpbiBtb250aFxuICAgICAqIEBleGFtcGxlXG4gICAgICogZGF0ZXBpY2tlci5zZXREYXRlKDIwMTQsIDEyLCAzKTsgLy8gMjAxNC0xMi0gMDNcbiAgICAgKiBkYXRlcGlja2VyLnNldERhdGUobnVsbCwgMTEsIDIzKTsgLy8gMjAxNC0xMS0yM1xuICAgICAqIGRhdGVwaWNrZXIuc2V0RGF0ZSgnMjAxNScsICc1JywgMyk7IC8vIDIwMTUtMDUtMDNcbiAgICAgKiBkYXRlcGlja2VyLnNldERhdGUoMjAxNiwgMTApOyAvLyAyMDE2LTEwXG4gICAgICogZGF0ZXBpY2tlci5zZXREYXRlKDIwMTcpOyAvLyAyMDE3XG4gICAgICovXG4gICAgc2V0RGF0ZTogZnVuY3Rpb24oeWVhciwgbW9udGgsIGRhdGUpIHtcbiAgICAgICAgdmFyIGRhdGVPYmogPSB0aGlzLl9kYXRlIHx8IGRhdGVVdGlsLmdldFRvZGF5KCk7XG4gICAgICAgIHZhciBwcmV2RGF0ZU9iaiA9IGV4dGVuZCh7fSwgdGhpcy5fZGF0ZSk7XG4gICAgICAgIHZhciBjdXJyZW50TGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50TGF5ZXIoKTtcbiAgICAgICAgdmFyIG5ld0RhdGVPYmogPSB7XG4gICAgICAgICAgICB5ZWFyOiB5ZWFyIHx8IGRhdGVPYmoueWVhcixcbiAgICAgICAgICAgIG1vbnRoOiBtb250aCB8fCBkYXRlT2JqLm1vbnRoLFxuICAgICAgICAgICAgZGF0ZTogZGF0ZSB8fCBkYXRlT2JqLmRhdGVcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNob3VsZFVwZGF0ZSA9IChcbiAgICAgICAgICAgIHRoaXMuX2lzU2VsZWN0YWJsZShuZXdEYXRlT2JqLCBjdXJyZW50TGF5ZXIpXG4gICAgICAgICAgICAmJiAhZGF0ZVV0aWwuaXNFcXVhbERhdGVIYXNoKHByZXZEYXRlT2JqLCBuZXdEYXRlT2JqKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChzaG91bGRVcGRhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2RhdGUgPSBuZXdEYXRlT2JqO1xuICAgICAgICAgICAgdGhpcy5fc2V0VmFsdWVUb0lucHV0RWxlbWVudCgpO1xuICAgICAgICAgICAgdGhpcy5fY2FsZW5kYXIuZHJhdyhuZXdEYXRlT2JqLnllYXIsIG5ld0RhdGVPYmoubW9udGgsIGZhbHNlLCBjdXJyZW50TGF5ZXIpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVcGRhdGUgZXZlbnRcbiAgICAgICAgICAgICAqIEBldmVudCBEYXRlUGlja2VyI3VwZGF0ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aGlzLmZpcmUoJ3VwZGF0ZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2V0VmFsdWVUb0lucHV0RWxlbWVudCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBvciB1cGRhdGUgZGF0ZS1mb3JtXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtmb3JtYXRdIC0gZGF0ZS1mb3JtYXRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGRhdGVwaWNrZXIuc2V0RGF0ZUZvcm0oJ3l5eXktbW0tZGQnKTtcbiAgICAgKiBkYXRlcGlja2VyLnNldERhdGVGb3JtKCdtbS1kZCwgeXl5eScpO1xuICAgICAqIGRhdGVwaWNrZXIuc2V0RGF0ZUZvcm0oJ3kvbS9kJyk7XG4gICAgICogZGF0ZXBpY2tlci5zZXREYXRlRm9ybSgneXkvbW0vZGQnKTtcbiAgICAgKi9cbiAgICBzZXREYXRlRm9ybTogZnVuY3Rpb24oZm9ybWF0KSB7XG4gICAgICAgIHRoaXMuX2RhdGVGb3JtYXQgPSBmb3JtYXQgfHwgdGhpcy5fZGF0ZUZvcm1hdDtcblxuICAgICAgICB0aGlzLl9zZXRTaG93bkxheWVySW5kZXhCeUZvcm0oKTtcbiAgICAgICAgdGhpcy5fc2V0UmVnRXhwKCk7XG4gICAgICAgIGlmICh0aGlzLl9kYXRlKSB7XG4gICAgICAgICAgICB0aGlzLnNldERhdGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgY2FsZW5kYXIgaXMgb3BlbmVkIG9yIG5vdFxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIHRydWUgaWYgb3BlbmVkLCBmYWxzZSBvdGhlcndpc2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGRhdGVwaWNrZXIuY2xvc2UoKTtcbiAgICAgKiBkYXRlcGlja2VyLmlzT3BlbmVkKCk7IC8vIGZhbHNlXG4gICAgICpcbiAgICAgKiBkYXRlcGlja2VyLm9wZW4oKTtcbiAgICAgKiBkYXRlcGlja2VyLmlzT3BlbmVkKCk7IC8vIHRydWVcbiAgICAgKi9cbiAgICBpc09wZW5lZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fJHdyYXBwZXJFbGVtZW50LmNzcygnZGlzcGxheScpID09PSAnYmxvY2snKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIFRpbWVQaWNrZXIgaW5zdGFuY2VcbiAgICAgKiBAcmV0dXJucyB7VGltZVBpY2tlcn0gLSBUaW1lUGlja2VyIGluc3RhbmNlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgdGltZXBpY2tlciA9IHRoaXMuZ2V0VGltZXBpY2tlcigpO1xuICAgICAqL1xuICAgIGdldFRpbWVQaWNrZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGltZVBpY2tlcjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IGlucHV0IGVsZW1lbnQgb2YgdGhpcyBpbnN0YW5jZVxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBlbGVtZW50IC0gaW5wdXQgZWxlbWVudFxuICAgICAqIEBzaW5jZSAxLjMuMFxuICAgICAqL1xuICAgIHNldEVsZW1lbnQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyICRjdXJyZW50RWwgPSB0aGlzLl8kZWxlbWVudDtcbiAgICAgICAgdmFyICRuZXdFbCA9ICQoZWxlbWVudCk7XG5cbiAgICAgICAgaWYgKCRjdXJyZW50RWxbMF0pIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlT3BlbmVyKCRjdXJyZW50RWwpO1xuICAgICAgICAgICAgdGhpcy5fdW5iaW5kS2V5ZG93bkV2ZW50KCRjdXJyZW50RWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hZGRPcGVuZXIoJG5ld0VsKTtcbiAgICAgICAgdGhpcy5fYmluZEtleWRvd25FdmVudCgkbmV3RWwpO1xuICAgICAgICB0aGlzLl9zZXREYXRlRnJvbVN0cmluZygkbmV3RWwudmFsKCkpO1xuICAgICAgICB0aGlzLl8kZWxlbWVudCA9ICRuZXdFbDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIHBpY2tlclxuICAgICAqIEBzaW5jZSAxLjQuMFxuICAgICAqIEBleGFtcGxlXG4gICAgICogZGF0ZXBpY2tlci5kaXNhYmxlKCk7XG4gICAgICogZGF0ZXBpY2tlci5lbmFibGUoKTtcbiAgICAgKi9cbiAgICBlbmFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJG9wZW5lckVsO1xuXG4gICAgICAgIGlmICh0aGlzLl9lbmFibGVkU3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9lbmFibGVkU3RhdGUgPSB0cnVlO1xuXG4gICAgICAgIGZvckVhY2godGhpcy5fb3BlbmVycywgZnVuY3Rpb24ob3BlbmVyRWwsIGlkeCkge1xuICAgICAgICAgICAgJG9wZW5lckVsID0gJChvcGVuZXJFbCk7XG4gICAgICAgICAgICAkb3BlbmVyRWwucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICRvcGVuZXJFbC5yZW1vdmVDbGFzcyh0aGlzLl9kaXNhYmxlZENsYXNzTmFtZSk7XG4gICAgICAgICAgICB0aGlzLl9iaW5kT25DbGlja09wZW5lcigkb3BlbmVyRWwpO1xuXG4gICAgICAgICAgICBpZiAoIWlkeCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRLZXlkb3duRXZlbnQoJG9wZW5lckVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERpc2FibGUgcGlja2VyXG4gICAgICogQHNpbmNlIDEuNC4wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBkYXRlcGlja2VyLmVuYWJsZSgpO1xuICAgICAqIGRhdGVwaWNrZXIuZGlzYWJsZSgpO1xuICAgICAqL1xuICAgIGRpc2FibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJG9wZW5lckVsO1xuXG4gICAgICAgIGlmICghdGhpcy5fZW5hYmxlZFN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9lbmFibGVkU3RhdGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuXG4gICAgICAgIGZvckVhY2godGhpcy5fb3BlbmVycywgZnVuY3Rpb24ob3BlbmVyRWwsIGlkeCkge1xuICAgICAgICAgICAgJG9wZW5lckVsID0gJChvcGVuZXJFbCk7XG4gICAgICAgICAgICAkb3BlbmVyRWwuYWRkQ2xhc3ModGhpcy5fZGlzYWJsZWRDbGFzc05hbWUpO1xuICAgICAgICAgICAgJG9wZW5lckVsLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLl91bmJpbmRPbkNsaWNrT3BlbmVyKCRvcGVuZXJFbCk7XG4gICAgICAgICAgICBpZiAoIWlkeCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VuYmluZEtleWRvd25FdmVudCgkb3BlbmVyRWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSAtIGRlbGV0ZSB3cmFwcGVyIGVsZW1lbnQgYW5kIGF0dGFjaCBldmVudHNcbiAgICAgKiBAc2luY2UgMS40LjBcbiAgICAgKi9cbiAgICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyICRjdXJyZW50RWwgPSB0aGlzLl8kZWxlbWVudDtcblxuICAgICAgICBpZiAoJGN1cnJlbnRFbFswXSkge1xuICAgICAgICAgICAgdGhpcy5fdW5iaW5kS2V5ZG93bkV2ZW50KCRjdXJyZW50RWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdW5iaW5kT25Nb3VzZWRvd25Eb2N1bWVudCgpO1xuICAgICAgICB0aGlzLl91bmJpbmRPbkNsaWNrQ2FsZW5kYXIoKTtcbiAgICAgICAgdGhpcy5fdW5iaW5kQ2FsZW5kYXJDdXN0b21FdmVudCgpO1xuICAgICAgICB0aGlzLl8kd3JhcHBlckVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfVxufSk7XG5cbnV0aWwuQ3VzdG9tRXZlbnRzLm1peGluKERhdGVQaWNrZXIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IERhdGVQaWNrZXI7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9kYXRlcGlja2VyLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogQGZpbGVvdmVydmlldyBUaW1lUGlja2VyIENvbXBvbmVudFxuICogQGF1dGhvciBOSE4gZW50IEZFIExhYiA8ZGxfamF2YXNjcmlwdEBuaG5lbnQuY29tPiA8bWlua3l1LnlpQG5obmVudC5jb20+XG4gKiBAZGVwZW5kZW5jeSBqcXVlcnktMS44LjMsIGNvZGUtc25pcHBldC0xLjAuMiwgc3BpbmJveC5qc1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIFNwaW5ib3ggPSByZXF1aXJlKCcuL3NwaW5ib3gnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcblxudmFyIHV0aWwgPSB0dWkudXRpbDtcbnZhciB0aW1lUmVnRXhwID0gL1xccyooXFxkezEsMn0pXFxzKjpcXHMqKFxcZHsxLDJ9KVxccyooW2FwXVttXSk/KD86W1xcc1xcU10qKS9pO1xudmFyIHRpbWVTZXBlcmF0b3IgPSAvXFxzK3w6L2c7XG52YXIgdGltZVBpY2tlclRhZyA9ICc8dGFibGUgY2xhc3M9XCJ0aW1lcGlja2VyXCI+PHRyIGNsYXNzPVwidGltZXBpY2tlci1yb3dcIj48L3RyPjwvdGFibGU+JztcbnZhciBjb2x1bW5UYWcgPSAnPHRkIGNsYXNzPVwidGltZXBpY2tlci1jb2x1bW5cIj48L3RkPic7XG52YXIgc3BpbkJveFRhZyA9ICc8dGQgY2xhc3M9XCJ0aW1lcGlja2VyLWNvbHVtbiB0aW1lcGlja2VyLXNwaW5ib3hcIj4nICtcbiAgICAgICAgICAgICAgICAnPGRpdj48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cInRpbWVwaWNrZXItc3BpbmJveC1pbnB1dFwiPjwvZGl2PjwvdGQ+JztcbnZhciB1cEJ0blRhZyA9ICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInRpbWVwaWNrZXItYnRuIHRpbWVwaWNrZXItYnRuLXVwXCI+PGI+KzwvYj48L2J1dHRvbj4nO1xudmFyIGRvd25CdG5UYWcgPSAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJ0aW1lcGlja2VyLWJ0biB0aW1lcGlja2VyLWJ0bi1kb3duXCI+PGI+LTwvYj48L2J1dHRvbj4nO1xudmFyIG1lcmlkaWVtVGFnID0gJzxzZWxlY3Q+PG9wdGlvbiB2YWx1ZT1cIkFNXCI+QU08L29wdGlvbj48b3B0aW9uIHZhbHVlPVwiUE1cIj5QTTwvb3B0aW9uPjwvc2VsZWN0Pic7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbl0gLSBvcHRpb24gZm9yIGluaXRpYWxpemF0aW9uXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24uZGVmYXVsdEhvdXIgPSAwXSAtIGluaXRpYWwgc2V0dGluZyB2YWx1ZSBvZiBob3VyXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5kZWZhdWx0TWludXRlID0gMF0gLSBpbml0aWFsIHNldHRpbmcgdmFsdWUgb2YgbWludXRlXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBbb3B0aW9uLmlucHV0RWxlbWVudCA9IG51bGxdIC0gb3B0aW9uYWwgaW5wdXQgZWxlbWVudCB3aXRoIHRpbWVwaWNrZXJcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9uLmhvdXJTdGVwID0gMV0gLSBzdGVwIG9mIGhvdXIgc3BpbmJveC4gaWYgc3RlcCA9IDIsIGhvdXIgdmFsdWUgMSAtPiAzIC0+IDUgLT4gLi4uXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5taW51dGVTdGVwID0gMV0gLSBzdGVwIG9mIG1pbnV0ZSBzcGluYm94LiBpZiBzdGVwID0gMiwgbWludXRlIHZhbHVlIDEgLT4gMyAtPiA1IC0+IC4uLlxuICogQHBhcmFtIHtBcnJheX0gW29wdGlvbi5ob3VyRXhjbHVzaW9uID0gbnVsbF0gLSBob3VyIHZhbHVlIHRvIGJlIGV4Y2x1ZGVkLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBob3VyIFsxLDNdIGlzIGV4Y2x1ZGVkLCBob3VyIHZhbHVlIDAgLT4gMiAtPiA0IC0+IDUgLT4gLi4uXG4gKiBAcGFyYW0ge0FycmF5fSBbb3B0aW9uLm1pbnV0ZUV4Y2x1c2lvbiA9IG51bGxdIC0gbWludXRlIHZhbHVlIHRvIGJlIGV4Y2x1ZGVkLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG1pbnV0ZSBbMSwzXSBpcyBleGNsdWRlZCwgbWludXRlIHZhbHVlIDAgLT4gMiAtPiA0IC0+IDUgLT4gLi4uXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb24uc2hvd01lcmlkaWFuID0gZmFsc2VdIC0gaXMgdGltZSBleHByZXNzaW9uLVwiaGg6bW0gQU0vUE1cIj9cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uLnBvc2l0aW9uID0ge31dIC0gbGVmdCwgdG9wIHBvc2l0aW9uIG9mIHRpbWVwaWNrZXIgZWxlbWVudFxuICpcbiAqIEB0dXRvcmlhbCBzYW1wbGUzXG4gKi9cbnZhciBUaW1lUGlja2VyID0gdXRpbC5kZWZpbmVDbGFzcygvKiogQGxlbmRzIFRpbWVQaWNrZXIucHJvdG90eXBlICovIHtcbiAgICBpbml0OiBmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiR0aW1lUGlja2VyRWxlbWVudCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl8kaW5wdXRFbGVtZW50ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuXyRtZXJpZGlhbkVsZW1lbnQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7U3BpbmJveH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2hvdXJTcGluYm94ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge1NwaW5ib3h9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9taW51dGVTcGluYm94ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogdGltZSBwaWNrZXIgZWxlbWVudCBzaG93IHVwP1xuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2lzU2hvd24gPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge09iamVjdH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX29wdGlvbiA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9ob3VyID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX21pbnV0ZSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZShvcHRpb24pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIHdpdGggb3B0aW9uXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbiBmb3IgdGltZSBwaWNrZXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9pbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgdGhpcy5fc2V0T3B0aW9uKG9wdGlvbik7XG4gICAgICAgIHRoaXMuX21ha2VTcGluYm94ZXMoKTtcbiAgICAgICAgdGhpcy5fbWFrZVRpbWVQaWNrZXJFbGVtZW50KCk7XG4gICAgICAgIHRoaXMuX2Fzc2lnbkRlZmF1bHRFdmVudHMoKTtcbiAgICAgICAgdGhpcy5fc2V0VGltZSh0aGlzLl9vcHRpb24uZGVmYXVsdEhvdXIsIHRoaXMuX29wdGlvbi5kZWZhdWx0TWludXRlLCBmYWxzZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBvcHRpb25cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uIGZvciB0aW1lIHBpY2tlclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldE9wdGlvbjogZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgICAgIHRoaXMuX29wdGlvbiA9IHtcbiAgICAgICAgICAgIGRlZmF1bHRIb3VyOiAwLFxuICAgICAgICAgICAgZGVmYXVsdE1pbnV0ZTogMCxcbiAgICAgICAgICAgIGlucHV0RWxlbWVudDogbnVsbCxcbiAgICAgICAgICAgIGhvdXJTdGVwOiAxLFxuICAgICAgICAgICAgbWludXRlU3RlcDogMSxcbiAgICAgICAgICAgIGhvdXJFeGNsdXNpb246IG51bGwsXG4gICAgICAgICAgICBtaW51dGVFeGNsdXNpb246IG51bGwsXG4gICAgICAgICAgICBzaG93TWVyaWRpYW46IGZhbHNlLFxuICAgICAgICAgICAgcG9zaXRpb246IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgdXRpbC5leHRlbmQodGhpcy5fb3B0aW9uLCBvcHRpb24pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBtYWtlIHNwaW5ib3hlcyAoaG91ciAmIG1pbnV0ZSlcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9tYWtlU3BpbmJveGVzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9wdCA9IHRoaXMuX29wdGlvbjtcbiAgICAgICAgdmFyIGRlZmF1bHRIb3VyID0gb3B0LmRlZmF1bHRIb3VyO1xuXG4gICAgICAgIGlmIChvcHQuc2hvd01lcmlkaWFuKSB7XG4gICAgICAgICAgICBkZWZhdWx0SG91ciA9IHV0aWxzLmdldE1lcmlkaWVtSG91cihkZWZhdWx0SG91cik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9ob3VyU3BpbmJveCA9IG5ldyBTcGluYm94KHNwaW5Cb3hUYWcsIHtcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdEhvdXIsXG4gICAgICAgICAgICBtaW46IChvcHQuc2hvd01lcmlkaWFuKSA/IDEgOiAwLFxuICAgICAgICAgICAgbWF4OiAob3B0LnNob3dNZXJpZGlhbikgPyAxMiA6IDIzLFxuICAgICAgICAgICAgc3RlcDogb3B0LmhvdXJTdGVwLFxuICAgICAgICAgICAgdXBCdG5UYWc6IHVwQnRuVGFnLFxuICAgICAgICAgICAgZG93bkJ0blRhZzogZG93bkJ0blRhZyxcbiAgICAgICAgICAgIGV4Y2x1c2lvbjogb3B0LmhvdXJFeGNsdXNpb25cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fbWludXRlU3BpbmJveCA9IG5ldyBTcGluYm94KHNwaW5Cb3hUYWcsIHtcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogb3B0LmRlZmF1bHRNaW51dGUsXG4gICAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgICBtYXg6IDU5LFxuICAgICAgICAgICAgc3RlcDogb3B0Lm1pbnV0ZVN0ZXAsXG4gICAgICAgICAgICB1cEJ0blRhZzogdXBCdG5UYWcsXG4gICAgICAgICAgICBkb3duQnRuVGFnOiBkb3duQnRuVGFnLFxuICAgICAgICAgICAgZXhjbHVzaW9uOiBvcHQubWludXRlRXhjbHVzaW9uXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBtYWtlIHRpbWVwaWNrZXIgY29udGFpbmVyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfbWFrZVRpbWVQaWNrZXJFbGVtZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9wdCA9IHRoaXMuX29wdGlvbjtcbiAgICAgICAgdmFyICR0cCA9ICQodGltZVBpY2tlclRhZyk7XG4gICAgICAgIHZhciAkdHBSb3cgPSAkdHAuZmluZCgnLnRpbWVwaWNrZXItcm93Jyk7XG4gICAgICAgIHZhciAkY29sb24gPSAkKGNvbHVtblRhZykuYWRkQ2xhc3MoJ2NvbG9uJykuYXBwZW5kKCc6Jyk7XG4gICAgICAgIHZhciAkbWVyaWRpYW47XG5cbiAgICAgICAgJHRwUm93LmFwcGVuZCh0aGlzLl9ob3VyU3BpbmJveC5nZXRDb250YWluZXJFbGVtZW50KCksICRjb2xvbiwgdGhpcy5fbWludXRlU3BpbmJveC5nZXRDb250YWluZXJFbGVtZW50KCkpO1xuXG4gICAgICAgIGlmIChvcHQuc2hvd01lcmlkaWFuKSB7XG4gICAgICAgICAgICAkbWVyaWRpYW4gPSAkKGNvbHVtblRhZylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ21lcmlkaWFuJylcbiAgICAgICAgICAgICAgICAuYXBwZW5kKG1lcmlkaWVtVGFnKTtcbiAgICAgICAgICAgIHRoaXMuXyRtZXJpZGlhbkVsZW1lbnQgPSAkbWVyaWRpYW4uZmluZCgnc2VsZWN0JykuZXEoMCk7XG4gICAgICAgICAgICAkdHBSb3cuYXBwZW5kKCRtZXJpZGlhbik7XG4gICAgICAgIH1cblxuICAgICAgICAkdHAuaGlkZSgpO1xuICAgICAgICAkKCdib2R5JykuYXBwZW5kKCR0cCk7XG4gICAgICAgIHRoaXMuJHRpbWVQaWNrZXJFbGVtZW50ID0gJHRwO1xuXG4gICAgICAgIGlmIChvcHQuaW5wdXRFbGVtZW50KSB7XG4gICAgICAgICAgICAkdHAuY3NzKCdwb3NpdGlvbicsICdhYnNvbHV0ZScpO1xuICAgICAgICAgICAgdGhpcy5fJGlucHV0RWxlbWVudCA9ICQob3B0LmlucHV0RWxlbWVudCk7XG4gICAgICAgICAgICB0aGlzLl9zZXREZWZhdWx0UG9zaXRpb24odGhpcy5fJGlucHV0RWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2V0IHBvc2l0aW9uIG9mIHRpbWVwaWNrZXIgY29udGFpbmVyXG4gICAgICogQHBhcmFtIHtqUXVlcnl9ICRpbnB1dCBqcXVlcnktb2JqZWN0IChlbGVtZW50KVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldERlZmF1bHRQb3NpdGlvbjogZnVuY3Rpb24oJGlucHV0KSB7XG4gICAgICAgIHZhciBpbnB1dEVsID0gJGlucHV0WzBdO1xuICAgICAgICB2YXIgcG9zaXRpb24gPSB0aGlzLl9vcHRpb24ucG9zaXRpb247XG4gICAgICAgIHZhciB4ID0gcG9zaXRpb24ueDtcbiAgICAgICAgdmFyIHkgPSBwb3NpdGlvbi55O1xuXG4gICAgICAgIGlmICghdXRpbC5pc051bWJlcih4KSB8fCAhdXRpbC5pc051bWJlcih5KSkge1xuICAgICAgICAgICAgeCA9IGlucHV0RWwub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgIHkgPSBpbnB1dEVsLm9mZnNldFRvcCArIGlucHV0RWwub2Zmc2V0SGVpZ2h0ICsgMztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFhZUG9zaXRpb24oeCwgeSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGFzc2lnbiBkZWZhdWx0IGV2ZW50c1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2Fzc2lnbkRlZmF1bHRFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJGlucHV0ID0gdGhpcy5fJGlucHV0RWxlbWVudDtcblxuICAgICAgICBpZiAoJGlucHV0KSB7XG4gICAgICAgICAgICB0aGlzLl9hc3NpZ25FdmVudHNUb0lucHV0RWxlbWVudCgpO1xuICAgICAgICAgICAgdGhpcy5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJGlucHV0LnZhbCh0aGlzLmdldFRpbWUoKSk7XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2hvdXJTcGluYm94Lm9uKCdjaGFuZ2UnLCB1dGlsLmJpbmQodGhpcy5fb25DaGFuZ2VTcGluYm94LCB0aGlzKSk7XG4gICAgICAgIHRoaXMuX21pbnV0ZVNwaW5ib3gub24oJ2NoYW5nZScsIHV0aWwuYmluZCh0aGlzLl9vbkNoYW5nZVNwaW5ib3gsIHRoaXMpKTtcblxuICAgICAgICB0aGlzLiR0aW1lUGlja2VyRWxlbWVudC5vbignY2hhbmdlJywgJ3NlbGVjdCcsIHV0aWwuYmluZCh0aGlzLl9vbkNoYW5nZU1lcmlkaWVtLCB0aGlzKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGF0dGFjaCBldmVudCB0byBJbnB1dCBlbGVtZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYXNzaWduRXZlbnRzVG9JbnB1dEVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciAkaW5wdXQgPSB0aGlzLl8kaW5wdXRFbGVtZW50O1xuXG4gICAgICAgICRpbnB1dC5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgc2VsZi5vcGVuKGV2ZW50KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGlucHV0Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghc2VsZi5zZXRUaW1lRnJvbUlucHV0RWxlbWVudCgpKSB7XG4gICAgICAgICAgICAgICAgJGlucHV0LnZhbChzZWxmLmdldFRpbWUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDdXN0b20gZXZlbnQgaGFuZGxlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gQ2hhbmdlIHR5cGUgb24gc3BpbmJveCAodHlwZTogdXAsIGRvd24sIGRlZnVhbHQpXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25DaGFuZ2VTcGluYm94OiBmdW5jdGlvbih0eXBlKSB7XG4gICAgICAgIHZhciBob3VyID0gdGhpcy5faG91clNwaW5ib3guZ2V0VmFsdWUoKTtcbiAgICAgICAgdmFyIG1pbnV0ZSA9IHRoaXMuX21pbnV0ZVNwaW5ib3guZ2V0VmFsdWUoKTtcblxuICAgICAgICBpZiAodGhpcy5fb3B0aW9uLnNob3dNZXJpZGlhbikge1xuICAgICAgICAgICAgaWYgKCh0eXBlID09PSAndXAnICYmIGhvdXIgPT09IDEyKSB8fFxuICAgICAgICAgICAgICAgICh0eXBlID09PSAnZG93bicgJiYgaG91ciA9PT0gMTEpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faXNQTSA9ICF0aGlzLl9pc1BNO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaG91ciA9IHRoaXMuX2dldE9yaWdpbmFsSG91cihob3VyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3NldFRpbWUoaG91ciwgbWludXRlLCBmYWxzZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERPTSBldmVudCBoYW5kbGVyXG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSBDaGFuZ2UgZXZlbnQgb24gbWVyaWRpZW0gZWxlbWVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uQ2hhbmdlTWVyaWRpZW06IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHZhciBpc1BNID0gKGV2ZW50LnRhcmdldC52YWx1ZSA9PT0gJ1BNJyk7XG4gICAgICAgIHZhciBjdXJyZW50SG91ciA9IHRoaXMuX2hvdXI7XG4gICAgICAgIHZhciBob3VyID0gaXNQTSA/IChjdXJyZW50SG91ciArIDEyKSA6IChjdXJyZW50SG91ciAlIDEyKTtcblxuICAgICAgICB0aGlzLl9zZXRUaW1lKGhvdXIsIHRoaXMuX21pbnV0ZVNwaW5ib3guZ2V0VmFsdWUoKSwgZmFsc2UpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBpcyBjbGlja2VkIGluc2lkZSBvZiBjb250YWluZXI/XG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgZXZlbnQtb2JqZWN0XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2lzQ2xpY2tlZEluc2lkZTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgdmFyIGlzQ29udGFpbnMgPSAkLmNvbnRhaW5zKHRoaXMuJHRpbWVQaWNrZXJFbGVtZW50WzBdLCBldmVudC50YXJnZXQpO1xuICAgICAgICB2YXIgaXNJbnB1dEVsZW1lbnQgPSAodGhpcy5fJGlucHV0RWxlbWVudCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRpbnB1dEVsZW1lbnRbMF0gPT09IGV2ZW50LnRhcmdldCk7XG5cbiAgICAgICAgcmV0dXJuIGlzQ29udGFpbnMgfHwgaXNJbnB1dEVsZW1lbnQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHRyYW5zZm9ybSB0aW1lIGludG8gZm9ybWF0dGVkIHN0cmluZ1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHRpbWUgc3RyaW5nXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZm9ybVRvVGltZUZvcm1hdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBob3VyID0gdGhpcy5faG91cjtcbiAgICAgICAgdmFyIG1pbnV0ZSA9IHRoaXMuX21pbnV0ZTtcbiAgICAgICAgdmFyIHBvc3RmaXggPSB0aGlzLl9nZXRQb3N0Zml4KCk7XG4gICAgICAgIHZhciBmb3JtYXR0ZWRIb3VyLCBmb3JtYXR0ZWRNaW51dGU7XG5cbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbi5zaG93TWVyaWRpYW4pIHtcbiAgICAgICAgICAgIGhvdXIgPSB1dGlscy5nZXRNZXJpZGllbUhvdXIoaG91cik7XG4gICAgICAgIH1cblxuICAgICAgICBmb3JtYXR0ZWRIb3VyID0gKGhvdXIgPCAxMCkgPyAnMCcgKyBob3VyIDogaG91cjtcbiAgICAgICAgZm9ybWF0dGVkTWludXRlID0gKG1pbnV0ZSA8IDEwKSA/ICcwJyArIG1pbnV0ZSA6IG1pbnV0ZTtcblxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkSG91ciArICc6JyArIGZvcm1hdHRlZE1pbnV0ZSArIHBvc3RmaXg7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHNldCB0aGUgYm9vbGVhbiB2YWx1ZSAnaXNQTScgd2hlbiBBTS9QTSBvcHRpb24gaXMgdHJ1ZS5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXRJc1BNOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5faXNQTSA9ICh0aGlzLl9ob3VyID4gMTEpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBnZXQgcG9zdGZpeCB3aGVuIEFNL1BNIG9wdGlvbiBpcyB0cnVlLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHBvc3RmaXggKEFNL1BNKVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2dldFBvc3RmaXg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcG9zdGZpeCA9ICcnO1xuXG4gICAgICAgIGlmICh0aGlzLl9vcHRpb24uc2hvd01lcmlkaWFuKSB7XG4gICAgICAgICAgICBwb3N0Zml4ID0gKHRoaXMuX2lzUE0pID8gJyBQTScgOiAnIEFNJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwb3N0Zml4O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBzZXQgcG9zaXRpb24gb2YgY29udGFpbmVyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHggLSBpdCB3aWxsIGJlIG9mZnNldExlZnQgb2YgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gaXQgd2lsbCBiZSBvZmZzZXRUb3Agb2YgZWxlbWVudFxuICAgICAqL1xuICAgIHNldFhZUG9zaXRpb246IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgICAgaWYgKCF1dGlsLmlzTnVtYmVyKHgpIHx8ICF1dGlsLmlzTnVtYmVyKHkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB1dGlsLmV4dGVuZCh0aGlzLl9vcHRpb24ucG9zaXRpb24sIHtcbiAgICAgICAgICAgIHg6IHgsXG4gICAgICAgICAgICB5OiB5XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLiR0aW1lUGlja2VyRWxlbWVudC5jc3Moe1xuICAgICAgICAgICAgbGVmdDogeCxcbiAgICAgICAgICAgIHRvcDogeVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2hvdyB0aW1lIHBpY2tlciBlbGVtZW50XG4gICAgICovXG4gICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJHRpbWVQaWNrZXJFbGVtZW50LnNob3coKTtcbiAgICAgICAgdGhpcy5faXNTaG93biA9IHRydWU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGhpZGUgdGltZSBwaWNrZXIgZWxlbWVudFxuICAgICAqL1xuICAgIGhpZGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiR0aW1lUGlja2VyRWxlbWVudC5oaWRlKCk7XG4gICAgICAgIHRoaXMuX2lzU2hvd24gPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogbGlzdGVuZXIgdG8gc2hvdyBjb250YWluZXJcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBldmVudC1vYmplY3RcbiAgICAgKi9cbiAgICBvcGVuOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAodGhpcy5faXNTaG93bikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgdXRpbC5iaW5kKHRoaXMuY2xvc2UsIHRoaXMpKTtcbiAgICAgICAgdGhpcy5zaG93KCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9wZW4gZXZlbnQgLSBUaW1lUGlja2VyXG4gICAgICAgICAqIEBldmVudCBUaW1lUGlja2VyI29wZW5cbiAgICAgICAgICogQHBhcmFtIHsoalF1ZXJ5LkV2ZW50fHVuZGVmaW5lZCl9IC0gQ2xpY2sgdGhlIGlucHV0IGVsZW1lbnRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlyZSgnb3BlbicsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogbGlzdGVuZXIgdG8gaGlkZSBjb250YWluZXJcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCBldmVudC1vYmplY3RcbiAgICAgKi9cbiAgICBjbG9zZTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pc1Nob3duIHx8IHRoaXMuX2lzQ2xpY2tlZEluc2lkZShldmVudCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgICQoZG9jdW1lbnQpLm9mZihldmVudCk7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIaWRlIGV2ZW50IC0gVGltZXBpY2tlclxuICAgICAgICAgKiBAZXZlbnQgVGltZVBpY2tlciNjbG9zZVxuICAgICAgICAgKiBAcGFyYW0geyhqUXVlcnkuRXZlbnR8dW5kZWZpbmVkKX0gLSBDbGljayB0aGUgZG9jdW1lbnQgKG5vdCBUaW1lUGlja2VyKVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maXJlKCdjbG9zZScsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2V0IHZhbHVlcyBpbiBzcGluYm94ZXMgZnJvbSB0aW1lXG4gICAgICovXG4gICAgdG9TcGluYm94ZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaG91ciA9IHRoaXMuX2hvdXI7XG4gICAgICAgIHZhciBtaW51dGUgPSB0aGlzLl9taW51dGU7XG5cbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbi5zaG93TWVyaWRpYW4pIHtcbiAgICAgICAgICAgIGhvdXIgPSB1dGlscy5nZXRNZXJpZGllbUhvdXIoaG91cik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9ob3VyU3BpbmJveC5zZXRWYWx1ZShob3VyKTtcbiAgICAgICAgdGhpcy5fbWludXRlU3BpbmJveC5zZXRWYWx1ZShtaW51dGUpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgb3JpZ2luYWwgaG91ciBmcm9tIG1lcmlkaWVtIGhvdXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7aG91cn0gaG91ciAtIE1lcmlkaWVtIGhvdXJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBPcmlnaW5hbCBob3VyXG4gICAgICovXG4gICAgX2dldE9yaWdpbmFsSG91cjogZnVuY3Rpb24oaG91cikge1xuICAgICAgICB2YXIgaXNQTSA9IHRoaXMuX2lzUE07XG5cbiAgICAgICAgaWYgKGlzUE0pIHtcbiAgICAgICAgICAgIGhvdXIgPSAoaG91ciA8IDEyKSA/IChob3VyICsgMTIpIDogMTI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBob3VyID0gKGhvdXIgPCAxMikgPyAoaG91ciAlIDEyKSA6IDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaG91cjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2V0IHRpbWUgZnJvbSBpbnB1dCBlbGVtZW50LlxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fSBbaW5wdXRFbGVtZW50XSBqcXVlcnkgb2JqZWN0IChlbGVtZW50KVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSByZXN1bHQgb2Ygc2V0IHRpbWVcbiAgICAgKi9cbiAgICBzZXRUaW1lRnJvbUlucHV0RWxlbWVudDogZnVuY3Rpb24oaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIHZhciBpbnB1dCA9ICQoaW5wdXRFbGVtZW50KVswXSB8fCB0aGlzLl8kaW5wdXRFbGVtZW50WzBdO1xuXG4gICAgICAgIHJldHVybiAhIShpbnB1dCAmJiB0aGlzLnNldFRpbWVGcm9tU3RyaW5nKGlucHV0LnZhbHVlKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHNldCBob3VyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhvdXIgZm9yIHRpbWUgcGlja2VyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdCBvZiBzZXQgdGltZVxuICAgICAqL1xuICAgIHNldEhvdXI6IGZ1bmN0aW9uKGhvdXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldFRpbWUoaG91ciwgdGhpcy5fbWludXRlLCB0cnVlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2V0IG1pbnV0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW51dGUgZm9yIHRpbWUgcGlja2VyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdCBvZiBzZXQgdGltZVxuICAgICAqL1xuICAgIHNldE1pbnV0ZTogZnVuY3Rpb24obWludXRlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXRUaW1lKHRoaXMuX2hvdXIsIG1pbnV0ZSwgdHJ1ZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHNldCB0aW1lIGZvciBleHRlbmFsIGNhbGxcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaG91ciBmb3IgdGltZSBwaWNrZXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWludXRlIGZvciB0aW1lIHBpY2tlclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSByZXN1bHQgb2Ygc2V0IHRpbWVcbiAgICAgKi9cbiAgICBzZXRUaW1lOiBmdW5jdGlvbihob3VyLCBtaW51dGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldFRpbWUoaG91ciwgbWludXRlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2V0IHRpbWVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaG91ciBmb3IgdGltZSBwaWNrZXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWludXRlIGZvciB0aW1lIHBpY2tlclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNTZXRTcGluYm94IHdoZXRoZXIgc3BpbmJveCBzZXQgb3Igbm90XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlc3VsdCBvZiBzZXQgdGltZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldFRpbWU6IGZ1bmN0aW9uKGhvdXIsIG1pbnV0ZSwgaXNTZXRTcGluYm94KSB7XG4gICAgICAgIHZhciBpc051bWJlciA9ICh1dGlsLmlzTnVtYmVyKGhvdXIpICYmIHV0aWwuaXNOdW1iZXIobWludXRlKSk7XG4gICAgICAgIHZhciBpc1ZhbGlkID0gKGhvdXIgPCAyNCAmJiBtaW51dGUgPCA2MCk7XG4gICAgICAgIHZhciBwb3N0Zml4O1xuXG4gICAgICAgIGlmICghaXNOdW1iZXIgfHwgIWlzVmFsaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2hvdXIgPSBob3VyO1xuICAgICAgICB0aGlzLl9taW51dGUgPSBtaW51dGU7XG5cbiAgICAgICAgdGhpcy5fc2V0SXNQTSgpO1xuXG4gICAgICAgIGlmIChpc1NldFNwaW5ib3gpIHtcbiAgICAgICAgICAgIHRoaXMudG9TcGluYm94ZXMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl8kbWVyaWRpYW5FbGVtZW50KSB7XG4gICAgICAgICAgICBwb3N0Zml4ID0gdGhpcy5fZ2V0UG9zdGZpeCgpLnJlcGxhY2UoL1xccysvLCAnJyk7XG4gICAgICAgICAgICB0aGlzLl8kbWVyaWRpYW5FbGVtZW50LnZhbChwb3N0Zml4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDaGFuZ2UgZXZlbnQgLSBUaW1lUGlja2VyXG4gICAgICAgICAqIEBldmVudCBUaW1lUGlja2VyI2NoYW5nZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maXJlKCdjaGFuZ2UnLCBpc1NldFNwaW5ib3gpO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBzZXQgdGltZSBmcm9tIHRpbWUtc3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRpbWVTdHJpbmcgdGltZS1zdHJpbmdcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmVzdWx0IG9mIHNldCB0aW1lXG4gICAgICogQHRvZG8gUmVmYWN0b3I6IGZ1bmN0aW9uIGNvbXBsZXhpdHlcbiAgICAgKi9cbiAgICBzZXRUaW1lRnJvbVN0cmluZzogZnVuY3Rpb24odGltZVN0cmluZykge1xuICAgICAgICB2YXIgdGltZSwgaG91ciwgbWludXRlLCBwb3N0Zml4LCBpc1BNO1xuXG4gICAgICAgIGlmICh0aW1lUmVnRXhwLnRlc3QodGltZVN0cmluZykpIHtcbiAgICAgICAgICAgIHRpbWUgPSB0aW1lU3RyaW5nLnNwbGl0KHRpbWVTZXBlcmF0b3IpO1xuICAgICAgICAgICAgaG91ciA9IE51bWJlcih0aW1lWzBdKTtcbiAgICAgICAgICAgIG1pbnV0ZSA9IE51bWJlcih0aW1lWzFdKTtcblxuICAgICAgICAgICAgaWYgKGhvdXIgPCAyNCAmJiB0aGlzLl9vcHRpb24uc2hvd01lcmlkaWFuKSB7XG4gICAgICAgICAgICAgICAgcG9zdGZpeCA9IHRpbWVbMl0udG9VcHBlckNhc2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChwb3N0Zml4ID09PSAnUE0nKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzUE0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zdGZpeCA9PT0gJ0FNJykge1xuICAgICAgICAgICAgICAgICAgICBpc1BNID0gKGhvdXIgPiAxMik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaXNQTSA9IHRoaXMuX2lzUE07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzUE0gJiYgaG91ciA8IDEyKSB7XG4gICAgICAgICAgICAgICAgICAgIGhvdXIgKz0gMTI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghaXNQTSAmJiBob3VyID09PSAxMikge1xuICAgICAgICAgICAgICAgICAgICBob3VyID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0VGltZShob3VyLCBtaW51dGUsIHRydWUpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBzZXQgc3RlcCBvZiBob3VyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAgZm9yIHRpbWUgcGlja2VyXG4gICAgICovXG4gICAgc2V0SG91clN0ZXA6IGZ1bmN0aW9uKHN0ZXApIHtcbiAgICAgICAgdGhpcy5faG91clNwaW5ib3guc2V0U3RlcChzdGVwKTtcbiAgICAgICAgdGhpcy5fb3B0aW9uLmhvdXJTdGVwID0gdGhpcy5faG91clNwaW5ib3guZ2V0U3RlcCgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBzZXQgc3RlcCBvZiBtaW51dGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RlcCBmb3IgdGltZSBwaWNrZXJcbiAgICAgKi9cbiAgICBzZXRNaW51dGVTdGVwOiBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHRoaXMuX21pbnV0ZVNwaW5ib3guc2V0U3RlcChzdGVwKTtcbiAgICAgICAgdGhpcy5fb3B0aW9uLm1pbnV0ZVN0ZXAgPSB0aGlzLl9taW51dGVTcGluYm94LmdldFN0ZXAoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogYWRkIGEgc3BlY2lmaWMgaG91ciB0byBleGNsdWRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhvdXIgZm9yIGV4Y2x1c2lvblxuICAgICAqL1xuICAgIGFkZEhvdXJFeGNsdXNpb246IGZ1bmN0aW9uKGhvdXIpIHtcbiAgICAgICAgdGhpcy5faG91clNwaW5ib3guYWRkRXhjbHVzaW9uKGhvdXIpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBhZGQgYSBzcGVjaWZpYyBtaW51dGUgdG8gZXhjbHVkZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW51dGUgZm9yIGV4Y2x1c2lvblxuICAgICAqL1xuICAgIGFkZE1pbnV0ZUV4Y2x1c2lvbjogZnVuY3Rpb24obWludXRlKSB7XG4gICAgICAgIHRoaXMuX21pbnV0ZVNwaW5ib3guYWRkRXhjbHVzaW9uKG1pbnV0ZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGdldCBzdGVwIG9mIGhvdXJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBob3VyIHVwL2Rvd24gc3RlcFxuICAgICAqL1xuICAgIGdldEhvdXJTdGVwOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbi5ob3VyU3RlcDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogZ2V0IHN0ZXAgb2YgbWludXRlXG4gICAgICogQHJldHVybnMge251bWJlcn0gbWludXRlIHVwL2Rvd24gc3RlcFxuICAgICAqL1xuICAgIGdldE1pbnV0ZVN0ZXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9uLm1pbnV0ZVN0ZXA7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJlbW92ZSBob3VyIGZyb20gZXhjbHVzaW9uIGxpc3RcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaG91ciB0aGF0IHlvdSB3YW50IHRvIHJlbW92ZVxuICAgICAqL1xuICAgIHJlbW92ZUhvdXJFeGNsdXNpb246IGZ1bmN0aW9uKGhvdXIpIHtcbiAgICAgICAgdGhpcy5faG91clNwaW5ib3gucmVtb3ZlRXhjbHVzaW9uKGhvdXIpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiByZW1vdmUgbWludXRlIGZyb20gZXhjbHVzaW9uIGxpc3RcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWludXRlIHRoYXQgeW91IHdhbnQgdG8gcmVtb3ZlXG4gICAgICovXG4gICAgcmVtb3ZlTWludXRlRXhjbHVzaW9uOiBmdW5jdGlvbihtaW51dGUpIHtcbiAgICAgICAgdGhpcy5fbWludXRlU3BpbmJveC5yZW1vdmVFeGNsdXNpb24obWludXRlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogZ2V0IGhvdXJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBob3VyXG4gICAgICovXG4gICAgZ2V0SG91cjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ob3VyO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBnZXQgbWludXRlXG4gICAgICogQHJldHVybnMge251bWJlcn0gbWludXRlXG4gICAgICovXG4gICAgZ2V0TWludXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21pbnV0ZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogZ2V0IHRpbWVcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSAnaGg6bW0gKEFNL1BNKSdcbiAgICAgKi9cbiAgICBnZXRUaW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1Ub1RpbWVGb3JtYXQoKTtcbiAgICB9XG59KTtcbnR1aS51dGlsLkN1c3RvbUV2ZW50cy5taXhpbihUaW1lUGlja2VyKTtcblxubW9kdWxlLmV4cG9ydHMgPSBUaW1lUGlja2VyO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvdGltZXBpY2tlci5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9